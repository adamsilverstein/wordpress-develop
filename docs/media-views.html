<!DOCTYPE html>

<html>
<head>
  <title>media-views.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="bookmarklet.html">
                  bookmarklet.js
                </a>
              
                
                <a class="source" href="bookmarklet.min.html">
                  bookmarklet.min.js
                </a>
              
                
                <a class="source" href="color-picker.html">
                  color-picker.js
                </a>
              
                
                <a class="source" href="comment.html">
                  comment.js
                </a>
              
                
                <a class="source" href="common.html">
                  common.js
                </a>
              
                
                <a class="source" href="custom-background.html">
                  custom-background.js
                </a>
              
                
                <a class="source" href="custom-header.html">
                  custom-header.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-nav-menus.html">
                  customize-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-widgets.html">
                  customize-widgets.js
                </a>
              
                
                <a class="source" href="dashboard.html">
                  dashboard.js
                </a>
              
                
                <a class="source" href="edit-comments.html">
                  edit-comments.js
                </a>
              
                
                <a class="source" href="editor-expand.html">
                  editor-expand.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="farbtastic.html">
                  farbtastic.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="image-edit.html">
                  image-edit.js
                </a>
              
                
                <a class="source" href="inline-edit-post.html">
                  inline-edit-post.js
                </a>
              
                
                <a class="source" href="inline-edit-tax.html">
                  inline-edit-tax.js
                </a>
              
                
                <a class="source" href="iris.min.html">
                  iris.min.js
                </a>
              
                
                <a class="source" href="language-chooser.html">
                  language-chooser.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="media-gallery.html">
                  media-gallery.js
                </a>
              
                
                <a class="source" href="media-upload.html">
                  media-upload.js
                </a>
              
                
                <a class="source" href="media.html">
                  media.js
                </a>
              
                
                <a class="source" href="nav-menu.html">
                  nav-menu.js
                </a>
              
                
                <a class="source" href="password-strength-meter.html">
                  password-strength-meter.js
                </a>
              
                
                <a class="source" href="plugin-install.html">
                  plugin-install.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="postbox.html">
                  postbox.js
                </a>
              
                
                <a class="source" href="press-this.html">
                  press-this.js
                </a>
              
                
                <a class="source" href="revisions.html">
                  revisions.js
                </a>
              
                
                <a class="source" href="set-post-thumbnail.html">
                  set-post-thumbnail.js
                </a>
              
                
                <a class="source" href="svg-painter.html">
                  svg-painter.js
                </a>
              
                
                <a class="source" href="tags-box.html">
                  tags-box.js
                </a>
              
                
                <a class="source" href="tags-suggest.html">
                  tags-suggest.js
                </a>
              
                
                <a class="source" href="tags.html">
                  tags.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="updates.html">
                  updates.js
                </a>
              
                
                <a class="source" href="user-profile.html">
                  user-profile.js
                </a>
              
                
                <a class="source" href="user-suggest.html">
                  user-suggest.js
                </a>
              
                
                <a class="source" href="widgets.html">
                  widgets.js
                </a>
              
                
                <a class="source" href="media-audio-widget.html">
                  media-audio-widget.js
                </a>
              
                
                <a class="source" href="media-image-widget.html">
                  media-image-widget.js
                </a>
              
                
                <a class="source" href="media-video-widget.html">
                  media-video-widget.js
                </a>
              
                
                <a class="source" href="media-widgets.html">
                  media-widgets.js
                </a>
              
                
                <a class="source" href="text-widgets.html">
                  text-widgets.js
                </a>
              
                
                <a class="source" href="word-count.html">
                  word-count.js
                </a>
              
                
                <a class="source" href="wp-fullscreen-stub.html">
                  wp-fullscreen-stub.js
                </a>
              
                
                <a class="source" href="xfn.html">
                  xfn.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="theme-options.html">
                  theme-options.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="showcase.html">
                  showcase.js
                </a>
              
                
                <a class="source" href="color-scheme-control.html">
                  color-scheme-control.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="customizer.html">
                  customizer.js
                </a>
              
                
                <a class="source" href="featured-content-admin.html">
                  featured-content-admin.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="global.html">
                  global.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="jquery.scrollTo.html">
                  jquery.scrollTo.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="admin-bar.html">
                  admin-bar.js
                </a>
              
                
                <a class="source" href="autosave.html">
                  autosave.js
                </a>
              
                
                <a class="source" href="backbone.html">
                  backbone.js
                </a>
              
                
                <a class="source" href="backbone.min.html">
                  backbone.min.js
                </a>
              
                
                <a class="source" href="colorpicker.html">
                  colorpicker.js
                </a>
              
                
                <a class="source" href="comment-reply.html">
                  comment-reply.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-base.html">
                  customize-base.js
                </a>
              
                
                <a class="source" href="customize-loader.html">
                  customize-loader.js
                </a>
              
                
                <a class="source" href="customize-models.html">
                  customize-models.js
                </a>
              
                
                <a class="source" href="customize-preview-nav-menus.html">
                  customize-preview-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-preview-widgets.html">
                  customize-preview-widgets.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="customize-selective-refresh.html">
                  customize-selective-refresh.js
                </a>
              
                
                <a class="source" href="customize-views.html">
                  customize-views.js
                </a>
              
                
                <a class="source" href="heartbeat.html">
                  heartbeat.js
                </a>
              
                
                <a class="source" href="hoverIntent.html">
                  hoverIntent.js
                </a>
              
                
                <a class="source" href="imagesloaded.min.html">
                  imagesloaded.min.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.html">
                  jquery.imgareaselect.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.min.html">
                  jquery.imgareaselect.min.js
                </a>
              
                
                <a class="source" href="jquery.Jcrop.min.html">
                  jquery.Jcrop.min.js
                </a>
              
                
                <a class="source" href="jquery-migrate.html">
                  jquery-migrate.js
                </a>
              
                
                <a class="source" href="jquery-migrate.min.html">
                  jquery-migrate.min.js
                </a>
              
                
                <a class="source" href="jquery.color.min.html">
                  jquery.color.min.js
                </a>
              
                
                <a class="source" href="jquery.form.html">
                  jquery.form.js
                </a>
              
                
                <a class="source" href="jquery.form.min.html">
                  jquery.form.min.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.html">
                  jquery.hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.min.html">
                  jquery.hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.html">
                  jquery.js
                </a>
              
                
                <a class="source" href="jquery.masonry.html">
                  jquery.masonry.js
                </a>
              
                
                <a class="source" href="jquery.masonry.min.html">
                  jquery.masonry.min.js
                </a>
              
                
                <a class="source" href="jquery.query.html">
                  jquery.query.js
                </a>
              
                
                <a class="source" href="jquery.schedule.html">
                  jquery.schedule.js
                </a>
              
                
                <a class="source" href="jquery.serialize-object.html">
                  jquery.serialize-object.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.html">
                  jquery.table-hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.min.html">
                  jquery.table-hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.ui.touch-punch.html">
                  jquery.ui.touch-punch.js
                </a>
              
                
                <a class="source" href="suggest.html">
                  suggest.js
                </a>
              
                
                <a class="source" href="suggest.min.html">
                  suggest.min.js
                </a>
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="autocomplete.html">
                  autocomplete.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="core.html">
                  core.js
                </a>
              
                
                <a class="source" href="datepicker.html">
                  datepicker.js
                </a>
              
                
                <a class="source" href="dialog.html">
                  dialog.js
                </a>
              
                
                <a class="source" href="draggable.html">
                  draggable.js
                </a>
              
                
                <a class="source" href="droppable.html">
                  droppable.js
                </a>
              
                
                <a class="source" href="effect-blind.html">
                  effect-blind.js
                </a>
              
                
                <a class="source" href="effect-bounce.html">
                  effect-bounce.js
                </a>
              
                
                <a class="source" href="effect-clip.html">
                  effect-clip.js
                </a>
              
                
                <a class="source" href="effect-drop.html">
                  effect-drop.js
                </a>
              
                
                <a class="source" href="effect-explode.html">
                  effect-explode.js
                </a>
              
                
                <a class="source" href="effect-fade.html">
                  effect-fade.js
                </a>
              
                
                <a class="source" href="effect-fold.html">
                  effect-fold.js
                </a>
              
                
                <a class="source" href="effect-highlight.html">
                  effect-highlight.js
                </a>
              
                
                <a class="source" href="effect-puff.html">
                  effect-puff.js
                </a>
              
                
                <a class="source" href="effect-pulsate.html">
                  effect-pulsate.js
                </a>
              
                
                <a class="source" href="effect-scale.html">
                  effect-scale.js
                </a>
              
                
                <a class="source" href="effect-shake.html">
                  effect-shake.js
                </a>
              
                
                <a class="source" href="effect-size.html">
                  effect-size.js
                </a>
              
                
                <a class="source" href="effect-slide.html">
                  effect-slide.js
                </a>
              
                
                <a class="source" href="effect-transfer.html">
                  effect-transfer.js
                </a>
              
                
                <a class="source" href="effect.html">
                  effect.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="mouse.html">
                  mouse.js
                </a>
              
                
                <a class="source" href="position.html">
                  position.js
                </a>
              
                
                <a class="source" href="progressbar.html">
                  progressbar.js
                </a>
              
                
                <a class="source" href="resizable.html">
                  resizable.js
                </a>
              
                
                <a class="source" href="selectable.html">
                  selectable.js
                </a>
              
                
                <a class="source" href="selectmenu.html">
                  selectmenu.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="sortable.html">
                  sortable.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="tabs.html">
                  tabs.js
                </a>
              
                
                <a class="source" href="tooltip.html">
                  tooltip.js
                </a>
              
                
                <a class="source" href="widget.html">
                  widget.js
                </a>
              
                
                <a class="source" href="json2.html">
                  json2.js
                </a>
              
                
                <a class="source" href="masonry.min.html">
                  masonry.min.js
                </a>
              
                
                <a class="source" href="mce-view.html">
                  mce-view.js
                </a>
              
                
                <a class="source" href="media-audiovideo.html">
                  media-audiovideo.js
                </a>
              
                
                <a class="source" href="media-editor.html">
                  media-editor.js
                </a>
              
                
                <a class="source" href="media-grid.html">
                  media-grid.js
                </a>
              
                
                <a class="source" href="media-models.html">
                  media-models.js
                </a>
              
                
                <a class="source" href="media-views.html">
                  media-views.js
                </a>
              
                
                <a class="source" href="audiovideo.manifest.html">
                  audiovideo.manifest.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="collection-add.html">
                  collection-add.js
                </a>
              
                
                <a class="source" href="collection-edit.html">
                  collection-edit.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-image-cropper.html">
                  customize-image-cropper.js
                </a>
              
                
                <a class="source" href="edit-attachment-metadata.html">
                  edit-attachment-metadata.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="featured-image.html">
                  featured-image.js
                </a>
              
                
                <a class="source" href="gallery-add.html">
                  gallery-add.js
                </a>
              
                
                <a class="source" href="gallery-edit.html">
                  gallery-edit.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="media-library.html">
                  media-library.js
                </a>
              
                
                <a class="source" href="region.html">
                  region.js
                </a>
              
                
                <a class="source" href="replace-image.html">
                  replace-image.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="state-machine.html">
                  state-machine.js
                </a>
              
                
                <a class="source" href="state.html">
                  state.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="grid.manifest.html">
                  grid.manifest.js
                </a>
              
                
                <a class="source" href="models.manifest.html">
                  models.manifest.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="post-image.html">
                  post-image.js
                </a>
              
                
                <a class="source" href="post-media.html">
                  post-media.js
                </a>
              
                
                <a class="source" href="query.html">
                  query.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="selection-sync.html">
                  selection-sync.js
                </a>
              
                
                <a class="source" href="views.manifest.html">
                  views.manifest.js
                </a>
              
                
                <a class="source" href="attachment-compat.html">
                  attachment-compat.js
                </a>
              
                
                <a class="source" href="attachment-filters.html">
                  attachment-filters.js
                </a>
              
                
                <a class="source" href="all.html">
                  all.js
                </a>
              
                
                <a class="source" href="date.html">
                  date.js
                </a>
              
                
                <a class="source" href="uploaded.html">
                  uploaded.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="details-two-column.html">
                  details-two-column.js
                </a>
              
                
                <a class="source" href="details.html">
                  details.js
                </a>
              
                
                <a class="source" href="edit-library.html">
                  edit-library.js
                </a>
              
                
                <a class="source" href="edit-selection.html">
                  edit-selection.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="browser.html">
                  browser.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="button-group.html">
                  button-group.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="delete-selected-permanently.html">
                  delete-selected-permanently.js
                </a>
              
                
                <a class="source" href="delete-selected.html">
                  delete-selected.js
                </a>
              
                
                <a class="source" href="select-mode-toggle.html">
                  select-mode-toggle.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="edit-image-details.html">
                  edit-image-details.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="image.html">
                  image.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="url.html">
                  url.js
                </a>
              
                
                <a class="source" href="focus-manager.html">
                  focus-manager.js
                </a>
              
                
                <a class="source" href="frame.html">
                  frame.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="edit-attachments.html">
                  edit-attachments.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="iframe.html">
                  iframe.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="label.html">
                  label.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="media-frame.html">
                  media-frame.js
                </a>
              
                
                <a class="source" href="menu-item.html">
                  menu-item.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="modal.html">
                  modal.js
                </a>
              
                
                <a class="source" href="priority-list.html">
                  priority-list.js
                </a>
              
                
                <a class="source" href="router-item.html">
                  router-item.js
                </a>
              
                
                <a class="source" href="router.html">
                  router.js
                </a>
              
                
                <a class="source" href="search.html">
                  search.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="settings.html">
                  settings.js
                </a>
              
                
                <a class="source" href="attachment-display.html">
                  attachment-display.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="playlist.html">
                  playlist.js
                </a>
              
                
                <a class="source" href="sidebar.html">
                  sidebar.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="site-icon-preview.html">
                  site-icon-preview.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="toolbar.html">
                  toolbar.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="inline.html">
                  inline.js
                </a>
              
                
                <a class="source" href="status-error.html">
                  status-error.js
                </a>
              
                
                <a class="source" href="status.html">
                  status.js
                </a>
              
                
                <a class="source" href="window.html">
                  window.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="view.html">
                  view.js
                </a>
              
                
                <a class="source" href="froogaloop.min.html">
                  froogaloop.min.js
                </a>
              
                
                <a class="source" href="mediaelement-and-player.min.html">
                  mediaelement-and-player.min.js
                </a>
              
                
                <a class="source" href="wp-mediaelement.html">
                  wp-mediaelement.js
                </a>
              
                
                <a class="source" href="wp-playlist.html">
                  wp-playlist.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="plupload.full.min.html">
                  plupload.full.min.js
                </a>
              
                
                <a class="source" href="wp-plupload.html">
                  wp-plupload.js
                </a>
              
                
                <a class="source" href="quicktags.html">
                  quicktags.js
                </a>
              
                
                <a class="source" href="shortcode.html">
                  shortcode.js
                </a>
              
                
                <a class="source" href="swfobject.html">
                  swfobject.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="handlers.min.html">
                  handlers.min.js
                </a>
              
                
                <a class="source" href="swfupload.cookies.html">
                  swfupload.cookies.js
                </a>
              
                
                <a class="source" href="swfupload.queue.html">
                  swfupload.queue.js
                </a>
              
                
                <a class="source" href="swfupload.speed.html">
                  swfupload.speed.js
                </a>
              
                
                <a class="source" href="swfupload.swfobject.html">
                  swfupload.swfobject.js
                </a>
              
                
                <a class="source" href="swfupload.html">
                  swfupload.js
                </a>
              
                
                <a class="source" href="thickbox.html">
                  thickbox.js
                </a>
              
                
                <a class="source" href="wp-langs-en.html">
                  wp-langs-en.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="tiny_mce_popup.html">
                  tiny_mce_popup.js
                </a>
              
                
                <a class="source" href="tinymce.html">
                  tinymce.js
                </a>
              
                
                <a class="source" href="tinymce.min.html">
                  tinymce.min.js
                </a>
              
                
                <a class="source" href="editable_selects.html">
                  editable_selects.js
                </a>
              
                
                <a class="source" href="form_utils.html">
                  form_utils.js
                </a>
              
                
                <a class="source" href="mctabs.html">
                  mctabs.js
                </a>
              
                
                <a class="source" href="validate.html">
                  validate.js
                </a>
              
                
                <a class="source" href="tw-sack.html">
                  tw-sack.js
                </a>
              
                
                <a class="source" href="twemoji.html">
                  twemoji.js
                </a>
              
                
                <a class="source" href="underscore.html">
                  underscore.js
                </a>
              
                
                <a class="source" href="underscore.min.html">
                  underscore.min.js
                </a>
              
                
                <a class="source" href="utils.html">
                  utils.js
                </a>
              
                
                <a class="source" href="wp-a11y.html">
                  wp-a11y.js
                </a>
              
                
                <a class="source" href="wp-ajax-response.html">
                  wp-ajax-response.js
                </a>
              
                
                <a class="source" href="wp-api.html">
                  wp-api.js
                </a>
              
                
                <a class="source" href="wp-auth-check.html">
                  wp-auth-check.js
                </a>
              
                
                <a class="source" href="wp-backbone.html">
                  wp-backbone.js
                </a>
              
                
                <a class="source" href="wp-custom-header.html">
                  wp-custom-header.js
                </a>
              
                
                <a class="source" href="wp-embed-template.html">
                  wp-embed-template.js
                </a>
              
                
                <a class="source" href="wp-embed.html">
                  wp-embed.js
                </a>
              
                
                <a class="source" href="wp-emoji-loader.html">
                  wp-emoji-loader.js
                </a>
              
                
                <a class="source" href="wp-emoji.html">
                  wp-emoji.js
                </a>
              
                
                <a class="source" href="wp-list-revisions.html">
                  wp-list-revisions.js
                </a>
              
                
                <a class="source" href="wp-lists.html">
                  wp-lists.js
                </a>
              
                
                <a class="source" href="wp-pointer.html">
                  wp-pointer.js
                </a>
              
                
                <a class="source" href="wp-util.html">
                  wp-util.js
                </a>
              
                
                <a class="source" href="wpdialog.html">
                  wpdialog.js
                </a>
              
                
                <a class="source" href="wplink.html">
                  wplink.js
                </a>
              
                
                <a class="source" href="zxcvbn-async.html">
                  zxcvbn-async.js
                </a>
              
                
                <a class="source" href="zxcvbn.min.html">
                  zxcvbn.min.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>media-views.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">t,n,r</span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">s</span>(<span class="hljs-params">o,u</span>)</span>{<span class="hljs-keyword">if</span>(!n[o]){<span class="hljs-keyword">if</span>(!t[o]){<span class="hljs-keyword">var</span> a=<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">require</span>==<span class="hljs-string">"function"</span>&amp;&amp;<span class="hljs-built_in">require</span>;<span class="hljs-keyword">if</span>(!u&amp;&amp;a)<span class="hljs-keyword">return</span> a(o,!<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span>(i)<span class="hljs-keyword">return</span> i(o,!<span class="hljs-number">0</span>);<span class="hljs-keyword">var</span> f=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Cannot find module '"</span>+o+<span class="hljs-string">"'"</span>);<span class="hljs-keyword">throw</span> f.code=<span class="hljs-string">"MODULE_NOT_FOUND"</span>,f}<span class="hljs-keyword">var</span> l=n[o]={<span class="hljs-attr">exports</span>:{}};t[o][<span class="hljs-number">0</span>].call(l.exports,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">var</span> n=t[o][<span class="hljs-number">1</span>][e];<span class="hljs-keyword">return</span> s(n?n:e)},l,l.exports,e,t,n,r)}<span class="hljs-keyword">return</span> n[o].exports}<span class="hljs-keyword">var</span> i=<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">require</span>==<span class="hljs-string">"function"</span>&amp;&amp;<span class="hljs-built_in">require</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> o=<span class="hljs-number">0</span>;o&lt;r.length;o++)s(r[o]);<span class="hljs-keyword">return</span> s})({<span class="hljs-number">1</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.CollectionAdd
 *
 * A state for adding attachments to a collection (e.g. video playlist).
 *
 * @class
 * @augments wp.media.controller.Library
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 *
 * @param {object}                     [attributes]                         The attributes hash passed to the state.
 * @param {string}                     [attributes.id=library]      Unique identifier.
 * @param {string}                     attributes.title                    Title for the state. Displays in the frame's title region.
 * @param {boolean}                    [attributes.multiple=add]            Whether multi-select is enabled. @todo 'add' doesn't seem do anything special, and gets used as a boolean.
 * @param {wp.media.model.Attachments} [attributes.library]                 The attachments collection to browse.
 *                                                                          If one is not supplied, a collection of attachments of the specified type will be created.
 * @param {boolean|string}             [attributes.filterable=uploaded]     Whether the library is filterable, and if so what filters should be shown.
 *                                                                          Accepts 'all', 'uploaded', or 'unattached'.
 * @param {string}                     [attributes.menu=gallery]            Initial mode for the menu region.
 * @param {string}                     [attributes.content=upload]          Initial mode for the content region.
 *                                                                          Overridden by persistent user setting if 'contentUserSetting' is true.
 * @param {string}                     [attributes.router=browse]           Initial mode for the router region.
 * @param {string}                     [attributes.toolbar=gallery-add]     Initial mode for the toolbar region.
 * @param {boolean}                    [attributes.searchable=true]         Whether the library is searchable.
 * @param {boolean}                    [attributes.sortable=true]           Whether the Attachments should be sortable. Depends on the orderby property being set to menuOrder on the attachments collection.
 * @param {boolean}                    [attributes.autoSelect=true]         Whether an uploaded attachment should be automatically added to the selection.
 * @param {boolean}                    [attributes.contentUserSetting=true] Whether the content region's mode should be set and persisted per user.
 * @param {int}                        [attributes.priority=100]            The priority for the state link in the media menu.
 * @param {boolean}                    [attributes.syncSelection=false]     Whether the Attachments selection should be persisted from the last state.
 *                                                                          Defaults to false because for this state, because the library of the Edit Gallery state is the selection.
 * @param {string}                     attributes.type                   The collection's media type. (e.g. 'video').
 * @param {string}                     attributes.collectionType         The collection type. (e.g. 'playlist').
 */</span>
<span class="hljs-keyword">var</span> Selection = wp.media.model.Selection,
	Library = wp.media.controller.Library,
	CollectionAdd;

CollectionAdd = Library.extend({
	<span class="hljs-attr">defaults</span>: _.defaults( {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Selection defaults. @see media.model.Selection</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		multiple:      <span class="hljs-string">'add'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Attachments browser defaults. @see media.view.AttachmentsBrowser</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		filterable:    <span class="hljs-string">'uploaded'</span>,

		<span class="hljs-attr">priority</span>:      <span class="hljs-number">100</span>,
		<span class="hljs-attr">syncSelection</span>: <span class="hljs-literal">false</span>
	}, Library.prototype.defaults ),

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> collectionType = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'collectionType'</span>);

		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'video'</span> === <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'type'</span> ) ) {
			collectionType = <span class="hljs-string">'video-'</span> + collectionType;
		}

		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'id'</span>, collectionType + <span class="hljs-string">'-library'</span> );
		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'toolbar'</span>, collectionType + <span class="hljs-string">'-add'</span> );
		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'menu'</span>, collectionType );</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>If we haven’t been provided a <code>library</code>, create a <code>Selection</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>) ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'library'</span>, wp.media.query({ <span class="hljs-attr">type</span>: <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'type'</span>) }) );
		}
		Library.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	activate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> library = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>),
			editLibrary = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'editLibrary'</span>),
			edit = <span class="hljs-keyword">this</span>.frame.state( <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'collectionType'</span>) + <span class="hljs-string">'-edit'</span> ).get(<span class="hljs-string">'library'</span>);

		<span class="hljs-keyword">if</span> ( editLibrary &amp;&amp; editLibrary !== edit ) {
			library.unobserve( editLibrary );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Accepts attachments that exist in the original library and
that do not exist in gallery’s library.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		library.validator = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
			<span class="hljs-keyword">return</span> !! <span class="hljs-keyword">this</span>.mirroring.get( attachment.cid ) &amp;&amp; ! edit.get( attachment.cid ) &amp;&amp; Selection.prototype.validator.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Reset the library to ensure that all attachments are re-added
to the collection. Do so silently, as calling <code>observe</code> will
trigger the <code>reset</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		library.reset( library.mirroring.models, { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> });
		library.observe( edit );
		<span class="hljs-keyword">this</span>.set(<span class="hljs-string">'editLibrary'</span>, edit);

		Library.prototype.activate.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	}
});

<span class="hljs-built_in">module</span>.exports = CollectionAdd;

},{}],<span class="hljs-number">2</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.CollectionEdit
 *
 * A state for editing a collection, which is used by audio and video playlists,
 * and can be used for other collections.
 *
 * @class
 * @augments wp.media.controller.Library
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 *
 * @param {object}                     [attributes]                      The attributes hash passed to the state.
 * @param {string}                     attributes.title                  Title for the state. Displays in the media menu and the frame's title region.
 * @param {wp.media.model.Attachments} [attributes.library]              The attachments collection to edit.
 *                                                                       If one is not supplied, an empty media.model.Selection collection is created.
 * @param {boolean}                    [attributes.multiple=false]       Whether multi-select is enabled.
 * @param {string}                     [attributes.content=browse]       Initial mode for the content region.
 * @param {string}                     attributes.menu                   Initial mode for the menu region. @todo this needs a better explanation.
 * @param {boolean}                    [attributes.searchable=false]     Whether the library is searchable.
 * @param {boolean}                    [attributes.sortable=true]        Whether the Attachments should be sortable. Depends on the orderby property being set to menuOrder on the attachments collection.
 * @param {boolean}                    [attributes.date=true]            Whether to show the date filter in the browser's toolbar.
 * @param {boolean}                    [attributes.describe=true]        Whether to offer UI to describe the attachments - e.g. captioning images in a gallery.
 * @param {boolean}                    [attributes.dragInfo=true]        Whether to show instructional text about the attachments being sortable.
 * @param {boolean}                    [attributes.dragInfoText]         Instructional text about the attachments being sortable.
 * @param {int}                        [attributes.idealColumnWidth=170] The ideal column width in pixels for attachments.
 * @param {boolean}                    [attributes.editing=false]        Whether the gallery is being created, or editing an existing instance.
 * @param {int}                        [attributes.priority=60]          The priority for the state link in the media menu.
 * @param {boolean}                    [attributes.syncSelection=false]  Whether the Attachments selection should be persisted from the last state.
 *                                                                       Defaults to false for this state, because the library passed in  *is* the selection.
 * @param {view}                       [attributes.SettingsView]         The view to edit the collection instance settings (e.g. Playlist settings with "Show tracklist" checkbox).
 * @param {view}                       [attributes.AttachmentView]       The single `Attachment` view to be used in the `Attachments`.
 *                                                                       If none supplied, defaults to wp.media.view.Attachment.EditLibrary.
 * @param {string}                     attributes.type                   The collection's media type. (e.g. 'video').
 * @param {string}                     attributes.collectionType         The collection type. (e.g. 'playlist').
 */</span>
<span class="hljs-keyword">var</span> Library = wp.media.controller.Library,
	l10n = wp.media.view.l10n,
	$ = jQuery,
	CollectionEdit;

CollectionEdit = Library.extend({
	<span class="hljs-attr">defaults</span>: {
		<span class="hljs-attr">multiple</span>:         <span class="hljs-literal">false</span>,
		<span class="hljs-attr">sortable</span>:         <span class="hljs-literal">true</span>,
		<span class="hljs-attr">date</span>:             <span class="hljs-literal">false</span>,
		<span class="hljs-attr">searchable</span>:       <span class="hljs-literal">false</span>,
		<span class="hljs-attr">content</span>:          <span class="hljs-string">'browse'</span>,
		<span class="hljs-attr">describe</span>:         <span class="hljs-literal">true</span>,
		<span class="hljs-attr">dragInfo</span>:         <span class="hljs-literal">true</span>,
		<span class="hljs-attr">idealColumnWidth</span>: <span class="hljs-number">170</span>,
		<span class="hljs-attr">editing</span>:          <span class="hljs-literal">false</span>,
		<span class="hljs-attr">priority</span>:         <span class="hljs-number">60</span>,
		<span class="hljs-attr">SettingsView</span>:     <span class="hljs-literal">false</span>,
		<span class="hljs-attr">syncSelection</span>:    <span class="hljs-literal">false</span>
	},

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> collectionType = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'collectionType'</span>);

		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'video'</span> === <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'type'</span> ) ) {
			collectionType = <span class="hljs-string">'video-'</span> + collectionType;
		}

		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'id'</span>, collectionType + <span class="hljs-string">'-edit'</span> );
		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'toolbar'</span>, collectionType + <span class="hljs-string">'-edit'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>If we haven’t been provided a <code>library</code>, create a <code>Selection</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>) ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'library'</span>, <span class="hljs-keyword">new</span> wp.media.model.Selection() );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>The single <code>Attachment</code> view to be used in the <code>Attachments</code> view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'AttachmentView'</span>) ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'AttachmentView'</span>, wp.media.view.Attachment.EditLibrary );
		}
		Library.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	activate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> library = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Limit the library to images only.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		library.props.set( <span class="hljs-string">'type'</span>, <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'type'</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Watch for uploaded attachments.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>).observe( wp.Uploader.queue );

		<span class="hljs-keyword">this</span>.frame.on( <span class="hljs-string">'content:render:browse'</span>, <span class="hljs-keyword">this</span>.renderSettings, <span class="hljs-keyword">this</span> );

		Library.prototype.activate.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	deactivate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Stop watching for uploaded attachments.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>).unobserve( wp.Uploader.queue );

		<span class="hljs-keyword">this</span>.frame.off( <span class="hljs-string">'content:render:browse'</span>, <span class="hljs-keyword">this</span>.renderSettings, <span class="hljs-keyword">this</span> );

		Library.prototype.deactivate.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * Render the collection embed settings view in the browser sidebar.
	 *
	 * @todo This is against the pattern elsewhere in media. Typically the frame
	 *       is responsible for adding region mode callbacks. Explain.
	 *
	 * @since 3.9.0
	 *
	 * @param {wp.media.view.attachmentsBrowser} The attachments browser view.
	 */</span>
	renderSettings: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachmentsBrowserView </span>) </span>{
		<span class="hljs-keyword">var</span> library = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>),
			collectionType = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'collectionType'</span>),
			dragInfoText = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'dragInfoText'</span>),
			SettingsView = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'SettingsView'</span>),
			obj = {};

		<span class="hljs-keyword">if</span> ( ! library || ! attachmentsBrowserView ) {
			<span class="hljs-keyword">return</span>;
		}

		library[ collectionType ] = library[ collectionType ] || <span class="hljs-keyword">new</span> Backbone.Model();

		obj[ collectionType ] = <span class="hljs-keyword">new</span> SettingsView({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">model</span>:      library[ collectionType ],
			<span class="hljs-attr">priority</span>:   <span class="hljs-number">40</span>
		});

		attachmentsBrowserView.sidebar.set( obj );

		<span class="hljs-keyword">if</span> ( dragInfoText ) {
			attachmentsBrowserView.toolbar.set( <span class="hljs-string">'dragInfo'</span>, <span class="hljs-keyword">new</span> wp.media.View({
				<span class="hljs-attr">el</span>: $( <span class="hljs-string">'&lt;div class="instructions"&gt;'</span> + dragInfoText + <span class="hljs-string">'&lt;/div&gt;'</span> )[<span class="hljs-number">0</span>],
				<span class="hljs-attr">priority</span>: <span class="hljs-number">-40</span>
			}) );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Add the ‘Reverse order’ button to the toolbar.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		attachmentsBrowserView.toolbar.set( <span class="hljs-string">'reverse'</span>, {
			<span class="hljs-attr">text</span>:     l10n.reverseOrder,
			<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,

			<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				library.reset( library.toArray().reverse() );
			}
		});
	}
});

<span class="hljs-built_in">module</span>.exports = CollectionEdit;

},{}],<span class="hljs-number">3</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.Cropper
 *
 * A state for cropping an image.
 *
 * @class
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 */</span>
<span class="hljs-keyword">var</span> l10n = wp.media.view.l10n,
	Cropper;

Cropper = wp.media.controller.State.extend({
	<span class="hljs-attr">defaults</span>: {
		<span class="hljs-attr">id</span>:          <span class="hljs-string">'cropper'</span>,
		<span class="hljs-attr">title</span>:       l10n.cropImage,</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Region mode defaults.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		toolbar:     <span class="hljs-string">'crop'</span>,
		<span class="hljs-attr">content</span>:     <span class="hljs-string">'crop'</span>,
		<span class="hljs-attr">router</span>:      <span class="hljs-literal">false</span>,
		<span class="hljs-attr">canSkipCrop</span>: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Default doCrop Ajax arguments to allow the Customizer (for example) to inject state.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		doCropArgs: {}
	},

	<span class="hljs-attr">activate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.frame.on( <span class="hljs-string">'content:create:crop'</span>, <span class="hljs-keyword">this</span>.createCropContent, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.frame.on( <span class="hljs-string">'close'</span>, <span class="hljs-keyword">this</span>.removeCropper, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.set(<span class="hljs-string">'selection'</span>, <span class="hljs-keyword">new</span> Backbone.Collection(<span class="hljs-keyword">this</span>.frame._selection.single));
	},

	<span class="hljs-attr">deactivate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.frame.toolbar.mode(<span class="hljs-string">'browse'</span>);
	},

	<span class="hljs-attr">createCropContent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.cropperView = <span class="hljs-keyword">new</span> wp.media.view.Cropper({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">attachment</span>: <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>).first()
		});
		<span class="hljs-keyword">this</span>.cropperView.on(<span class="hljs-string">'image-loaded'</span>, <span class="hljs-keyword">this</span>.createCropToolbar, <span class="hljs-keyword">this</span>);
		<span class="hljs-keyword">this</span>.frame.content.set(<span class="hljs-keyword">this</span>.cropperView);

	},
	<span class="hljs-attr">removeCropper</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.imgSelect.cancelSelection();
		<span class="hljs-keyword">this</span>.imgSelect.setOptions({<span class="hljs-attr">remove</span>: <span class="hljs-literal">true</span>});
		<span class="hljs-keyword">this</span>.imgSelect.update();
		<span class="hljs-keyword">this</span>.cropperView.remove();
	},
	<span class="hljs-attr">createCropToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> canSkipCrop, toolbarOptions;

		canSkipCrop = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'canSkipCrop'</span>) || <span class="hljs-literal">false</span>;

		toolbarOptions = {
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.frame,
			<span class="hljs-attr">items</span>: {
				<span class="hljs-attr">insert</span>: {
					<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
					<span class="hljs-attr">text</span>:     l10n.cropImage,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,
					<span class="hljs-attr">requires</span>: { <span class="hljs-attr">library</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">selection</span>: <span class="hljs-literal">false</span> },

					<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>.controller,
							selection;

						selection = controller.state().get(<span class="hljs-string">'selection'</span>).first();
						selection.set({<span class="hljs-attr">cropDetails</span>: controller.state().imgSelect.getSelection()});

						<span class="hljs-keyword">this</span>.$el.text(l10n.cropping);
						<span class="hljs-keyword">this</span>.$el.attr(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">true</span>);

						controller.state().doCrop( selection ).done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> croppedImage </span>) </span>{
							controller.trigger(<span class="hljs-string">'cropped'</span>, croppedImage );
							controller.close();
						}).fail( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
							controller.trigger(<span class="hljs-string">'content:error:crop'</span>);
						});
					}
				}
			}
		};

		<span class="hljs-keyword">if</span> ( canSkipCrop ) {
			_.extend( toolbarOptions.items, {
				<span class="hljs-attr">skip</span>: {
					<span class="hljs-attr">style</span>:      <span class="hljs-string">'secondary'</span>,
					<span class="hljs-attr">text</span>:       l10n.skipCropping,
					<span class="hljs-attr">priority</span>:   <span class="hljs-number">70</span>,
					<span class="hljs-attr">requires</span>:   { <span class="hljs-attr">library</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">selection</span>: <span class="hljs-literal">false</span> },
					<span class="hljs-attr">click</span>:      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.controller.state().get(<span class="hljs-string">'selection'</span>).first();
						<span class="hljs-keyword">this</span>.controller.state().cropperView.remove();
						<span class="hljs-keyword">this</span>.controller.trigger(<span class="hljs-string">'skippedcrop'</span>, selection);
						<span class="hljs-keyword">this</span>.controller.close();
					}
				}
			});
		}

		<span class="hljs-keyword">this</span>.frame.toolbar.set( <span class="hljs-keyword">new</span> wp.media.view.Toolbar(toolbarOptions) );
	},

	<span class="hljs-attr">doCrop</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
		<span class="hljs-keyword">return</span> wp.ajax.post( <span class="hljs-string">'custom-header-crop'</span>, _.extend(
			{},
			<span class="hljs-keyword">this</span>.defaults.doCropArgs,
			{
				<span class="hljs-attr">nonce</span>: attachment.get( <span class="hljs-string">'nonces'</span> ).edit,
				<span class="hljs-attr">id</span>: attachment.get( <span class="hljs-string">'id'</span> ),
				<span class="hljs-attr">cropDetails</span>: attachment.get( <span class="hljs-string">'cropDetails'</span> )
			}
		) );
	}
});

<span class="hljs-built_in">module</span>.exports = Cropper;

},{}],<span class="hljs-number">4</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.CustomizeImageCropper
 *
 * A state for cropping an image.
 *
 * @class
 * @augments wp.media.controller.Cropper
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 */</span>
<span class="hljs-keyword">var</span> Controller = wp.media.controller,
	CustomizeImageCropper;

CustomizeImageCropper = Controller.Cropper.extend({
	<span class="hljs-attr">doCrop</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
		<span class="hljs-keyword">var</span> cropDetails = attachment.get( <span class="hljs-string">'cropDetails'</span> ),
			control = <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'control'</span> ),
			ratio = cropDetails.width / cropDetails.height;</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Use crop measurements when flexible in both directions.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( control.params.flex_width &amp;&amp; control.params.flex_height ) {
			cropDetails.dst_width  = cropDetails.width;
			cropDetails.dst_height = cropDetails.height;</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Constrain flexible side based on image ratio and size of the fixed side.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> {
			cropDetails.dst_width  = control.params.flex_width  ? control.params.height * ratio : control.params.width;
			cropDetails.dst_height = control.params.flex_height ? control.params.width  / ratio : control.params.height;
		}

		<span class="hljs-keyword">return</span> wp.ajax.post( <span class="hljs-string">'crop-image'</span>, {
			<span class="hljs-attr">wp_customize</span>: <span class="hljs-string">'on'</span>,
			<span class="hljs-attr">nonce</span>: attachment.get( <span class="hljs-string">'nonces'</span> ).edit,
			<span class="hljs-attr">id</span>: attachment.get( <span class="hljs-string">'id'</span> ),
			<span class="hljs-attr">context</span>: control.id,
			<span class="hljs-attr">cropDetails</span>: cropDetails
		} );
	}
});

<span class="hljs-built_in">module</span>.exports = CustomizeImageCropper;

},{}],<span class="hljs-number">5</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.EditImage
 *
 * A state for editing (cropping, etc.) an image.
 *
 * @class
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 *
 * @param {object}                    attributes                      The attributes hash passed to the state.
 * @param {wp.media.model.Attachment} attributes.model                The attachment.
 * @param {string}                    [attributes.id=edit-image]      Unique identifier.
 * @param {string}                    [attributes.title=Edit Image]   Title for the state. Displays in the media menu and the frame's title region.
 * @param {string}                    [attributes.content=edit-image] Initial mode for the content region.
 * @param {string}                    [attributes.toolbar=edit-image] Initial mode for the toolbar region.
 * @param {string}                    [attributes.menu=false]         Initial mode for the menu region.
 * @param {string}                    [attributes.url]                Unused. @todo Consider removal.
 */</span>
<span class="hljs-keyword">var</span> l10n = wp.media.view.l10n,
	EditImage;

EditImage = wp.media.controller.State.extend({
	<span class="hljs-attr">defaults</span>: {
		<span class="hljs-attr">id</span>:      <span class="hljs-string">'edit-image'</span>,
		<span class="hljs-attr">title</span>:   l10n.editImage,
		<span class="hljs-attr">menu</span>:    <span class="hljs-literal">false</span>,
		<span class="hljs-attr">toolbar</span>: <span class="hljs-string">'edit-image'</span>,
		<span class="hljs-attr">content</span>: <span class="hljs-string">'edit-image'</span>,
		<span class="hljs-attr">url</span>:     <span class="hljs-string">''</span>
	},

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	activate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.frame.on( <span class="hljs-string">'toolbar:render:edit-image'</span>, _.bind( <span class="hljs-keyword">this</span>.toolbar, <span class="hljs-keyword">this</span> ) );
	},

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	deactivate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.frame.off( <span class="hljs-string">'toolbar:render:edit-image'</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	toolbar: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> frame = <span class="hljs-keyword">this</span>.frame,
			lastState = frame.lastState(),
			previous = lastState &amp;&amp; lastState.id;

		frame.toolbar.set( <span class="hljs-keyword">new</span> wp.media.view.Toolbar({
			<span class="hljs-attr">controller</span>: frame,
			<span class="hljs-attr">items</span>: {
				<span class="hljs-attr">back</span>: {
					<span class="hljs-attr">style</span>: <span class="hljs-string">'primary'</span>,
					<span class="hljs-attr">text</span>:     l10n.back,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
					<span class="hljs-attr">click</span>:    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">if</span> ( previous ) {
							frame.setState( previous );
						} <span class="hljs-keyword">else</span> {
							frame.close();
						}
					}
				}
			}
		}) );
	}
});

<span class="hljs-built_in">module</span>.exports = EditImage;

},{}],<span class="hljs-number">6</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.Embed
 *
 * A state for embedding media from a URL.
 *
 * @class
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 *
 * @param {object} attributes                         The attributes hash passed to the state.
 * @param {string} [attributes.id=embed]              Unique identifier.
 * @param {string} [attributes.title=Insert From URL] Title for the state. Displays in the media menu and the frame's title region.
 * @param {string} [attributes.content=embed]         Initial mode for the content region.
 * @param {string} [attributes.menu=default]          Initial mode for the menu region.
 * @param {string} [attributes.toolbar=main-embed]    Initial mode for the toolbar region.
 * @param {string} [attributes.menu=false]            Initial mode for the menu region.
 * @param {int}    [attributes.priority=120]          The priority for the state link in the media menu.
 * @param {string} [attributes.type=link]             The type of embed. Currently only link is supported.
 * @param {string} [attributes.url]                   The embed URL.
 * @param {object} [attributes.metadata={}]           Properties of the embed, which will override attributes.url if set.
 */</span>
<span class="hljs-keyword">var</span> l10n = wp.media.view.l10n,
	$ = Backbone.$,
	Embed;

Embed = wp.media.controller.State.extend({
	<span class="hljs-attr">defaults</span>: {
		<span class="hljs-attr">id</span>:       <span class="hljs-string">'embed'</span>,
		<span class="hljs-attr">title</span>:    l10n.insertFromUrlTitle,
		<span class="hljs-attr">content</span>:  <span class="hljs-string">'embed'</span>,
		<span class="hljs-attr">menu</span>:     <span class="hljs-string">'default'</span>,
		<span class="hljs-attr">toolbar</span>:  <span class="hljs-string">'main-embed'</span>,
		<span class="hljs-attr">priority</span>: <span class="hljs-number">120</span>,
		<span class="hljs-attr">type</span>:     <span class="hljs-string">'link'</span>,
		<span class="hljs-attr">url</span>:      <span class="hljs-string">''</span>,
		<span class="hljs-attr">metadata</span>: {}
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>The amount of time used when debouncing the scan.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	sensitivity: <span class="hljs-number">400</span>,

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
		<span class="hljs-keyword">this</span>.metadata = options.metadata;
		<span class="hljs-keyword">this</span>.debouncedScan = _.debounce( _.bind( <span class="hljs-keyword">this</span>.scan, <span class="hljs-keyword">this</span> ), <span class="hljs-keyword">this</span>.sensitivity );
		<span class="hljs-keyword">this</span>.props = <span class="hljs-keyword">new</span> Backbone.Model( <span class="hljs-keyword">this</span>.metadata || { <span class="hljs-attr">url</span>: <span class="hljs-string">''</span> });
		<span class="hljs-keyword">this</span>.props.on( <span class="hljs-string">'change:url'</span>, <span class="hljs-keyword">this</span>.debouncedScan, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.props.on( <span class="hljs-string">'change:url'</span>, <span class="hljs-keyword">this</span>.refresh, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'scan'</span>, <span class="hljs-keyword">this</span>.scanImage, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-comment">/**
	 * Trigger a scan of the embedded URL's content for metadata required to embed.
	 *
	 * @fires wp.media.controller.Embed#scan
	 */</span>
	scan: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> scanners,
			embed = <span class="hljs-keyword">this</span>,
			attributes = {
				<span class="hljs-attr">type</span>: <span class="hljs-string">'link'</span>,
				<span class="hljs-attr">scanners</span>: []
			};</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Scan is triggered with the list of <code>attributes</code> to set on the
state, useful for the ‘type’ attribute and ‘scanners’ attribute,
an array of promise objects for asynchronous scan operations.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'url'</span>) ) {
			<span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'scan'</span>, attributes );
		}

		<span class="hljs-keyword">if</span> ( attributes.scanners.length ) {
			scanners = attributes.scanners = $.when.apply( $, attributes.scanners );
			scanners.always( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">if</span> ( embed.get(<span class="hljs-string">'scanners'</span>) === scanners ) {
					embed.set( <span class="hljs-string">'loading'</span>, <span class="hljs-literal">false</span> );
				}
			});
		} <span class="hljs-keyword">else</span> {
			attributes.scanners = <span class="hljs-literal">null</span>;
		}

		attributes.loading = !! attributes.scanners;
		<span class="hljs-keyword">this</span>.set( attributes );
	},
	<span class="hljs-comment">/**
	 * Try scanning the embed as an image to discover its dimensions.
	 *
	 * @param {Object} attributes
	 */</span>
	scanImage: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attributes </span>) </span>{
		<span class="hljs-keyword">var</span> frame = <span class="hljs-keyword">this</span>.frame,
			state = <span class="hljs-keyword">this</span>,
			url = <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'url'</span>),
			image = <span class="hljs-keyword">new</span> Image(),
			deferred = $.Deferred();

		attributes.scanners.push( deferred.promise() );</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Try to load the image and find its width/height.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		image.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			deferred.resolve();

			<span class="hljs-keyword">if</span> ( state !== frame.state() || url !== state.props.get(<span class="hljs-string">'url'</span>) ) {
				<span class="hljs-keyword">return</span>;
			}

			state.set({
				<span class="hljs-attr">type</span>: <span class="hljs-string">'image'</span>
			});

			state.props.set({
				<span class="hljs-attr">width</span>:  image.width,
				<span class="hljs-attr">height</span>: image.height
			});
		};

		image.onerror = deferred.reject;
		image.src = url;
	},

	<span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.frame.toolbar.get().refresh();
	},

	<span class="hljs-attr">reset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.props.clear().set({ <span class="hljs-attr">url</span>: <span class="hljs-string">''</span> });

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.active ) {
			<span class="hljs-keyword">this</span>.refresh();
		}
	}
});

<span class="hljs-built_in">module</span>.exports = Embed;

},{}],<span class="hljs-number">7</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.FeaturedImage
 *
 * A state for selecting a featured image for a post.
 *
 * @class
 * @augments wp.media.controller.Library
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 *
 * @param {object}                     [attributes]                          The attributes hash passed to the state.
 * @param {string}                     [attributes.id=featured-image]        Unique identifier.
 * @param {string}                     [attributes.title=Set Featured Image] Title for the state. Displays in the media menu and the frame's title region.
 * @param {wp.media.model.Attachments} [attributes.library]                  The attachments collection to browse.
 *                                                                           If one is not supplied, a collection of all images will be created.
 * @param {boolean}                    [attributes.multiple=false]           Whether multi-select is enabled.
 * @param {string}                     [attributes.content=upload]           Initial mode for the content region.
 *                                                                           Overridden by persistent user setting if 'contentUserSetting' is true.
 * @param {string}                     [attributes.menu=default]             Initial mode for the menu region.
 * @param {string}                     [attributes.router=browse]            Initial mode for the router region.
 * @param {string}                     [attributes.toolbar=featured-image]   Initial mode for the toolbar region.
 * @param {int}                        [attributes.priority=60]              The priority for the state link in the media menu.
 * @param {boolean}                    [attributes.searchable=true]          Whether the library is searchable.
 * @param {boolean|string}             [attributes.filterable=false]         Whether the library is filterable, and if so what filters should be shown.
 *                                                                           Accepts 'all', 'uploaded', or 'unattached'.
 * @param {boolean}                    [attributes.sortable=true]            Whether the Attachments should be sortable. Depends on the orderby property being set to menuOrder on the attachments collection.
 * @param {boolean}                    [attributes.autoSelect=true]          Whether an uploaded attachment should be automatically added to the selection.
 * @param {boolean}                    [attributes.describe=false]           Whether to offer UI to describe attachments - e.g. captioning images in a gallery.
 * @param {boolean}                    [attributes.contentUserSetting=true]  Whether the content region's mode should be set and persisted per user.
 * @param {boolean}                    [attributes.syncSelection=true]       Whether the Attachments selection should be persisted from the last state.
 */</span>
<span class="hljs-keyword">var</span> Attachment = wp.media.model.Attachment,
	Library = wp.media.controller.Library,
	l10n = wp.media.view.l10n,
	FeaturedImage;

FeaturedImage = Library.extend({
	<span class="hljs-attr">defaults</span>: _.defaults({
		<span class="hljs-attr">id</span>:            <span class="hljs-string">'featured-image'</span>,
		<span class="hljs-attr">title</span>:         l10n.setFeaturedImageTitle,
		<span class="hljs-attr">multiple</span>:      <span class="hljs-literal">false</span>,
		<span class="hljs-attr">filterable</span>:    <span class="hljs-string">'uploaded'</span>,
		<span class="hljs-attr">toolbar</span>:       <span class="hljs-string">'featured-image'</span>,
		<span class="hljs-attr">priority</span>:      <span class="hljs-number">60</span>,
		<span class="hljs-attr">syncSelection</span>: <span class="hljs-literal">true</span>
	}, Library.prototype.defaults ),

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> library, comparator;</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>If we haven’t been provided a <code>library</code>, create a <code>Selection</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>) ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'library'</span>, wp.media.query({ <span class="hljs-attr">type</span>: <span class="hljs-string">'image'</span> }) );
		}

		Library.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );

		library    = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>);
		comparator = library.comparator;</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Overload the library’s comparator to push items that are not in
the mirrored query to the front of the aggregate collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		library.comparator = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> a, b </span>) </span>{
			<span class="hljs-keyword">var</span> aInQuery = !! <span class="hljs-keyword">this</span>.mirroring.get( a.cid ),
				bInQuery = !! <span class="hljs-keyword">this</span>.mirroring.get( b.cid );

			<span class="hljs-keyword">if</span> ( ! aInQuery &amp;&amp; bInQuery ) {
				<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( aInQuery &amp;&amp; ! bInQuery ) {
				<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span> comparator.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
			}
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Add all items in the selection to the library, so any featured
images that are not initially loaded still appear.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		library.observe( <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>) );
	},

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	activate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.updateSelection();
		<span class="hljs-keyword">this</span>.frame.on( <span class="hljs-string">'open'</span>, <span class="hljs-keyword">this</span>.updateSelection, <span class="hljs-keyword">this</span> );

		Library.prototype.activate.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	deactivate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.frame.off( <span class="hljs-string">'open'</span>, <span class="hljs-keyword">this</span>.updateSelection, <span class="hljs-keyword">this</span> );

		Library.prototype.deactivate.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	updateSelection: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>),
			id = wp.media.view.settings.post.featuredImageId,
			attachment;

		<span class="hljs-keyword">if</span> ( <span class="hljs-string">''</span> !== id &amp;&amp; <span class="hljs-number">-1</span> !== id ) {
			attachment = Attachment.get( id );
			attachment.fetch();
		}

		selection.reset( attachment ? [ attachment ] : [] );
	}
});

<span class="hljs-built_in">module</span>.exports = FeaturedImage;

},{}],<span class="hljs-number">8</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.GalleryAdd
 *
 * A state for selecting more images to add to a gallery.
 *
 * @class
 * @augments wp.media.controller.Library
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 *
 * @param {object}                     [attributes]                         The attributes hash passed to the state.
 * @param {string}                     [attributes.id=gallery-library]      Unique identifier.
 * @param {string}                     [attributes.title=Add to Gallery]    Title for the state. Displays in the frame's title region.
 * @param {boolean}                    [attributes.multiple=add]            Whether multi-select is enabled. @todo 'add' doesn't seem do anything special, and gets used as a boolean.
 * @param {wp.media.model.Attachments} [attributes.library]                 The attachments collection to browse.
 *                                                                          If one is not supplied, a collection of all images will be created.
 * @param {boolean|string}             [attributes.filterable=uploaded]     Whether the library is filterable, and if so what filters should be shown.
 *                                                                          Accepts 'all', 'uploaded', or 'unattached'.
 * @param {string}                     [attributes.menu=gallery]            Initial mode for the menu region.
 * @param {string}                     [attributes.content=upload]          Initial mode for the content region.
 *                                                                          Overridden by persistent user setting if 'contentUserSetting' is true.
 * @param {string}                     [attributes.router=browse]           Initial mode for the router region.
 * @param {string}                     [attributes.toolbar=gallery-add]     Initial mode for the toolbar region.
 * @param {boolean}                    [attributes.searchable=true]         Whether the library is searchable.
 * @param {boolean}                    [attributes.sortable=true]           Whether the Attachments should be sortable. Depends on the orderby property being set to menuOrder on the attachments collection.
 * @param {boolean}                    [attributes.autoSelect=true]         Whether an uploaded attachment should be automatically added to the selection.
 * @param {boolean}                    [attributes.contentUserSetting=true] Whether the content region's mode should be set and persisted per user.
 * @param {int}                        [attributes.priority=100]            The priority for the state link in the media menu.
 * @param {boolean}                    [attributes.syncSelection=false]     Whether the Attachments selection should be persisted from the last state.
 *                                                                          Defaults to false because for this state, because the library of the Edit Gallery state is the selection.
 */</span>
<span class="hljs-keyword">var</span> Selection = wp.media.model.Selection,
	Library = wp.media.controller.Library,
	l10n = wp.media.view.l10n,
	GalleryAdd;

GalleryAdd = Library.extend({
	<span class="hljs-attr">defaults</span>: _.defaults({
		<span class="hljs-attr">id</span>:            <span class="hljs-string">'gallery-library'</span>,
		<span class="hljs-attr">title</span>:         l10n.addToGalleryTitle,
		<span class="hljs-attr">multiple</span>:      <span class="hljs-string">'add'</span>,
		<span class="hljs-attr">filterable</span>:    <span class="hljs-string">'uploaded'</span>,
		<span class="hljs-attr">menu</span>:          <span class="hljs-string">'gallery'</span>,
		<span class="hljs-attr">toolbar</span>:       <span class="hljs-string">'gallery-add'</span>,
		<span class="hljs-attr">priority</span>:      <span class="hljs-number">100</span>,
		<span class="hljs-attr">syncSelection</span>: <span class="hljs-literal">false</span>
	}, Library.prototype.defaults ),

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>If a library wasn’t supplied, create a library of images.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>) ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'library'</span>, wp.media.query({ <span class="hljs-attr">type</span>: <span class="hljs-string">'image'</span> }) );
		}

		Library.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	activate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> library = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>),
			edit    = <span class="hljs-keyword">this</span>.frame.state(<span class="hljs-string">'gallery-edit'</span>).get(<span class="hljs-string">'library'</span>);

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.editLibrary &amp;&amp; <span class="hljs-keyword">this</span>.editLibrary !== edit ) {
			library.unobserve( <span class="hljs-keyword">this</span>.editLibrary );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Accepts attachments that exist in the original library and
that do not exist in gallery’s library.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		library.validator = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
			<span class="hljs-keyword">return</span> !! <span class="hljs-keyword">this</span>.mirroring.get( attachment.cid ) &amp;&amp; ! edit.get( attachment.cid ) &amp;&amp; Selection.prototype.validator.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Reset the library to ensure that all attachments are re-added
to the collection. Do so silently, as calling <code>observe</code> will
trigger the <code>reset</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		library.reset( library.mirroring.models, { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> });
		library.observe( edit );
		<span class="hljs-keyword">this</span>.editLibrary = edit;

		Library.prototype.activate.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	}
});

<span class="hljs-built_in">module</span>.exports = GalleryAdd;

},{}],<span class="hljs-number">9</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.GalleryEdit
 *
 * A state for editing a gallery's images and settings.
 *
 * @class
 * @augments wp.media.controller.Library
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 *
 * @param {object}                     [attributes]                       The attributes hash passed to the state.
 * @param {string}                     [attributes.id=gallery-edit]       Unique identifier.
 * @param {string}                     [attributes.title=Edit Gallery]    Title for the state. Displays in the frame's title region.
 * @param {wp.media.model.Attachments} [attributes.library]               The collection of attachments in the gallery.
 *                                                                        If one is not supplied, an empty media.model.Selection collection is created.
 * @param {boolean}                    [attributes.multiple=false]        Whether multi-select is enabled.
 * @param {boolean}                    [attributes.searchable=false]      Whether the library is searchable.
 * @param {boolean}                    [attributes.sortable=true]         Whether the Attachments should be sortable. Depends on the orderby property being set to menuOrder on the attachments collection.
 * @param {boolean}                    [attributes.date=true]             Whether to show the date filter in the browser's toolbar.
 * @param {string|false}               [attributes.content=browse]        Initial mode for the content region.
 * @param {string|false}               [attributes.toolbar=image-details] Initial mode for the toolbar region.
 * @param {boolean}                    [attributes.describe=true]         Whether to offer UI to describe attachments - e.g. captioning images in a gallery.
 * @param {boolean}                    [attributes.displaySettings=true]  Whether to show the attachment display settings interface.
 * @param {boolean}                    [attributes.dragInfo=true]         Whether to show instructional text about the attachments being sortable.
 * @param {int}                        [attributes.idealColumnWidth=170]  The ideal column width in pixels for attachments.
 * @param {boolean}                    [attributes.editing=false]         Whether the gallery is being created, or editing an existing instance.
 * @param {int}                        [attributes.priority=60]           The priority for the state link in the media menu.
 * @param {boolean}                    [attributes.syncSelection=false]   Whether the Attachments selection should be persisted from the last state.
 *                                                                        Defaults to false for this state, because the library passed in  *is* the selection.
 * @param {view}                       [attributes.AttachmentView]        The single `Attachment` view to be used in the `Attachments`.
 *                                                                        If none supplied, defaults to wp.media.view.Attachment.EditLibrary.
 */</span>
<span class="hljs-keyword">var</span> Library = wp.media.controller.Library,
	l10n = wp.media.view.l10n,
	GalleryEdit;

GalleryEdit = Library.extend({
	<span class="hljs-attr">defaults</span>: {
		<span class="hljs-attr">id</span>:               <span class="hljs-string">'gallery-edit'</span>,
		<span class="hljs-attr">title</span>:            l10n.editGalleryTitle,
		<span class="hljs-attr">multiple</span>:         <span class="hljs-literal">false</span>,
		<span class="hljs-attr">searchable</span>:       <span class="hljs-literal">false</span>,
		<span class="hljs-attr">sortable</span>:         <span class="hljs-literal">true</span>,
		<span class="hljs-attr">date</span>:             <span class="hljs-literal">false</span>,
		<span class="hljs-attr">display</span>:          <span class="hljs-literal">false</span>,
		<span class="hljs-attr">content</span>:          <span class="hljs-string">'browse'</span>,
		<span class="hljs-attr">toolbar</span>:          <span class="hljs-string">'gallery-edit'</span>,
		<span class="hljs-attr">describe</span>:         <span class="hljs-literal">true</span>,
		<span class="hljs-attr">displaySettings</span>:  <span class="hljs-literal">true</span>,
		<span class="hljs-attr">dragInfo</span>:         <span class="hljs-literal">true</span>,
		<span class="hljs-attr">idealColumnWidth</span>: <span class="hljs-number">170</span>,
		<span class="hljs-attr">editing</span>:          <span class="hljs-literal">false</span>,
		<span class="hljs-attr">priority</span>:         <span class="hljs-number">60</span>,
		<span class="hljs-attr">syncSelection</span>:    <span class="hljs-literal">false</span>
	},

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>If we haven’t been provided a <code>library</code>, create a <code>Selection</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>) ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'library'</span>, <span class="hljs-keyword">new</span> wp.media.model.Selection() );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>The single <code>Attachment</code> view to be used in the <code>Attachments</code> view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'AttachmentView'</span>) ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'AttachmentView'</span>, wp.media.view.Attachment.EditLibrary );
		}

		Library.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	activate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> library = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Limit the library to images only.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		library.props.set( <span class="hljs-string">'type'</span>, <span class="hljs-string">'image'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Watch for uploaded attachments.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>).observe( wp.Uploader.queue );

		<span class="hljs-keyword">this</span>.frame.on( <span class="hljs-string">'content:render:browse'</span>, <span class="hljs-keyword">this</span>.gallerySettings, <span class="hljs-keyword">this</span> );

		Library.prototype.activate.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	deactivate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Stop watching for uploaded attachments.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>).unobserve( wp.Uploader.queue );

		<span class="hljs-keyword">this</span>.frame.off( <span class="hljs-string">'content:render:browse'</span>, <span class="hljs-keyword">this</span>.gallerySettings, <span class="hljs-keyword">this</span> );

		Library.prototype.deactivate.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 *
	 * @param browser
	 */</span>
	gallerySettings: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> browser </span>) </span>{
		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'displaySettings'</span>) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">var</span> library = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>);

		<span class="hljs-keyword">if</span> ( ! library || ! browser ) {
			<span class="hljs-keyword">return</span>;
		}

		library.gallery = library.gallery || <span class="hljs-keyword">new</span> Backbone.Model();

		browser.sidebar.set({
			<span class="hljs-attr">gallery</span>: <span class="hljs-keyword">new</span> wp.media.view.Settings.Gallery({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
				<span class="hljs-attr">model</span>:      library.gallery,
				<span class="hljs-attr">priority</span>:   <span class="hljs-number">40</span>
			})
		});

		browser.toolbar.set( <span class="hljs-string">'reverse'</span>, {
			<span class="hljs-attr">text</span>:     l10n.reverseOrder,
			<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,

			<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				library.reset( library.toArray().reverse() );
			}
		});
	}
});

<span class="hljs-built_in">module</span>.exports = GalleryEdit;

},{}],<span class="hljs-number">10</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.ImageDetails
 *
 * A state for editing the attachment display settings of an image that's been
 * inserted into the editor.
 *
 * @class
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 *
 * @param {object}                    [attributes]                       The attributes hash passed to the state.
 * @param {string}                    [attributes.id=image-details]      Unique identifier.
 * @param {string}                    [attributes.title=Image Details]   Title for the state. Displays in the frame's title region.
 * @param {wp.media.model.Attachment} attributes.image                   The image's model.
 * @param {string|false}              [attributes.content=image-details] Initial mode for the content region.
 * @param {string|false}              [attributes.menu=false]            Initial mode for the menu region.
 * @param {string|false}              [attributes.router=false]          Initial mode for the router region.
 * @param {string|false}              [attributes.toolbar=image-details] Initial mode for the toolbar region.
 * @param {boolean}                   [attributes.editing=false]         Unused.
 * @param {int}                       [attributes.priority=60]           Unused.
 *
 * @todo This state inherits some defaults from media.controller.Library.prototype.defaults,
 *       however this may not do anything.
 */</span>
<span class="hljs-keyword">var</span> State = wp.media.controller.State,
	Library = wp.media.controller.Library,
	l10n = wp.media.view.l10n,
	ImageDetails;

ImageDetails = State.extend({
	<span class="hljs-attr">defaults</span>: _.defaults({
		<span class="hljs-attr">id</span>:       <span class="hljs-string">'image-details'</span>,
		<span class="hljs-attr">title</span>:    l10n.imageDetailsTitle,
		<span class="hljs-attr">content</span>:  <span class="hljs-string">'image-details'</span>,
		<span class="hljs-attr">menu</span>:     <span class="hljs-literal">false</span>,
		<span class="hljs-attr">router</span>:   <span class="hljs-literal">false</span>,
		<span class="hljs-attr">toolbar</span>:  <span class="hljs-string">'image-details'</span>,
		<span class="hljs-attr">editing</span>:  <span class="hljs-literal">false</span>,
		<span class="hljs-attr">priority</span>: <span class="hljs-number">60</span>
	}, Library.prototype.defaults ),

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 *
	 * @param options Attributes
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">this</span>.image = options.image;
		State.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	activate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.frame.modal.$el.addClass(<span class="hljs-string">'image-details'</span>);
	}
});

<span class="hljs-built_in">module</span>.exports = ImageDetails;

},{}],<span class="hljs-number">11</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.Library
 *
 * A state for choosing an attachment or group of attachments from the media library.
 *
 * @class
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 * @mixes media.selectionSync
 *
 * @param {object}                          [attributes]                         The attributes hash passed to the state.
 * @param {string}                          [attributes.id=library]              Unique identifier.
 * @param {string}                          [attributes.title=Media library]     Title for the state. Displays in the media menu and the frame's title region.
 * @param {wp.media.model.Attachments}      [attributes.library]                 The attachments collection to browse.
 *                                                                               If one is not supplied, a collection of all attachments will be created.
 * @param {wp.media.model.Selection|object} [attributes.selection]               A collection to contain attachment selections within the state.
 *                                                                               If the 'selection' attribute is a plain JS object,
 *                                                                               a Selection will be created using its values as the selection instance's `props` model.
 *                                                                               Otherwise, it will copy the library's `props` model.
 * @param {boolean}                         [attributes.multiple=false]          Whether multi-select is enabled.
 * @param {string}                          [attributes.content=upload]          Initial mode for the content region.
 *                                                                               Overridden by persistent user setting if 'contentUserSetting' is true.
 * @param {string}                          [attributes.menu=default]            Initial mode for the menu region.
 * @param {string}                          [attributes.router=browse]           Initial mode for the router region.
 * @param {string}                          [attributes.toolbar=select]          Initial mode for the toolbar region.
 * @param {boolean}                         [attributes.searchable=true]         Whether the library is searchable.
 * @param {boolean|string}                  [attributes.filterable=false]        Whether the library is filterable, and if so what filters should be shown.
 *                                                                               Accepts 'all', 'uploaded', or 'unattached'.
 * @param {boolean}                         [attributes.sortable=true]           Whether the Attachments should be sortable. Depends on the orderby property being set to menuOrder on the attachments collection.
 * @param {boolean}                         [attributes.autoSelect=true]         Whether an uploaded attachment should be automatically added to the selection.
 * @param {boolean}                         [attributes.describe=false]          Whether to offer UI to describe attachments - e.g. captioning images in a gallery.
 * @param {boolean}                         [attributes.contentUserSetting=true] Whether the content region's mode should be set and persisted per user.
 * @param {boolean}                         [attributes.syncSelection=true]      Whether the Attachments selection should be persisted from the last state.
 */</span>
<span class="hljs-keyword">var</span> l10n = wp.media.view.l10n,
	getUserSetting = <span class="hljs-built_in">window</span>.getUserSetting,
	setUserSetting = <span class="hljs-built_in">window</span>.setUserSetting,
	Library;

Library = wp.media.controller.State.extend({
	<span class="hljs-attr">defaults</span>: {
		<span class="hljs-attr">id</span>:                 <span class="hljs-string">'library'</span>,
		<span class="hljs-attr">title</span>:              l10n.mediaLibraryTitle,
		<span class="hljs-attr">multiple</span>:           <span class="hljs-literal">false</span>,
		<span class="hljs-attr">content</span>:            <span class="hljs-string">'upload'</span>,
		<span class="hljs-attr">menu</span>:               <span class="hljs-string">'default'</span>,
		<span class="hljs-attr">router</span>:             <span class="hljs-string">'browse'</span>,
		<span class="hljs-attr">toolbar</span>:            <span class="hljs-string">'select'</span>,
		<span class="hljs-attr">searchable</span>:         <span class="hljs-literal">true</span>,
		<span class="hljs-attr">filterable</span>:         <span class="hljs-literal">false</span>,
		<span class="hljs-attr">sortable</span>:           <span class="hljs-literal">true</span>,
		<span class="hljs-attr">autoSelect</span>:         <span class="hljs-literal">true</span>,
		<span class="hljs-attr">describe</span>:           <span class="hljs-literal">false</span>,
		<span class="hljs-attr">contentUserSetting</span>: <span class="hljs-literal">true</span>,
		<span class="hljs-attr">syncSelection</span>:      <span class="hljs-literal">true</span>
	},

	<span class="hljs-comment">/**
	 * If a library isn't provided, query all media items.
	 * If a selection instance isn't provided, create one.
	 *
	 * @since 3.5.0
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>),
			props;

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>) ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'library'</span>, wp.media.query() );
		}

		<span class="hljs-keyword">if</span> ( ! ( selection <span class="hljs-keyword">instanceof</span> wp.media.model.Selection ) ) {
			props = selection;

			<span class="hljs-keyword">if</span> ( ! props ) {
				props = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>).props.toJSON();
				props = _.omit( props, <span class="hljs-string">'orderby'</span>, <span class="hljs-string">'query'</span> );
			}

			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'selection'</span>, <span class="hljs-keyword">new</span> wp.media.model.Selection( <span class="hljs-literal">null</span>, {
				<span class="hljs-attr">multiple</span>: <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'multiple'</span>),
				<span class="hljs-attr">props</span>: props
			}) );
		}

		<span class="hljs-keyword">this</span>.resetDisplays();
	},

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	activate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.syncSelection();

		wp.Uploader.queue.on( <span class="hljs-string">'add'</span>, <span class="hljs-keyword">this</span>.uploading, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>).on( <span class="hljs-string">'add remove reset'</span>, <span class="hljs-keyword">this</span>.refreshContent, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'router'</span> ) &amp;&amp; <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'contentUserSetting'</span>) ) {
			<span class="hljs-keyword">this</span>.frame.on( <span class="hljs-string">'content:activate'</span>, <span class="hljs-keyword">this</span>.saveContentMode, <span class="hljs-keyword">this</span> );
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'content'</span>, getUserSetting( <span class="hljs-string">'libraryContent'</span>, <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'content'</span>) ) );
		}
	},

	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	deactivate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.recordSelection();

		<span class="hljs-keyword">this</span>.frame.off( <span class="hljs-string">'content:activate'</span>, <span class="hljs-keyword">this</span>.saveContentMode, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Unbind all event handlers that use this state as the context
from the selection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>).off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );

		wp.Uploader.queue.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-comment">/**
	 * Reset the library to its initial state.
	 *
	 * @since 3.5.0
	 */</span>
	reset: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>).reset();
		<span class="hljs-keyword">this</span>.resetDisplays();
		<span class="hljs-keyword">this</span>.refreshContent();
	},

	<span class="hljs-comment">/**
	 * Reset the attachment display settings defaults to the site options.
	 *
	 * If site options don't define them, fall back to a persistent user setting.
	 *
	 * @since 3.5.0
	 */</span>
	resetDisplays: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> defaultProps = wp.media.view.settings.defaultProps;
		<span class="hljs-keyword">this</span>._displays = [];
		<span class="hljs-keyword">this</span>._defaultDisplaySettings = {
			<span class="hljs-attr">align</span>: getUserSetting( <span class="hljs-string">'align'</span>, defaultProps.align ) || <span class="hljs-string">'none'</span>,
			<span class="hljs-attr">size</span>:  getUserSetting( <span class="hljs-string">'imgsize'</span>, defaultProps.size ) || <span class="hljs-string">'medium'</span>,
			<span class="hljs-attr">link</span>:  getUserSetting( <span class="hljs-string">'urlbutton'</span>, defaultProps.link ) || <span class="hljs-string">'none'</span>
		};
	},

	<span class="hljs-comment">/**
	 * Create a model to represent display settings (alignment, etc.) for an attachment.
	 *
	 * @since 3.5.0
	 *
	 * @param {wp.media.model.Attachment} attachment
	 * @returns {Backbone.Model}
	 */</span>
	display: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
		<span class="hljs-keyword">var</span> displays = <span class="hljs-keyword">this</span>._displays;

		<span class="hljs-keyword">if</span> ( ! displays[ attachment.cid ] ) {
			displays[ attachment.cid ] = <span class="hljs-keyword">new</span> Backbone.Model( <span class="hljs-keyword">this</span>.defaultDisplaySettings( attachment ) );
		}
		<span class="hljs-keyword">return</span> displays[ attachment.cid ];
	},

	<span class="hljs-comment">/**
	 * Given an attachment, create attachment display settings properties.
	 *
	 * @since 3.6.0
	 *
	 * @param {wp.media.model.Attachment} attachment
	 * @returns {Object}
	 */</span>
	defaultDisplaySettings: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
		<span class="hljs-keyword">var</span> settings = _.clone( <span class="hljs-keyword">this</span>._defaultDisplaySettings );

		<span class="hljs-keyword">if</span> ( settings.canEmbed = <span class="hljs-keyword">this</span>.canEmbed( attachment ) ) {
			settings.link = <span class="hljs-string">'embed'</span>;
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.isImageAttachment( attachment ) &amp;&amp; settings.link === <span class="hljs-string">'none'</span> ) {
			settings.link = <span class="hljs-string">'file'</span>;
		}

		<span class="hljs-keyword">return</span> settings;
	},

	<span class="hljs-comment">/**
	 * Whether an attachment is image.
	 *
	 * @since 4.4.1
	 *
	 * @param {wp.media.model.Attachment} attachment
	 * @returns {Boolean}
	 */</span>
	isImageAttachment: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>If uploading, we know the filename but not the mime type.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( attachment.get(<span class="hljs-string">'uploading'</span>) ) {
			<span class="hljs-keyword">return</span> <span class="hljs-regexp">/\.(jpe?g|png|gif)$/i</span>.test( attachment.get(<span class="hljs-string">'filename'</span>) );
		}

		<span class="hljs-keyword">return</span> attachment.get(<span class="hljs-string">'type'</span>) === <span class="hljs-string">'image'</span>;
	},

	<span class="hljs-comment">/**
	 * Whether an attachment can be embedded (audio or video).
	 *
	 * @since 3.6.0
	 *
	 * @param {wp.media.model.Attachment} attachment
	 * @returns {Boolean}
	 */</span>
	canEmbed: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>If uploading, we know the filename but not the mime type.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! attachment.get(<span class="hljs-string">'uploading'</span>) ) {
			<span class="hljs-keyword">var</span> type = attachment.get(<span class="hljs-string">'type'</span>);
			<span class="hljs-keyword">if</span> ( type !== <span class="hljs-string">'audio'</span> &amp;&amp; type !== <span class="hljs-string">'video'</span> ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
		}

		<span class="hljs-keyword">return</span> _.contains( wp.media.view.settings.embedExts, attachment.get(<span class="hljs-string">'filename'</span>).split(<span class="hljs-string">'.'</span>).pop() );
	},


	<span class="hljs-comment">/**
	 * If the state is active, no items are selected, and the current
	 * content mode is not an option in the state's router (provided
	 * the state has a router), reset the content mode to the default.
	 *
	 * @since 3.5.0
	 */</span>
	refreshContent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>),
			frame = <span class="hljs-keyword">this</span>.frame,
			router = frame.router.get(),
			mode = frame.content.mode();

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.active &amp;&amp; ! selection.length &amp;&amp; router &amp;&amp; ! router.get( mode ) ) {
			<span class="hljs-keyword">this</span>.frame.content.render( <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'content'</span>) );
		}
	},

	<span class="hljs-comment">/**
	 * Callback handler when an attachment is uploaded.
	 *
	 * Switch to the Media Library if uploaded from the 'Upload Files' tab.
	 *
	 * Adds any uploading attachments to the selection.
	 *
	 * If the state only supports one attachment to be selected and multiple
	 * attachments are uploaded, the last attachment in the upload queue will
	 * be selected.
	 *
	 * @since 3.5.0
	 *
	 * @param {wp.media.model.Attachment} attachment
	 */</span>
	uploading: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
		<span class="hljs-keyword">var</span> content = <span class="hljs-keyword">this</span>.frame.content;

		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'upload'</span> === content.mode() ) {
			<span class="hljs-keyword">this</span>.frame.content.mode(<span class="hljs-string">'browse'</span>);
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'autoSelect'</span> ) ) {
			<span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>).add( attachment );
			<span class="hljs-keyword">this</span>.frame.trigger( <span class="hljs-string">'library:selection:add'</span> );
		}
	},

	<span class="hljs-comment">/**
	 * Persist the mode of the content region as a user setting.
	 *
	 * @since 3.5.0
	 */</span>
	saveContentMode: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'browse'</span> !== <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'router'</span>) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">var</span> mode = <span class="hljs-keyword">this</span>.frame.content.mode(),
			view = <span class="hljs-keyword">this</span>.frame.router.get();

		<span class="hljs-keyword">if</span> ( view &amp;&amp; view.get( mode ) ) {
			setUserSetting( <span class="hljs-string">'libraryContent'</span>, mode );
		}
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Make selectionSync available on any Media Library state.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>_.extend( Library.prototype, wp.media.selectionSync );

<span class="hljs-built_in">module</span>.exports = Library;

},{}],<span class="hljs-number">12</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.MediaLibrary
 *
 * @class
 * @augments wp.media.controller.Library
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 */</span>
<span class="hljs-keyword">var</span> Library = wp.media.controller.Library,
	MediaLibrary;

MediaLibrary = Library.extend({
	<span class="hljs-attr">defaults</span>: _.defaults({</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Attachments browser defaults. @see media.view.AttachmentsBrowser</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		filterable:      <span class="hljs-string">'uploaded'</span>,

		<span class="hljs-attr">displaySettings</span>: <span class="hljs-literal">false</span>,
		<span class="hljs-attr">priority</span>:        <span class="hljs-number">80</span>,
		<span class="hljs-attr">syncSelection</span>:   <span class="hljs-literal">false</span>
	}, Library.prototype.defaults ),

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 *
	 * @param options
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">this</span>.media = options.media;
		<span class="hljs-keyword">this</span>.type = options.type;
		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'library'</span>, wp.media.query({ <span class="hljs-attr">type</span>: <span class="hljs-keyword">this</span>.type }) );

		Library.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	activate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>@todo this should use this.frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( wp.media.frame.lastMime ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'library'</span>, wp.media.query({ <span class="hljs-attr">type</span>: wp.media.frame.lastMime }) );
			<span class="hljs-keyword">delete</span> wp.media.frame.lastMime;
		}
		Library.prototype.activate.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	}
});

<span class="hljs-built_in">module</span>.exports = MediaLibrary;

},{}],<span class="hljs-number">13</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.Region
 *
 * A region is a persistent application layout area.
 *
 * A region assumes one mode at any time, and can be switched to another.
 *
 * When mode changes, events are triggered on the region's parent view.
 * The parent view will listen to specific events and fill the region with an
 * appropriate view depending on mode. For example, a frame listens for the
 * 'browse' mode t be activated on the 'content' view and then fills the region
 * with an AttachmentsBrowser view.
 *
 * @class
 *
 * @param {object}        options          Options hash for the region.
 * @param {string}        options.id       Unique identifier for the region.
 * @param {Backbone.View} options.view     A parent view the region exists within.
 * @param {string}        options.selector jQuery selector for the region within the parent view.
 */</span>
<span class="hljs-keyword">var</span> Region = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
	_.extend( <span class="hljs-keyword">this</span>, _.pick( options || {}, <span class="hljs-string">'id'</span>, <span class="hljs-string">'view'</span>, <span class="hljs-string">'selector'</span> ) );
};</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Use Backbone’s self-propagating <code>extend</code> inheritance method.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Region.extend = Backbone.Model.extend;

_.extend( Region.prototype, {
	<span class="hljs-comment">/**
	 * Activate a mode.
	 *
	 * @since 3.5.0
	 *
	 * @param {string} mode
	 *
	 * @fires this.view#{this.id}:activate:{this._mode}
	 * @fires this.view#{this.id}:activate
	 * @fires this.view#{this.id}:deactivate:{this._mode}
	 * @fires this.view#{this.id}:deactivate
	 *
	 * @returns {wp.media.controller.Region} Returns itself to allow chaining.
	 */</span>
	mode: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> mode </span>) </span>{
		<span class="hljs-keyword">if</span> ( ! mode ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._mode;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Bail if we’re trying to change to the current mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( mode === <span class="hljs-keyword">this</span>._mode ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}

		<span class="hljs-comment">/**
		 * Region mode deactivation event.
		 *
		 * @event this.view#{this.id}:deactivate:{this._mode}
		 * @event this.view#{this.id}:deactivate
		 */</span>
		<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'deactivate'</span>);

		<span class="hljs-keyword">this</span>._mode = mode;
		<span class="hljs-keyword">this</span>.render( mode );

		<span class="hljs-comment">/**
		 * Region mode activation event.
		 *
		 * @event this.view#{this.id}:activate:{this._mode}
		 * @event this.view#{this.id}:activate
		 */</span>
		<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'activate'</span>);
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * Render a mode.
	 *
	 * @since 3.5.0
	 *
	 * @param {string} mode
	 *
	 * @fires this.view#{this.id}:create:{this._mode}
	 * @fires this.view#{this.id}:create
	 * @fires this.view#{this.id}:render:{this._mode}
	 * @fires this.view#{this.id}:render
	 *
	 * @returns {wp.media.controller.Region} Returns itself to allow chaining
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> mode </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>If the mode isn’t active, activate it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( mode &amp;&amp; mode !== <span class="hljs-keyword">this</span>._mode ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.mode( mode );
		}

		<span class="hljs-keyword">var</span> set = { <span class="hljs-attr">view</span>: <span class="hljs-literal">null</span> },
			view;

		<span class="hljs-comment">/**
		 * Create region view event.
		 *
		 * Region view creation takes place in an event callback on the frame.
		 *
		 * @event this.view#{this.id}:create:{this._mode}
		 * @event this.view#{this.id}:create
		 */</span>
		<span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'create'</span>, set );
		view = set.view;

		<span class="hljs-comment">/**
		 * Render region view event.
		 *
		 * Region view creation takes place in an event callback on the frame.
		 *
		 * @event this.view#{this.id}:create:{this._mode}
		 * @event this.view#{this.id}:create
		 */</span>
		<span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'render'</span>, view );
		<span class="hljs-keyword">if</span> ( view ) {
			<span class="hljs-keyword">this</span>.set( view );
		}
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-comment">/**
	 * Get the region's view.
	 *
	 * @since 3.5.0
	 *
	 * @returns {wp.media.View}
	 */</span>
	get: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view.views.first( <span class="hljs-keyword">this</span>.selector );
	},

	<span class="hljs-comment">/**
	 * Set the region's view as a subview of the frame.
	 *
	 * @since 3.5.0
	 *
	 * @param {Array|Object} views
	 * @param {Object} [options={}]
	 * @returns {wp.Backbone.Subviews} Subviews is returned to allow chaining
	 */</span>
	set: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> views, options </span>) </span>{
		<span class="hljs-keyword">if</span> ( options ) {
			options.add = <span class="hljs-literal">false</span>;
		}
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view.views.set( <span class="hljs-keyword">this</span>.selector, views, options );
	},

	<span class="hljs-comment">/**
	 * Trigger regional view events on the frame.
	 *
	 * @since 3.5.0
	 *
	 * @param {string} event
	 * @returns {undefined|wp.media.controller.Region} Returns itself to allow chaining.
	 */</span>
	trigger: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> base, args;

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>._mode ) {
			<span class="hljs-keyword">return</span>;
		}

		args = _.toArray( <span class="hljs-built_in">arguments</span> );
		base = <span class="hljs-keyword">this</span>.id + <span class="hljs-string">':'</span> + event;</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Trigger <code>{this.id}:{event}:{this._mode}</code> event on the frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		args[<span class="hljs-number">0</span>] = base + <span class="hljs-string">':'</span> + <span class="hljs-keyword">this</span>._mode;
		<span class="hljs-keyword">this</span>.view.trigger.apply( <span class="hljs-keyword">this</span>.view, args );</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Trigger <code>{this.id}:{event}</code> event on the frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		args[<span class="hljs-number">0</span>] = base;
		<span class="hljs-keyword">this</span>.view.trigger.apply( <span class="hljs-keyword">this</span>.view, args );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	}
});

<span class="hljs-built_in">module</span>.exports = Region;

},{}],<span class="hljs-number">14</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.ReplaceImage
 *
 * A state for replacing an image.
 *
 * @class
 * @augments wp.media.controller.Library
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 *
 * @param {object}                     [attributes]                         The attributes hash passed to the state.
 * @param {string}                     [attributes.id=replace-image]        Unique identifier.
 * @param {string}                     [attributes.title=Replace Image]     Title for the state. Displays in the media menu and the frame's title region.
 * @param {wp.media.model.Attachments} [attributes.library]                 The attachments collection to browse.
 *                                                                          If one is not supplied, a collection of all images will be created.
 * @param {boolean}                    [attributes.multiple=false]          Whether multi-select is enabled.
 * @param {string}                     [attributes.content=upload]          Initial mode for the content region.
 *                                                                          Overridden by persistent user setting if 'contentUserSetting' is true.
 * @param {string}                     [attributes.menu=default]            Initial mode for the menu region.
 * @param {string}                     [attributes.router=browse]           Initial mode for the router region.
 * @param {string}                     [attributes.toolbar=replace]         Initial mode for the toolbar region.
 * @param {int}                        [attributes.priority=60]             The priority for the state link in the media menu.
 * @param {boolean}                    [attributes.searchable=true]         Whether the library is searchable.
 * @param {boolean|string}             [attributes.filterable=uploaded]     Whether the library is filterable, and if so what filters should be shown.
 *                                                                          Accepts 'all', 'uploaded', or 'unattached'.
 * @param {boolean}                    [attributes.sortable=true]           Whether the Attachments should be sortable. Depends on the orderby property being set to menuOrder on the attachments collection.
 * @param {boolean}                    [attributes.autoSelect=true]         Whether an uploaded attachment should be automatically added to the selection.
 * @param {boolean}                    [attributes.describe=false]          Whether to offer UI to describe attachments - e.g. captioning images in a gallery.
 * @param {boolean}                    [attributes.contentUserSetting=true] Whether the content region's mode should be set and persisted per user.
 * @param {boolean}                    [attributes.syncSelection=true]      Whether the Attachments selection should be persisted from the last state.
 */</span>
<span class="hljs-keyword">var</span> Library = wp.media.controller.Library,
	l10n = wp.media.view.l10n,
	ReplaceImage;

ReplaceImage = Library.extend({
	<span class="hljs-attr">defaults</span>: _.defaults({
		<span class="hljs-attr">id</span>:            <span class="hljs-string">'replace-image'</span>,
		<span class="hljs-attr">title</span>:         l10n.replaceImageTitle,
		<span class="hljs-attr">multiple</span>:      <span class="hljs-literal">false</span>,
		<span class="hljs-attr">filterable</span>:    <span class="hljs-string">'uploaded'</span>,
		<span class="hljs-attr">toolbar</span>:       <span class="hljs-string">'replace'</span>,
		<span class="hljs-attr">menu</span>:          <span class="hljs-literal">false</span>,
		<span class="hljs-attr">priority</span>:      <span class="hljs-number">60</span>,
		<span class="hljs-attr">syncSelection</span>: <span class="hljs-literal">true</span>
	}, Library.prototype.defaults ),

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 *
	 * @param options
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">var</span> library, comparator;

		<span class="hljs-keyword">this</span>.image = options.image;</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>If we haven’t been provided a <code>library</code>, create a <code>Selection</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>) ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'library'</span>, wp.media.query({ <span class="hljs-attr">type</span>: <span class="hljs-string">'image'</span> }) );
		}

		Library.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );

		library    = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'library'</span>);
		comparator = library.comparator;</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Overload the library’s comparator to push items that are not in
the mirrored query to the front of the aggregate collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		library.comparator = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> a, b </span>) </span>{
			<span class="hljs-keyword">var</span> aInQuery = !! <span class="hljs-keyword">this</span>.mirroring.get( a.cid ),
				bInQuery = !! <span class="hljs-keyword">this</span>.mirroring.get( b.cid );

			<span class="hljs-keyword">if</span> ( ! aInQuery &amp;&amp; bInQuery ) {
				<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( aInQuery &amp;&amp; ! bInQuery ) {
				<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span> comparator.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
			}
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Add all items in the selection to the library, so any featured
images that are not initially loaded still appear.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		library.observe( <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>) );
	},

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	activate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.updateSelection();
		Library.prototype.activate.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-comment">/**
	 * @since 3.9.0
	 */</span>
	updateSelection: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>),
			attachment = <span class="hljs-keyword">this</span>.image.attachment;

		selection.reset( attachment ? [ attachment ] : [] );
	}
});

<span class="hljs-built_in">module</span>.exports = ReplaceImage;

},{}],<span class="hljs-number">15</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.SiteIconCropper
 *
 * A state for cropping a Site Icon.
 *
 * @class
 * @augments wp.media.controller.Cropper
 * @augments wp.media.controller.State
 * @augments Backbone.Model
 */</span>
<span class="hljs-keyword">var</span> Controller = wp.media.controller,
	SiteIconCropper;

SiteIconCropper = Controller.Cropper.extend({
	<span class="hljs-attr">activate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.frame.on( <span class="hljs-string">'content:create:crop'</span>, <span class="hljs-keyword">this</span>.createCropContent, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.frame.on( <span class="hljs-string">'close'</span>, <span class="hljs-keyword">this</span>.removeCropper, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.set(<span class="hljs-string">'selection'</span>, <span class="hljs-keyword">new</span> Backbone.Collection(<span class="hljs-keyword">this</span>.frame._selection.single));
	},

	<span class="hljs-attr">createCropContent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.cropperView = <span class="hljs-keyword">new</span> wp.media.view.SiteIconCropper({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">attachment</span>: <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>).first()
		});
		<span class="hljs-keyword">this</span>.cropperView.on(<span class="hljs-string">'image-loaded'</span>, <span class="hljs-keyword">this</span>.createCropToolbar, <span class="hljs-keyword">this</span>);
		<span class="hljs-keyword">this</span>.frame.content.set(<span class="hljs-keyword">this</span>.cropperView);

	},

	<span class="hljs-attr">doCrop</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
		<span class="hljs-keyword">var</span> cropDetails = attachment.get( <span class="hljs-string">'cropDetails'</span> ),
			control = <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'control'</span> );

		cropDetails.dst_width  = control.params.width;
		cropDetails.dst_height = control.params.height;

		<span class="hljs-keyword">return</span> wp.ajax.post( <span class="hljs-string">'crop-image'</span>, {
			<span class="hljs-attr">nonce</span>: attachment.get( <span class="hljs-string">'nonces'</span> ).edit,
			<span class="hljs-attr">id</span>: attachment.get( <span class="hljs-string">'id'</span> ),
			<span class="hljs-attr">context</span>: <span class="hljs-string">'site-icon'</span>,
			<span class="hljs-attr">cropDetails</span>: cropDetails
		} );
	}
});

<span class="hljs-built_in">module</span>.exports = SiteIconCropper;

},{}],<span class="hljs-number">16</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.StateMachine
 *
 * A state machine keeps track of state. It is in one state at a time,
 * and can change from one state to another.
 *
 * States are stored as models in a Backbone collection.
 *
 * @since 3.5.0
 *
 * @class
 * @augments Backbone.Model
 * @mixin
 * @mixes Backbone.Events
 *
 * @param {Array} states
 */</span>
<span class="hljs-keyword">var</span> StateMachine = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> states </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>@todo This is dead code. The states collection gets created in media.view.Frame._createStates.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">this</span>.states = <span class="hljs-keyword">new</span> Backbone.Collection( states );
};</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Use Backbone’s self-propagating <code>extend</code> inheritance method.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>StateMachine.extend = Backbone.Model.extend;

_.extend( StateMachine.prototype, Backbone.Events, {
	<span class="hljs-comment">/**
	 * Fetch a state.
	 *
	 * If no `id` is provided, returns the active state.
	 *
	 * Implicitly creates states.
	 *
	 * Ensure that the `states` collection exists so the `StateMachine`
	 *   can be used as a mixin.
	 *
	 * @since 3.5.0
	 *
	 * @param {string} id
	 * @returns {wp.media.controller.State} Returns a State model
	 *   from the StateMachine collection
	 */</span>
	state: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
		<span class="hljs-keyword">this</span>.states = <span class="hljs-keyword">this</span>.states || <span class="hljs-keyword">new</span> Backbone.Collection();</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Default to the active state.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		id = id || <span class="hljs-keyword">this</span>._state;

		<span class="hljs-keyword">if</span> ( id &amp;&amp; ! <span class="hljs-keyword">this</span>.states.get( id ) ) {
			<span class="hljs-keyword">this</span>.states.add({ <span class="hljs-attr">id</span>: id });
		}
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.states.get( id );
	},

	<span class="hljs-comment">/**
	 * Sets the active state.
	 *
	 * Bail if we're trying to select the current state, if we haven't
	 * created the `states` collection, or are trying to select a state
	 * that does not exist.
	 *
	 * @since 3.5.0
	 *
	 * @param {string} id
	 *
	 * @fires wp.media.controller.State#deactivate
	 * @fires wp.media.controller.State#activate
	 *
	 * @returns {wp.media.controller.StateMachine} Returns itself to allow chaining
	 */</span>
	setState: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
		<span class="hljs-keyword">var</span> previous = <span class="hljs-keyword">this</span>.state();

		<span class="hljs-keyword">if</span> ( ( previous &amp;&amp; id === previous.id ) || ! <span class="hljs-keyword">this</span>.states || ! <span class="hljs-keyword">this</span>.states.get( id ) ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}

		<span class="hljs-keyword">if</span> ( previous ) {
			previous.trigger(<span class="hljs-string">'deactivate'</span>);
			<span class="hljs-keyword">this</span>._lastState = previous.id;
		}

		<span class="hljs-keyword">this</span>._state = id;
		<span class="hljs-keyword">this</span>.state().trigger(<span class="hljs-string">'activate'</span>);

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-comment">/**
	 * Returns the previous active state.
	 *
	 * Call the `state()` method with no parameters to retrieve the current
	 * active state.
	 *
	 * @since 3.5.0
	 *
	 * @returns {wp.media.controller.State} Returns a State model
	 *    from the StateMachine collection
	 */</span>
	lastState: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._lastState ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.state( <span class="hljs-keyword">this</span>._lastState );
		}
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Map all event binding and triggering on a StateMachine to its <code>states</code> collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>_.each([ <span class="hljs-string">'on'</span>, <span class="hljs-string">'off'</span>, <span class="hljs-string">'trigger'</span> ], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> method </span>) </span>{
	<span class="hljs-comment">/**
	 * @returns {wp.media.controller.StateMachine} Returns itself to allow chaining.
	 */</span>
	StateMachine.prototype[ method ] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Ensure that the <code>states</code> collection exists so the <code>StateMachine</code>
can be used as a mixin.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.states = <span class="hljs-keyword">this</span>.states || <span class="hljs-keyword">new</span> Backbone.Collection();</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>Forward the method to the <code>states</code> collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.states[ method ].apply( <span class="hljs-keyword">this</span>.states, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	};
});

<span class="hljs-built_in">module</span>.exports = StateMachine;

},{}],<span class="hljs-number">17</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.controller.State
 *
 * A state is a step in a workflow that when set will trigger the controllers
 * for the regions to be updated as specified in the frame.
 *
 * A state has an event-driven lifecycle:
 *
 *     'ready'      triggers when a state is added to a state machine's collection.
 *     'activate'   triggers when a state is activated by a state machine.
 *     'deactivate' triggers when a state is deactivated by a state machine.
 *     'reset'      is not triggered automatically. It should be invoked by the
 *                  proper controller to reset the state to its default.
 *
 * @class
 * @augments Backbone.Model
 */</span>
<span class="hljs-keyword">var</span> State = Backbone.Model.extend({
	<span class="hljs-comment">/**
	 * Constructor.
	 *
	 * @since 3.5.0
	 */</span>
	<span class="hljs-keyword">constructor</span>: function() {
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'activate'</span>, <span class="hljs-keyword">this</span>._preActivate, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'activate'</span>, <span class="hljs-keyword">this</span>.activate, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'activate'</span>, <span class="hljs-keyword">this</span>._postActivate, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'deactivate'</span>, <span class="hljs-keyword">this</span>._deactivate, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'deactivate'</span>, <span class="hljs-keyword">this</span>.deactivate, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'reset'</span>, <span class="hljs-keyword">this</span>.reset, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'ready'</span>, <span class="hljs-keyword">this</span>._ready, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'ready'</span>, <span class="hljs-keyword">this</span>.ready, <span class="hljs-keyword">this</span> );
		<span class="hljs-comment">/**
		 * Call parent constructor with passed arguments
		 */</span>
		Backbone.Model.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'change:menu'</span>, <span class="hljs-keyword">this</span>._updateMenu, <span class="hljs-keyword">this</span> );
	},
	<span class="hljs-comment">/**
	 * Ready event callback.
	 *
	 * @abstract
	 * @since 3.5.0
	 */</span>
	ready: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},

	<span class="hljs-comment">/**
	 * Activate event callback.
	 *
	 * @abstract
	 * @since 3.5.0
	 */</span>
	activate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},

	<span class="hljs-comment">/**
	 * Deactivate event callback.
	 *
	 * @abstract
	 * @since 3.5.0
	 */</span>
	deactivate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},

	<span class="hljs-comment">/**
	 * Reset event callback.
	 *
	 * @abstract
	 * @since 3.5.0
	 */</span>
	reset: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},

	<span class="hljs-comment">/**
	 * @access private
	 * @since 3.5.0
	 */</span>
	_ready: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>._updateMenu();
	},

	<span class="hljs-comment">/**
	 * @access private
	 * @since 3.5.0
	*/</span>
	_preActivate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.active = <span class="hljs-literal">true</span>;
	},

	<span class="hljs-comment">/**
	 * @access private
	 * @since 3.5.0
	 */</span>
	_postActivate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'change:menu'</span>, <span class="hljs-keyword">this</span>._menu, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'change:titleMode'</span>, <span class="hljs-keyword">this</span>._title, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'change:content'</span>, <span class="hljs-keyword">this</span>._content, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'change:toolbar'</span>, <span class="hljs-keyword">this</span>._toolbar, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.frame.on( <span class="hljs-string">'title:render:default'</span>, <span class="hljs-keyword">this</span>._renderTitle, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>._title();
		<span class="hljs-keyword">this</span>._menu();
		<span class="hljs-keyword">this</span>._toolbar();
		<span class="hljs-keyword">this</span>._content();
		<span class="hljs-keyword">this</span>._router();
	},

	<span class="hljs-comment">/**
	 * @access private
	 * @since 3.5.0
	 */</span>
	_deactivate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.active = <span class="hljs-literal">false</span>;

		<span class="hljs-keyword">this</span>.frame.off( <span class="hljs-string">'title:render:default'</span>, <span class="hljs-keyword">this</span>._renderTitle, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.off( <span class="hljs-string">'change:menu'</span>, <span class="hljs-keyword">this</span>._menu, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.off( <span class="hljs-string">'change:titleMode'</span>, <span class="hljs-keyword">this</span>._title, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.off( <span class="hljs-string">'change:content'</span>, <span class="hljs-keyword">this</span>._content, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.off( <span class="hljs-string">'change:toolbar'</span>, <span class="hljs-keyword">this</span>._toolbar, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-comment">/**
	 * @access private
	 * @since 3.5.0
	 */</span>
	_title: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.frame.title.render( <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'titleMode'</span>) || <span class="hljs-string">'default'</span> );
	},

	<span class="hljs-comment">/**
	 * @access private
	 * @since 3.5.0
	 */</span>
	_renderTitle: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		view.$el.text( <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'title'</span>) || <span class="hljs-string">''</span> );
	},

	<span class="hljs-comment">/**
	 * @access private
	 * @since 3.5.0
	 */</span>
	_router: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> router = <span class="hljs-keyword">this</span>.frame.router,
			mode = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'router'</span>),
			view;

		<span class="hljs-keyword">this</span>.frame.$el.toggleClass( <span class="hljs-string">'hide-router'</span>, ! mode );
		<span class="hljs-keyword">if</span> ( ! mode ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.frame.router.render( mode );

		view = router.get();
		<span class="hljs-keyword">if</span> ( view &amp;&amp; view.select ) {
			view.select( <span class="hljs-keyword">this</span>.frame.content.mode() );
		}
	},

	<span class="hljs-comment">/**
	 * @access private
	 * @since 3.5.0
	 */</span>
	_menu: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> menu = <span class="hljs-keyword">this</span>.frame.menu,
			mode = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'menu'</span>),
			view;

		<span class="hljs-keyword">this</span>.frame.$el.toggleClass( <span class="hljs-string">'hide-menu'</span>, ! mode );
		<span class="hljs-keyword">if</span> ( ! mode ) {
			<span class="hljs-keyword">return</span>;
		}

		menu.mode( mode );

		view = menu.get();
		<span class="hljs-keyword">if</span> ( view &amp;&amp; view.select ) {
			view.select( <span class="hljs-keyword">this</span>.id );
		}
	},

	<span class="hljs-comment">/**
	 * @access private
	 * @since 3.5.0
	 */</span>
	_updateMenu: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> previous = <span class="hljs-keyword">this</span>.previous(<span class="hljs-string">'menu'</span>),
			menu = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'menu'</span>);

		<span class="hljs-keyword">if</span> ( previous ) {
			<span class="hljs-keyword">this</span>.frame.off( <span class="hljs-string">'menu:render:'</span> + previous, <span class="hljs-keyword">this</span>._renderMenu, <span class="hljs-keyword">this</span> );
		}

		<span class="hljs-keyword">if</span> ( menu ) {
			<span class="hljs-keyword">this</span>.frame.on( <span class="hljs-string">'menu:render:'</span> + menu, <span class="hljs-keyword">this</span>._renderMenu, <span class="hljs-keyword">this</span> );
		}
	},

	<span class="hljs-comment">/**
	 * Create a view in the media menu for the state.
	 *
	 * @access private
	 * @since 3.5.0
	 *
	 * @param {media.view.Menu} view The menu view.
	 */</span>
	_renderMenu: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		<span class="hljs-keyword">var</span> menuItem = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'menuItem'</span>),
			title = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'title'</span>),
			priority = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'priority'</span>);

		<span class="hljs-keyword">if</span> ( ! menuItem &amp;&amp; title ) {
			menuItem = { <span class="hljs-attr">text</span>: title };

			<span class="hljs-keyword">if</span> ( priority ) {
				menuItem.priority = priority;
			}
		}

		<span class="hljs-keyword">if</span> ( ! menuItem ) {
			<span class="hljs-keyword">return</span>;
		}

		view.set( <span class="hljs-keyword">this</span>.id, menuItem );
	}
});

_.each([<span class="hljs-string">'toolbar'</span>,<span class="hljs-string">'content'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> region </span>) </span>{
	<span class="hljs-comment">/**
	 * @access private
	 */</span>
	State.prototype[ <span class="hljs-string">'_'</span> + region ] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> mode = <span class="hljs-keyword">this</span>.get( region );
		<span class="hljs-keyword">if</span> ( mode ) {
			<span class="hljs-keyword">this</span>.frame[ region ].render( mode );
		}
	};
});

<span class="hljs-built_in">module</span>.exports = State;

},{}],<span class="hljs-number">18</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.selectionSync
 *
 * Sync an attachments selection in a state with another state.
 *
 * Allows for selecting multiple images in the Insert Media workflow, and then
 * switching to the Insert Gallery workflow while preserving the attachments selection.
 *
 * @mixin
 */</span>
<span class="hljs-keyword">var</span> selectionSync = {
	<span class="hljs-comment">/**
	 * @since 3.5.0
	 */</span>
	syncSelection: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>),
			manager = <span class="hljs-keyword">this</span>.frame._selection;

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'syncSelection'</span>) || ! manager || ! selection ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>If the selection supports multiple items, validate the stored
attachments based on the new selection’s conditions. Record
the attachments that are not included; we’ll maintain a
reference to those. Other attachments are considered in flux.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( selection.multiple ) {
			selection.reset( [], { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> });
			selection.validateAll( manager.attachments );
			manager.difference = _.difference( manager.attachments.models, selection.models );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Sync the selection’s single item with the master.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		selection.single( manager.single );
	},

	<span class="hljs-comment">/**
	 * Record the currently active attachments, which is a combination
	 * of the selection's attachments and the set of selected
	 * attachments that this specific selection considered invalid.
	 * Reset the difference and record the single attachment.
	 *
	 * @since 3.5.0
	 */</span>
	recordSelection: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>),
			manager = <span class="hljs-keyword">this</span>.frame._selection;

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'syncSelection'</span>) || ! manager || ! selection ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( selection.multiple ) {
			manager.attachments.reset( selection.toArray().concat( manager.difference ) );
			manager.difference = [];
		} <span class="hljs-keyword">else</span> {
			manager.attachments.add( selection.toArray() );
		}

		manager.single = selection._single;
	}
};

<span class="hljs-built_in">module</span>.exports = selectionSync;

},{}],<span class="hljs-number">19</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-keyword">var</span> media = wp.media,
	$ = jQuery,
	l10n;

media.isTouchDevice = ( <span class="hljs-string">'ontouchend'</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">document</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Link any localized strings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>l10n = media.view.l10n = <span class="hljs-built_in">window</span>._wpMediaViewsL10n || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Link any settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>media.view.settings = l10n.settings || {};
<span class="hljs-keyword">delete</span> l10n.settings;</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Copy the <code>post</code> setting over to the model settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>media.model.settings.post = media.view.settings.post;</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>Check if the browser supports CSS 3.0 transitions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.support.transition = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
	<span class="hljs-keyword">var</span> style = <span class="hljs-built_in">document</span>.documentElement.style,
		transitions = {
			<span class="hljs-attr">WebkitTransition</span>: <span class="hljs-string">'webkitTransitionEnd'</span>,
			<span class="hljs-attr">MozTransition</span>:    <span class="hljs-string">'transitionend'</span>,
			<span class="hljs-attr">OTransition</span>:      <span class="hljs-string">'oTransitionEnd otransitionend'</span>,
			<span class="hljs-attr">transition</span>:       <span class="hljs-string">'transitionend'</span>
		}, transition;

	transition = _.find( _.keys( transitions ), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> transition </span>) </span>{
		<span class="hljs-keyword">return</span> ! _.isUndefined( style[ transition ] );
	});

	<span class="hljs-keyword">return</span> transition &amp;&amp; {
		<span class="hljs-attr">end</span>: transitions[ transition ]
	};
}());

<span class="hljs-comment">/**
 * A shared event bus used to provide events into
 * the media workflows that 3rd-party devs can use to hook
 * in.
 */</span>
media.events = _.extend( {}, Backbone.Events );

<span class="hljs-comment">/**
 * Makes it easier to bind events using transitions.
 *
 * @param {string} selector
 * @param {Number} sensitivity
 * @returns {Promise}
 */</span>
media.transition = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> selector, sensitivity </span>) </span>{
	<span class="hljs-keyword">var</span> deferred = $.Deferred();

	sensitivity = sensitivity || <span class="hljs-number">2000</span>;

	<span class="hljs-keyword">if</span> ( $.support.transition ) {
		<span class="hljs-keyword">if</span> ( ! (selector <span class="hljs-keyword">instanceof</span> $) ) {
			selector = $( selector );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Resolve the deferred when the first element finishes animating.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		selector.first().one( $.support.transition.end, deferred.resolve );</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>Just in case the event doesn’t trigger, fire a callback.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_.delay( deferred.resolve, sensitivity );</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>Otherwise, execute on the spot.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	} <span class="hljs-keyword">else</span> {
		deferred.resolve();
	}

	<span class="hljs-keyword">return</span> deferred.promise();
};

media.controller.Region = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/region.js'</span> );
media.controller.StateMachine = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/state-machine.js'</span> );
media.controller.State = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/state.js'</span> );

media.selectionSync = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./utils/selection-sync.js'</span> );
media.controller.Library = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/library.js'</span> );
media.controller.ImageDetails = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/image-details.js'</span> );
media.controller.GalleryEdit = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/gallery-edit.js'</span> );
media.controller.GalleryAdd = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/gallery-add.js'</span> );
media.controller.CollectionEdit = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/collection-edit.js'</span> );
media.controller.CollectionAdd = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/collection-add.js'</span> );
media.controller.FeaturedImage = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/featured-image.js'</span> );
media.controller.ReplaceImage = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/replace-image.js'</span> );
media.controller.EditImage = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/edit-image.js'</span> );
media.controller.MediaLibrary = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/media-library.js'</span> );
media.controller.Embed = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/embed.js'</span> );
media.controller.Cropper = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/cropper.js'</span> );
media.controller.CustomizeImageCropper = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/customize-image-cropper.js'</span> );
media.controller.SiteIconCropper = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./controllers/site-icon-cropper.js'</span> );

media.View = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/view.js'</span> );
media.view.Frame = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/frame.js'</span> );
media.view.MediaFrame = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/media-frame.js'</span> );
media.view.MediaFrame.Select = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/frame/select.js'</span> );
media.view.MediaFrame.Post = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/frame/post.js'</span> );
media.view.MediaFrame.ImageDetails = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/frame/image-details.js'</span> );
media.view.Modal = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/modal.js'</span> );
media.view.FocusManager = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/focus-manager.js'</span> );
media.view.UploaderWindow = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/uploader/window.js'</span> );
media.view.EditorUploader = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/uploader/editor.js'</span> );
media.view.UploaderInline = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/uploader/inline.js'</span> );
media.view.UploaderStatus = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/uploader/status.js'</span> );
media.view.UploaderStatusError = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/uploader/status-error.js'</span> );
media.view.Toolbar = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/toolbar.js'</span> );
media.view.Toolbar.Select = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/toolbar/select.js'</span> );
media.view.Toolbar.Embed = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/toolbar/embed.js'</span> );
media.view.Button = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/button.js'</span> );
media.view.ButtonGroup = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/button-group.js'</span> );
media.view.PriorityList = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/priority-list.js'</span> );
media.view.MenuItem = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/menu-item.js'</span> );
media.view.Menu = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/menu.js'</span> );
media.view.RouterItem = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/router-item.js'</span> );
media.view.Router = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/router.js'</span> );
media.view.Sidebar = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/sidebar.js'</span> );
media.view.Attachment = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachment.js'</span> );
media.view.Attachment.Library = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachment/library.js'</span> );
media.view.Attachment.EditLibrary = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachment/edit-library.js'</span> );
media.view.Attachments = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachments.js'</span> );
media.view.Search = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/search.js'</span> );
media.view.AttachmentFilters = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachment-filters.js'</span> );
media.view.DateFilter = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachment-filters/date.js'</span> );
media.view.AttachmentFilters.Uploaded = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachment-filters/uploaded.js'</span> );
media.view.AttachmentFilters.All = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachment-filters/all.js'</span> );
media.view.AttachmentsBrowser = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachments/browser.js'</span> );
media.view.Selection = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/selection.js'</span> );
media.view.Attachment.Selection = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachment/selection.js'</span> );
media.view.Attachments.Selection = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachments/selection.js'</span> );
media.view.Attachment.EditSelection = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachment/edit-selection.js'</span> );
media.view.Settings = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/settings.js'</span> );
media.view.Settings.AttachmentDisplay = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/settings/attachment-display.js'</span> );
media.view.Settings.Gallery = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/settings/gallery.js'</span> );
media.view.Settings.Playlist = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/settings/playlist.js'</span> );
media.view.Attachment.Details = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachment/details.js'</span> );
media.view.AttachmentCompat = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/attachment-compat.js'</span> );
media.view.Iframe = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/iframe.js'</span> );
media.view.Embed = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/embed.js'</span> );
media.view.Label = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/label.js'</span> );
media.view.EmbedUrl = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/embed/url.js'</span> );
media.view.EmbedLink = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/embed/link.js'</span> );
media.view.EmbedImage = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/embed/image.js'</span> );
media.view.ImageDetails = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/image-details.js'</span> );
media.view.Cropper = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/cropper.js'</span> );
media.view.SiteIconCropper = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/site-icon-cropper.js'</span> );
media.view.SiteIconPreview = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/site-icon-preview.js'</span> );
media.view.EditImage = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/edit-image.js'</span> );
media.view.Spinner = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./views/spinner.js'</span> );

},{<span class="hljs-string">"./controllers/collection-add.js"</span>:<span class="hljs-number">1</span>,<span class="hljs-string">"./controllers/collection-edit.js"</span>:<span class="hljs-number">2</span>,<span class="hljs-string">"./controllers/cropper.js"</span>:<span class="hljs-number">3</span>,<span class="hljs-string">"./controllers/customize-image-cropper.js"</span>:<span class="hljs-number">4</span>,<span class="hljs-string">"./controllers/edit-image.js"</span>:<span class="hljs-number">5</span>,<span class="hljs-string">"./controllers/embed.js"</span>:<span class="hljs-number">6</span>,<span class="hljs-string">"./controllers/featured-image.js"</span>:<span class="hljs-number">7</span>,<span class="hljs-string">"./controllers/gallery-add.js"</span>:<span class="hljs-number">8</span>,<span class="hljs-string">"./controllers/gallery-edit.js"</span>:<span class="hljs-number">9</span>,<span class="hljs-string">"./controllers/image-details.js"</span>:<span class="hljs-number">10</span>,<span class="hljs-string">"./controllers/library.js"</span>:<span class="hljs-number">11</span>,<span class="hljs-string">"./controllers/media-library.js"</span>:<span class="hljs-number">12</span>,<span class="hljs-string">"./controllers/region.js"</span>:<span class="hljs-number">13</span>,<span class="hljs-string">"./controllers/replace-image.js"</span>:<span class="hljs-number">14</span>,<span class="hljs-string">"./controllers/site-icon-cropper.js"</span>:<span class="hljs-number">15</span>,<span class="hljs-string">"./controllers/state-machine.js"</span>:<span class="hljs-number">16</span>,<span class="hljs-string">"./controllers/state.js"</span>:<span class="hljs-number">17</span>,<span class="hljs-string">"./utils/selection-sync.js"</span>:<span class="hljs-number">18</span>,<span class="hljs-string">"./views/attachment-compat.js"</span>:<span class="hljs-number">20</span>,<span class="hljs-string">"./views/attachment-filters.js"</span>:<span class="hljs-number">21</span>,<span class="hljs-string">"./views/attachment-filters/all.js"</span>:<span class="hljs-number">22</span>,<span class="hljs-string">"./views/attachment-filters/date.js"</span>:<span class="hljs-number">23</span>,<span class="hljs-string">"./views/attachment-filters/uploaded.js"</span>:<span class="hljs-number">24</span>,<span class="hljs-string">"./views/attachment.js"</span>:<span class="hljs-number">25</span>,<span class="hljs-string">"./views/attachment/details.js"</span>:<span class="hljs-number">26</span>,<span class="hljs-string">"./views/attachment/edit-library.js"</span>:<span class="hljs-number">27</span>,<span class="hljs-string">"./views/attachment/edit-selection.js"</span>:<span class="hljs-number">28</span>,<span class="hljs-string">"./views/attachment/library.js"</span>:<span class="hljs-number">29</span>,<span class="hljs-string">"./views/attachment/selection.js"</span>:<span class="hljs-number">30</span>,<span class="hljs-string">"./views/attachments.js"</span>:<span class="hljs-number">31</span>,<span class="hljs-string">"./views/attachments/browser.js"</span>:<span class="hljs-number">32</span>,<span class="hljs-string">"./views/attachments/selection.js"</span>:<span class="hljs-number">33</span>,<span class="hljs-string">"./views/button-group.js"</span>:<span class="hljs-number">34</span>,<span class="hljs-string">"./views/button.js"</span>:<span class="hljs-number">35</span>,<span class="hljs-string">"./views/cropper.js"</span>:<span class="hljs-number">36</span>,<span class="hljs-string">"./views/edit-image.js"</span>:<span class="hljs-number">37</span>,<span class="hljs-string">"./views/embed.js"</span>:<span class="hljs-number">38</span>,<span class="hljs-string">"./views/embed/image.js"</span>:<span class="hljs-number">39</span>,<span class="hljs-string">"./views/embed/link.js"</span>:<span class="hljs-number">40</span>,<span class="hljs-string">"./views/embed/url.js"</span>:<span class="hljs-number">41</span>,<span class="hljs-string">"./views/focus-manager.js"</span>:<span class="hljs-number">42</span>,<span class="hljs-string">"./views/frame.js"</span>:<span class="hljs-number">43</span>,<span class="hljs-string">"./views/frame/image-details.js"</span>:<span class="hljs-number">44</span>,<span class="hljs-string">"./views/frame/post.js"</span>:<span class="hljs-number">45</span>,<span class="hljs-string">"./views/frame/select.js"</span>:<span class="hljs-number">46</span>,<span class="hljs-string">"./views/iframe.js"</span>:<span class="hljs-number">47</span>,<span class="hljs-string">"./views/image-details.js"</span>:<span class="hljs-number">48</span>,<span class="hljs-string">"./views/label.js"</span>:<span class="hljs-number">49</span>,<span class="hljs-string">"./views/media-frame.js"</span>:<span class="hljs-number">50</span>,<span class="hljs-string">"./views/menu-item.js"</span>:<span class="hljs-number">51</span>,<span class="hljs-string">"./views/menu.js"</span>:<span class="hljs-number">52</span>,<span class="hljs-string">"./views/modal.js"</span>:<span class="hljs-number">53</span>,<span class="hljs-string">"./views/priority-list.js"</span>:<span class="hljs-number">54</span>,<span class="hljs-string">"./views/router-item.js"</span>:<span class="hljs-number">55</span>,<span class="hljs-string">"./views/router.js"</span>:<span class="hljs-number">56</span>,<span class="hljs-string">"./views/search.js"</span>:<span class="hljs-number">57</span>,<span class="hljs-string">"./views/selection.js"</span>:<span class="hljs-number">58</span>,<span class="hljs-string">"./views/settings.js"</span>:<span class="hljs-number">59</span>,<span class="hljs-string">"./views/settings/attachment-display.js"</span>:<span class="hljs-number">60</span>,<span class="hljs-string">"./views/settings/gallery.js"</span>:<span class="hljs-number">61</span>,<span class="hljs-string">"./views/settings/playlist.js"</span>:<span class="hljs-number">62</span>,<span class="hljs-string">"./views/sidebar.js"</span>:<span class="hljs-number">63</span>,<span class="hljs-string">"./views/site-icon-cropper.js"</span>:<span class="hljs-number">64</span>,<span class="hljs-string">"./views/site-icon-preview.js"</span>:<span class="hljs-number">65</span>,<span class="hljs-string">"./views/spinner.js"</span>:<span class="hljs-number">66</span>,<span class="hljs-string">"./views/toolbar.js"</span>:<span class="hljs-number">67</span>,<span class="hljs-string">"./views/toolbar/embed.js"</span>:<span class="hljs-number">68</span>,<span class="hljs-string">"./views/toolbar/select.js"</span>:<span class="hljs-number">69</span>,<span class="hljs-string">"./views/uploader/editor.js"</span>:<span class="hljs-number">70</span>,<span class="hljs-string">"./views/uploader/inline.js"</span>:<span class="hljs-number">71</span>,<span class="hljs-string">"./views/uploader/status-error.js"</span>:<span class="hljs-number">72</span>,<span class="hljs-string">"./views/uploader/status.js"</span>:<span class="hljs-number">73</span>,<span class="hljs-string">"./views/uploader/window.js"</span>:<span class="hljs-number">74</span>,<span class="hljs-string">"./views/view.js"</span>:<span class="hljs-number">75</span>}],<span class="hljs-number">20</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.AttachmentCompat
 *
 * A view to display fields added via the `attachment_fields_to_edit` filter.
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	AttachmentCompat;

AttachmentCompat = View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'form'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'compat-item'</span>,

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'submit'</span>:          <span class="hljs-string">'preventDefault'</span>,
		<span class="hljs-string">'change input'</span>:    <span class="hljs-string">'save'</span>,
		<span class="hljs-string">'change select'</span>:   <span class="hljs-string">'save'</span>,
		<span class="hljs-string">'change textarea'</span>: <span class="hljs-string">'save'</span>
	},

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:compat'</span>, <span class="hljs-keyword">this</span>.render );
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.AttachmentCompat} Returns itself to allow chaining
	 */</span>
	dispose: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.$(<span class="hljs-string">':focus'</span>).length ) {
			<span class="hljs-keyword">this</span>.save();
		}
		<span class="hljs-comment">/**
		 * call 'dispose' directly on the parent class
		 */</span>
		<span class="hljs-keyword">return</span> View.prototype.dispose.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.AttachmentCompat} Returns itself to allow chaining
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> compat = <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'compat'</span>);
		<span class="hljs-keyword">if</span> ( ! compat || ! compat.item ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.views.detach();
		<span class="hljs-keyword">this</span>.$el.html( compat.item );
		<span class="hljs-keyword">this</span>.views.render();
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	preventDefault: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		event.preventDefault();
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	save: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> data = {};

		<span class="hljs-keyword">if</span> ( event ) {
			event.preventDefault();
		}

		_.each( <span class="hljs-keyword">this</span>.$el.serializeArray(), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> pair </span>) </span>{
			data[ pair.name ] = pair.value;
		});

		<span class="hljs-keyword">this</span>.controller.trigger( <span class="hljs-string">'attachment:compat:waiting'</span>, [<span class="hljs-string">'waiting'</span>] );
		<span class="hljs-keyword">this</span>.model.saveCompat( data ).always( _.bind( <span class="hljs-keyword">this</span>.postSave, <span class="hljs-keyword">this</span> ) );
	},

	<span class="hljs-attr">postSave</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.controller.trigger( <span class="hljs-string">'attachment:compat:ready'</span>, [<span class="hljs-string">'ready'</span>] );
	}
});

<span class="hljs-built_in">module</span>.exports = AttachmentCompat;

},{}],<span class="hljs-number">21</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.AttachmentFilters
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> $ = jQuery,
	AttachmentFilters;

AttachmentFilters = wp.media.View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'select'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'attachment-filters'</span>,
	<span class="hljs-attr">id</span>:        <span class="hljs-string">'media-attachment-filters'</span>,

	<span class="hljs-attr">events</span>: {
		<span class="hljs-attr">change</span>: <span class="hljs-string">'change'</span>
	},

	<span class="hljs-attr">keys</span>: [],

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.createFilters();
		_.extend( <span class="hljs-keyword">this</span>.filters, <span class="hljs-keyword">this</span>.options.filters );</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Build <code>&lt;option&gt;</code> elements.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.$el.html( _.chain( <span class="hljs-keyword">this</span>.filters ).map( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> filter, value </span>) </span>{
			<span class="hljs-keyword">return</span> {
				<span class="hljs-attr">el</span>: $( <span class="hljs-string">'&lt;option&gt;&lt;/option&gt;'</span> ).val( value ).html( filter.text )[<span class="hljs-number">0</span>],
				<span class="hljs-attr">priority</span>: filter.priority || <span class="hljs-number">50</span>
			};
		}, <span class="hljs-keyword">this</span> ).sortBy(<span class="hljs-string">'priority'</span>).pluck(<span class="hljs-string">'el'</span>).value() );

		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>.select );
		<span class="hljs-keyword">this</span>.select();
	},

	<span class="hljs-comment">/**
	 * @abstract
	 */</span>
	createFilters: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.filters = {};
	},

	<span class="hljs-comment">/**
	 * When the selected filter changes, update the Attachment Query properties to match.
	 */</span>
	change: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> filter = <span class="hljs-keyword">this</span>.filters[ <span class="hljs-keyword">this</span>.el.value ];
		<span class="hljs-keyword">if</span> ( filter ) {
			<span class="hljs-keyword">this</span>.model.set( filter.props );
		}
	},

	<span class="hljs-attr">select</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> model = <span class="hljs-keyword">this</span>.model,
			value = <span class="hljs-string">'all'</span>,
			props = model.toJSON();

		_.find( <span class="hljs-keyword">this</span>.filters, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> filter, id </span>) </span>{
			<span class="hljs-keyword">var</span> equal = _.all( filter.props, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> prop, key </span>) </span>{
				<span class="hljs-keyword">return</span> prop === ( _.isUndefined( props[ key ] ) ? <span class="hljs-literal">null</span> : props[ key ] );
			});

			<span class="hljs-keyword">if</span> ( equal ) {
				<span class="hljs-keyword">return</span> value = id;
			}
		});

		<span class="hljs-keyword">this</span>.$el.val( value );
	}
});

<span class="hljs-built_in">module</span>.exports = AttachmentFilters;

},{}],<span class="hljs-number">22</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.AttachmentFilters.All
 *
 * @class
 * @augments wp.media.view.AttachmentFilters
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> l10n = wp.media.view.l10n,
	All;

All = wp.media.view.AttachmentFilters.extend({
	<span class="hljs-attr">createFilters</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> filters = {};

		_.each( wp.media.view.settings.mimeTypes || {}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> text, key </span>) </span>{
			filters[ key ] = {
				<span class="hljs-attr">text</span>: text,
				<span class="hljs-attr">props</span>: {
					<span class="hljs-attr">status</span>:  <span class="hljs-literal">null</span>,
					<span class="hljs-attr">type</span>:    key,
					<span class="hljs-attr">uploadedTo</span>: <span class="hljs-literal">null</span>,
					<span class="hljs-attr">orderby</span>: <span class="hljs-string">'date'</span>,
					<span class="hljs-attr">order</span>:   <span class="hljs-string">'DESC'</span>
				}
			};
		});

		filters.all = {
			<span class="hljs-attr">text</span>:  l10n.allMediaItems,
			<span class="hljs-attr">props</span>: {
				<span class="hljs-attr">status</span>:  <span class="hljs-literal">null</span>,
				<span class="hljs-attr">type</span>:    <span class="hljs-literal">null</span>,
				<span class="hljs-attr">uploadedTo</span>: <span class="hljs-literal">null</span>,
				<span class="hljs-attr">orderby</span>: <span class="hljs-string">'date'</span>,
				<span class="hljs-attr">order</span>:   <span class="hljs-string">'DESC'</span>
			},
			<span class="hljs-attr">priority</span>: <span class="hljs-number">10</span>
		};

		<span class="hljs-keyword">if</span> ( wp.media.view.settings.post.id ) {
			filters.uploaded = {
				<span class="hljs-attr">text</span>:  l10n.uploadedToThisPost,
				<span class="hljs-attr">props</span>: {
					<span class="hljs-attr">status</span>:  <span class="hljs-literal">null</span>,
					<span class="hljs-attr">type</span>:    <span class="hljs-literal">null</span>,
					<span class="hljs-attr">uploadedTo</span>: wp.media.view.settings.post.id,
					<span class="hljs-attr">orderby</span>: <span class="hljs-string">'menuOrder'</span>,
					<span class="hljs-attr">order</span>:   <span class="hljs-string">'ASC'</span>
				},
				<span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>
			};
		}

		filters.unattached = {
			<span class="hljs-attr">text</span>:  l10n.unattached,
			<span class="hljs-attr">props</span>: {
				<span class="hljs-attr">status</span>:     <span class="hljs-literal">null</span>,
				<span class="hljs-attr">uploadedTo</span>: <span class="hljs-number">0</span>,
				<span class="hljs-attr">type</span>:       <span class="hljs-literal">null</span>,
				<span class="hljs-attr">orderby</span>:    <span class="hljs-string">'menuOrder'</span>,
				<span class="hljs-attr">order</span>:      <span class="hljs-string">'ASC'</span>
			},
			<span class="hljs-attr">priority</span>: <span class="hljs-number">50</span>
		};

		<span class="hljs-keyword">if</span> ( wp.media.view.settings.mediaTrash &amp;&amp;
			<span class="hljs-keyword">this</span>.controller.isModeActive( <span class="hljs-string">'grid'</span> ) ) {

			filters.trash = {
				<span class="hljs-attr">text</span>:  l10n.trash,
				<span class="hljs-attr">props</span>: {
					<span class="hljs-attr">uploadedTo</span>: <span class="hljs-literal">null</span>,
					<span class="hljs-attr">status</span>:     <span class="hljs-string">'trash'</span>,
					<span class="hljs-attr">type</span>:       <span class="hljs-literal">null</span>,
					<span class="hljs-attr">orderby</span>:    <span class="hljs-string">'date'</span>,
					<span class="hljs-attr">order</span>:      <span class="hljs-string">'DESC'</span>
				},
				<span class="hljs-attr">priority</span>: <span class="hljs-number">50</span>
			};
		}

		<span class="hljs-keyword">this</span>.filters = filters;
	}
});

<span class="hljs-built_in">module</span>.exports = All;

},{}],<span class="hljs-number">23</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * A filter dropdown for month/dates.
 *
 * @class
 * @augments wp.media.view.AttachmentFilters
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> l10n = wp.media.view.l10n,
	DateFilter;

DateFilter = wp.media.view.AttachmentFilters.extend({
	<span class="hljs-attr">id</span>: <span class="hljs-string">'media-attachment-date-filters'</span>,

	<span class="hljs-attr">createFilters</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> filters = {};
		_.each( wp.media.view.settings.months || {}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, index </span>) </span>{
			filters[ index ] = {
				<span class="hljs-attr">text</span>: value.text,
				<span class="hljs-attr">props</span>: {
					<span class="hljs-attr">year</span>: value.year,
					<span class="hljs-attr">monthnum</span>: value.month
				}
			};
		});
		filters.all = {
			<span class="hljs-attr">text</span>:  l10n.allDates,
			<span class="hljs-attr">props</span>: {
				<span class="hljs-attr">monthnum</span>: <span class="hljs-literal">false</span>,
				<span class="hljs-attr">year</span>:  <span class="hljs-literal">false</span>
			},
			<span class="hljs-attr">priority</span>: <span class="hljs-number">10</span>
		};
		<span class="hljs-keyword">this</span>.filters = filters;
	}
});

<span class="hljs-built_in">module</span>.exports = DateFilter;

},{}],<span class="hljs-number">24</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.AttachmentFilters.Uploaded
 *
 * @class
 * @augments wp.media.view.AttachmentFilters
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> l10n = wp.media.view.l10n,
	Uploaded;

Uploaded = wp.media.view.AttachmentFilters.extend({
	<span class="hljs-attr">createFilters</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> type = <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'type'</span>),
			types = wp.media.view.settings.mimeTypes,
			text;

		<span class="hljs-keyword">if</span> ( types &amp;&amp; type ) {
			text = types[ type ];
		}

		<span class="hljs-keyword">this</span>.filters = {
			<span class="hljs-attr">all</span>: {
				<span class="hljs-attr">text</span>:  text || l10n.allMediaItems,
				<span class="hljs-attr">props</span>: {
					<span class="hljs-attr">uploadedTo</span>: <span class="hljs-literal">null</span>,
					<span class="hljs-attr">orderby</span>: <span class="hljs-string">'date'</span>,
					<span class="hljs-attr">order</span>:   <span class="hljs-string">'DESC'</span>
				},
				<span class="hljs-attr">priority</span>: <span class="hljs-number">10</span>
			},

			<span class="hljs-attr">uploaded</span>: {
				<span class="hljs-attr">text</span>:  l10n.uploadedToThisPost,
				<span class="hljs-attr">props</span>: {
					<span class="hljs-attr">uploadedTo</span>: wp.media.view.settings.post.id,
					<span class="hljs-attr">orderby</span>: <span class="hljs-string">'menuOrder'</span>,
					<span class="hljs-attr">order</span>:   <span class="hljs-string">'ASC'</span>
				},
				<span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>
			},

			<span class="hljs-attr">unattached</span>: {
				<span class="hljs-attr">text</span>:  l10n.unattached,
				<span class="hljs-attr">props</span>: {
					<span class="hljs-attr">uploadedTo</span>: <span class="hljs-number">0</span>,
					<span class="hljs-attr">orderby</span>: <span class="hljs-string">'menuOrder'</span>,
					<span class="hljs-attr">order</span>:   <span class="hljs-string">'ASC'</span>
				},
				<span class="hljs-attr">priority</span>: <span class="hljs-number">50</span>
			}
		};
	}
});

<span class="hljs-built_in">module</span>.exports = Uploaded;

},{}],<span class="hljs-number">25</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Attachment
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	$ = jQuery,
	Attachment;

Attachment = View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'li'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'attachment'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'attachment'</span>),

	<span class="hljs-attr">attributes</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> {
			<span class="hljs-string">'tabIndex'</span>:     <span class="hljs-number">0</span>,
			<span class="hljs-string">'role'</span>:         <span class="hljs-string">'checkbox'</span>,
			<span class="hljs-string">'aria-label'</span>:   <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'title'</span> ),
			<span class="hljs-string">'aria-checked'</span>: <span class="hljs-literal">false</span>,
			<span class="hljs-string">'data-id'</span>:      <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'id'</span> )
		};
	},

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'click .js--select-attachment'</span>:   <span class="hljs-string">'toggleSelectionHandler'</span>,
		<span class="hljs-string">'change [data-setting]'</span>:          <span class="hljs-string">'updateSetting'</span>,
		<span class="hljs-string">'change [data-setting] input'</span>:    <span class="hljs-string">'updateSetting'</span>,
		<span class="hljs-string">'change [data-setting] select'</span>:   <span class="hljs-string">'updateSetting'</span>,
		<span class="hljs-string">'change [data-setting] textarea'</span>: <span class="hljs-string">'updateSetting'</span>,
		<span class="hljs-string">'click .attachment-close'</span>:        <span class="hljs-string">'removeFromLibrary'</span>,
		<span class="hljs-string">'click .check'</span>:                   <span class="hljs-string">'checkClickHandler'</span>,
		<span class="hljs-string">'keydown'</span>:                        <span class="hljs-string">'toggleSelectionHandler'</span>
	},

	<span class="hljs-attr">buttons</span>: {},

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.options.selection,
			options = _.defaults( <span class="hljs-keyword">this</span>.options, {
				<span class="hljs-attr">rerenderOnModelChange</span>: <span class="hljs-literal">true</span>
			} );

		<span class="hljs-keyword">if</span> ( options.rerenderOnModelChange ) {
			<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>.render );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:percent'</span>, <span class="hljs-keyword">this</span>.progress );
		}
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:title'</span>, <span class="hljs-keyword">this</span>._syncTitle );
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:caption'</span>, <span class="hljs-keyword">this</span>._syncCaption );
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:artist'</span>, <span class="hljs-keyword">this</span>._syncArtist );
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:album'</span>, <span class="hljs-keyword">this</span>._syncAlbum );</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>Update the selection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'add'</span>, <span class="hljs-keyword">this</span>.select );
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'remove'</span>, <span class="hljs-keyword">this</span>.deselect );
		<span class="hljs-keyword">if</span> ( selection ) {
			selection.on( <span class="hljs-string">'reset'</span>, <span class="hljs-keyword">this</span>.updateSelect, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Update the model’s details view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'selection:single selection:unsingle'</span>, <span class="hljs-keyword">this</span>.details );
			<span class="hljs-keyword">this</span>.details( <span class="hljs-keyword">this</span>.model, <span class="hljs-keyword">this</span>.controller.state().get(<span class="hljs-string">'selection'</span>) );
		}

		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.controller, <span class="hljs-string">'attachment:compat:waiting attachment:compat:ready'</span>, <span class="hljs-keyword">this</span>.updateSave );
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.Attachment} Returns itself to allow chaining
	 */</span>
	dispose: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.options.selection;</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>Make sure all settings are saved before removing the view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.updateAll();

		<span class="hljs-keyword">if</span> ( selection ) {
			selection.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
		}
		<span class="hljs-comment">/**
		 * call 'dispose' directly on the parent class
		 */</span>
		View.prototype.dispose.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.Attachment} Returns itself to allow chaining
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> options = _.defaults( <span class="hljs-keyword">this</span>.model.toJSON(), {
				<span class="hljs-attr">orientation</span>:   <span class="hljs-string">'landscape'</span>,
				<span class="hljs-attr">uploading</span>:     <span class="hljs-literal">false</span>,
				<span class="hljs-attr">type</span>:          <span class="hljs-string">''</span>,
				<span class="hljs-attr">subtype</span>:       <span class="hljs-string">''</span>,
				<span class="hljs-attr">icon</span>:          <span class="hljs-string">''</span>,
				<span class="hljs-attr">filename</span>:      <span class="hljs-string">''</span>,
				<span class="hljs-attr">caption</span>:       <span class="hljs-string">''</span>,
				<span class="hljs-attr">title</span>:         <span class="hljs-string">''</span>,
				<span class="hljs-attr">dateFormatted</span>: <span class="hljs-string">''</span>,
				<span class="hljs-attr">width</span>:         <span class="hljs-string">''</span>,
				<span class="hljs-attr">height</span>:        <span class="hljs-string">''</span>,
				<span class="hljs-attr">compat</span>:        <span class="hljs-literal">false</span>,
				<span class="hljs-attr">alt</span>:           <span class="hljs-string">''</span>,
				<span class="hljs-attr">description</span>:   <span class="hljs-string">''</span>
			}, <span class="hljs-keyword">this</span>.options );

		options.buttons  = <span class="hljs-keyword">this</span>.buttons;
		options.describe = <span class="hljs-keyword">this</span>.controller.state().get(<span class="hljs-string">'describe'</span>);

		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'image'</span> === options.type ) {
			options.size = <span class="hljs-keyword">this</span>.imageSize();
		}

		options.can = {};
		<span class="hljs-keyword">if</span> ( options.nonces ) {
			options.can.remove = !! options.nonces[<span class="hljs-string">'delete'</span>];
			options.can.save = !! options.nonces.update;
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.state().get(<span class="hljs-string">'allowLocalEdits'</span>) ) {
			options.allowLocalEdits = <span class="hljs-literal">true</span>;
		}

		<span class="hljs-keyword">if</span> ( options.uploading &amp;&amp; ! options.percent ) {
			options.percent = <span class="hljs-number">0</span>;
		}

		<span class="hljs-keyword">this</span>.views.detach();
		<span class="hljs-keyword">this</span>.$el.html( <span class="hljs-keyword">this</span>.template( options ) );

		<span class="hljs-keyword">this</span>.$el.toggleClass( <span class="hljs-string">'uploading'</span>, options.uploading );

		<span class="hljs-keyword">if</span> ( options.uploading ) {
			<span class="hljs-keyword">this</span>.$bar = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'.media-progress-bar div'</span>);
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.$bar;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>Check if the model is selected.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.updateSelect();</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Update the save status.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.updateSave();

		<span class="hljs-keyword">this</span>.views.render();

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">progress</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.$bar &amp;&amp; <span class="hljs-keyword">this</span>.$bar.length ) {
			<span class="hljs-keyword">this</span>.$bar.width( <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'percent'</span>) + <span class="hljs-string">'%'</span> );
		}
	},

	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	toggleSelectionHandler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> method;</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>Don’t do anything inside inputs and on the attachment check and remove buttons.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'INPUT'</span> === event.target.nodeName || <span class="hljs-string">'BUTTON'</span> === event.target.nodeName ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Catch arrow events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-number">37</span> === event.keyCode || <span class="hljs-number">38</span> === event.keyCode || <span class="hljs-number">39</span> === event.keyCode || <span class="hljs-number">40</span> === event.keyCode ) {
			<span class="hljs-keyword">this</span>.controller.trigger( <span class="hljs-string">'attachment:keydown:arrow'</span>, event );
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>Catch enter and space events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'keydown'</span> === event.type &amp;&amp; <span class="hljs-number">13</span> !== event.keyCode &amp;&amp; <span class="hljs-number">32</span> !== event.keyCode ) {
			<span class="hljs-keyword">return</span>;
		}

		event.preventDefault();</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>In the grid view, bubble up an edit:attachment event to the controller.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.isModeActive( <span class="hljs-string">'grid'</span> ) ) {
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.isModeActive( <span class="hljs-string">'edit'</span> ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>Pass the current target to restore focus when closing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.controller.trigger( <span class="hljs-string">'edit:attachment'</span>, <span class="hljs-keyword">this</span>.model, event.currentTarget );
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.isModeActive( <span class="hljs-string">'select'</span> ) ) {
				method = <span class="hljs-string">'toggle'</span>;
			}
		}

		<span class="hljs-keyword">if</span> ( event.shiftKey ) {
			method = <span class="hljs-string">'between'</span>;
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( event.ctrlKey || event.metaKey ) {
			method = <span class="hljs-string">'toggle'</span>;
		}

		<span class="hljs-keyword">this</span>.toggleSelection({
			<span class="hljs-attr">method</span>: method
		});

		<span class="hljs-keyword">this</span>.controller.trigger( <span class="hljs-string">'selection:toggle'</span> );
	},
	<span class="hljs-comment">/**
	 * @param {Object} options
	 */</span>
	toggleSelection: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">var</span> collection = <span class="hljs-keyword">this</span>.collection,
			selection = <span class="hljs-keyword">this</span>.options.selection,
			model = <span class="hljs-keyword">this</span>.model,
			method = options &amp;&amp; options.method,
			single, models, singleIndex, modelIndex;

		<span class="hljs-keyword">if</span> ( ! selection ) {
			<span class="hljs-keyword">return</span>;
		}

		single = selection.single();
		method = _.isUndefined( method ) ? selection.multiple : method;</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>If the <code>method</code> is set to <code>between</code>, select all models that
exist between the current and the selected model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'between'</span> === method &amp;&amp; single &amp;&amp; selection.multiple ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>If the models are the same, short-circuit.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( single === model ) {
				<span class="hljs-keyword">return</span>;
			}

			singleIndex = collection.indexOf( single );
			modelIndex  = collection.indexOf( <span class="hljs-keyword">this</span>.model );

			<span class="hljs-keyword">if</span> ( singleIndex &lt; modelIndex ) {
				models = collection.models.slice( singleIndex, modelIndex + <span class="hljs-number">1</span> );
			} <span class="hljs-keyword">else</span> {
				models = collection.models.slice( modelIndex, singleIndex + <span class="hljs-number">1</span> );
			}

			selection.add( models );
			selection.single( model );
			<span class="hljs-keyword">return</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>If the <code>method</code> is set to <code>toggle</code>, just flip the selection
status, regardless of whether the model is the single model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'toggle'</span> === method ) {
			selection[ <span class="hljs-keyword">this</span>.selected() ? <span class="hljs-string">'remove'</span> : <span class="hljs-string">'add'</span> ]( model );
			selection.single( model );
			<span class="hljs-keyword">return</span>;
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'add'</span> === method ) {
			selection.add( model );
			selection.single( model );
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>Fixes bug that loses focus when selecting a featured image</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! method ) {
			method = <span class="hljs-string">'add'</span>;
		}

		<span class="hljs-keyword">if</span> ( method !== <span class="hljs-string">'add'</span> ) {
			method = <span class="hljs-string">'reset'</span>;
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.selected() ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>If the model is the single model, remove it.
If it is not the same as the single model,
it now becomes the single model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			selection[ single === model ? <span class="hljs-string">'remove'</span> : <span class="hljs-string">'single'</span> ]( model );
		} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>If the model is not selected, run the <code>method</code> on the
selection. By default, we <code>reset</code> the selection, but the
<code>method</code> can be set to <code>add</code> the model to the selection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			selection[ method ]( model );
			selection.single( model );
		}
	},

	<span class="hljs-attr">updateSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>[ <span class="hljs-keyword">this</span>.selected() ? <span class="hljs-string">'select'</span> : <span class="hljs-string">'deselect'</span> ]();
	},
	<span class="hljs-comment">/**
	 * @returns {unresolved|Boolean}
	 */</span>
	selected: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.options.selection;
		<span class="hljs-keyword">if</span> ( selection ) {
			<span class="hljs-keyword">return</span> !! selection.get( <span class="hljs-keyword">this</span>.model.cid );
		}
	},
	<span class="hljs-comment">/**
	 * @param {Backbone.Model} model
	 * @param {Backbone.Collection} collection
	 */</span>
	select: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model, collection </span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.options.selection,
			controller = <span class="hljs-keyword">this</span>.controller;</pre></div></div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>Check if a selection exists and if it’s the collection provided.
If they’re not the same collection, bail; we’re in another
selection’s event loop.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! selection || ( collection &amp;&amp; collection !== selection ) ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <p>Bail if the model is already selected.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.$el.hasClass( <span class="hljs-string">'selected'</span> ) ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <p>Add ‘selected’ class to model, set aria-checked to true.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.$el.addClass( <span class="hljs-string">'selected'</span> ).attr( <span class="hljs-string">'aria-checked'</span>, <span class="hljs-literal">true</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <p> Make the checkbox tabable, except in media grid (bulk select mode).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! ( controller.isModeActive( <span class="hljs-string">'grid'</span> ) &amp;&amp; controller.isModeActive( <span class="hljs-string">'select'</span> ) ) ) {
			<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.check'</span> ).attr( <span class="hljs-string">'tabindex'</span>, <span class="hljs-string">'0'</span> );
		}
	},
	<span class="hljs-comment">/**
	 * @param {Backbone.Model} model
	 * @param {Backbone.Collection} collection
	 */</span>
	deselect: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model, collection </span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.options.selection;</pre></div></div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <p>Check if a selection exists and if it’s the collection provided.
If they’re not the same collection, bail; we’re in another
selection’s event loop.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! selection || ( collection &amp;&amp; collection !== selection ) ) {
			<span class="hljs-keyword">return</span>;
		}
		<span class="hljs-keyword">this</span>.$el.removeClass( <span class="hljs-string">'selected'</span> ).attr( <span class="hljs-string">'aria-checked'</span>, <span class="hljs-literal">false</span> )
			.find( <span class="hljs-string">'.check'</span> ).attr( <span class="hljs-string">'tabindex'</span>, <span class="hljs-string">'-1'</span> );
	},
	<span class="hljs-comment">/**
	 * @param {Backbone.Model} model
	 * @param {Backbone.Collection} collection
	 */</span>
	details: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model, collection </span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.options.selection,
			details;

		<span class="hljs-keyword">if</span> ( selection !== collection ) {
			<span class="hljs-keyword">return</span>;
		}

		details = selection.single();
		<span class="hljs-keyword">this</span>.$el.toggleClass( <span class="hljs-string">'details'</span>, details === <span class="hljs-keyword">this</span>.model );
	},
	<span class="hljs-comment">/**
	 * @param {string} size
	 * @returns {Object}
	 */</span>
	imageSize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> size </span>) </span>{
		<span class="hljs-keyword">var</span> sizes = <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'sizes'</span>), matched = <span class="hljs-literal">false</span>;

		size = size || <span class="hljs-string">'medium'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <p>Use the provided image size if possible.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( sizes ) {
			<span class="hljs-keyword">if</span> ( sizes[ size ] ) {
				matched = sizes[ size ];
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( sizes.large ) {
				matched = sizes.large;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( sizes.thumbnail ) {
				matched = sizes.thumbnail;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( sizes.full ) {
				matched = sizes.full;
			}

			<span class="hljs-keyword">if</span> ( matched ) {
				<span class="hljs-keyword">return</span> _.clone( matched );
			}
		}

		<span class="hljs-keyword">return</span> {
			<span class="hljs-attr">url</span>:         <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'url'</span>),
			<span class="hljs-attr">width</span>:       <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'width'</span>),
			<span class="hljs-attr">height</span>:      <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'height'</span>),
			<span class="hljs-attr">orientation</span>: <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'orientation'</span>)
		};
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	updateSetting: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> $setting = $( event.target ).closest(<span class="hljs-string">'[data-setting]'</span>),
			setting, value;

		<span class="hljs-keyword">if</span> ( ! $setting.length ) {
			<span class="hljs-keyword">return</span>;
		}

		setting = $setting.data(<span class="hljs-string">'setting'</span>);
		value   = event.target.value;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.model.get( setting ) !== value ) {
			<span class="hljs-keyword">this</span>.save( setting, value );
		}
	},

	<span class="hljs-comment">/**
	 * Pass all the arguments to the model's save method.
	 *
	 * Records the aggregate status of all save requests and updates the
	 * view's classes accordingly.
	 */</span>
	save: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>,
			save = <span class="hljs-keyword">this</span>._save = <span class="hljs-keyword">this</span>._save || { <span class="hljs-attr">status</span>: <span class="hljs-string">'ready'</span> },
			request = <span class="hljs-keyword">this</span>.model.save.apply( <span class="hljs-keyword">this</span>.model, <span class="hljs-built_in">arguments</span> ),
			requests = save.requests ? $.when( request, save.requests ) : request;</pre></div></div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p>If we’re waiting to remove ‘Saved.’, stop.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( save.savedTimer ) {
			clearTimeout( save.savedTimer );
		}

		<span class="hljs-keyword">this</span>.updateSave(<span class="hljs-string">'waiting'</span>);
		save.requests = requests;
		requests.always( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-84">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>If we’ve performed another request since this one, bail.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( save.requests !== requests ) {
				<span class="hljs-keyword">return</span>;
			}

			view.updateSave( requests.state() === <span class="hljs-string">'resolved'</span> ? <span class="hljs-string">'complete'</span> : <span class="hljs-string">'error'</span> );
			save.savedTimer = setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				view.updateSave(<span class="hljs-string">'ready'</span>);
				<span class="hljs-keyword">delete</span> save.savedTimer;
			}, <span class="hljs-number">2000</span> );
		});
	},
	<span class="hljs-comment">/**
	 * @param {string} status
	 * @returns {wp.media.view.Attachment} Returns itself to allow chaining
	 */</span>
	updateSave: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> status </span>) </span>{
		<span class="hljs-keyword">var</span> save = <span class="hljs-keyword">this</span>._save = <span class="hljs-keyword">this</span>._save || { <span class="hljs-attr">status</span>: <span class="hljs-string">'ready'</span> };

		<span class="hljs-keyword">if</span> ( status &amp;&amp; status !== save.status ) {
			<span class="hljs-keyword">this</span>.$el.removeClass( <span class="hljs-string">'save-'</span> + save.status );
			save.status = status;
		}

		<span class="hljs-keyword">this</span>.$el.addClass( <span class="hljs-string">'save-'</span> + save.status );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">updateAll</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> $settings = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'[data-setting]'</span>),
			model = <span class="hljs-keyword">this</span>.model,
			changed;

		changed = _.chain( $settings ).map( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> el </span>) </span>{
			<span class="hljs-keyword">var</span> $input = $(<span class="hljs-string">'input, textarea, select, [value]'</span>, el ),
				setting, value;

			<span class="hljs-keyword">if</span> ( ! $input.length ) {
				<span class="hljs-keyword">return</span>;
			}

			setting = $(el).data(<span class="hljs-string">'setting'</span>);
			value = $input.val();</pre></div></div>
            
        </li>
        
        
        <li id="section-85">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-85">&#182;</a>
              </div>
              <p>Record the value if it changed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( model.get( setting ) !== value ) {
				<span class="hljs-keyword">return</span> [ setting, value ];
			}
		}).compact().object().value();

		<span class="hljs-keyword">if</span> ( ! _.isEmpty( changed ) ) {
			model.save( changed );
		}
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	removeFromLibrary: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-86">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-86">&#182;</a>
              </div>
              <p>Catch enter and space events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'keydown'</span> === event.type &amp;&amp; <span class="hljs-number">13</span> !== event.keyCode &amp;&amp; <span class="hljs-number">32</span> !== event.keyCode ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-87">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-87">&#182;</a>
              </div>
              <p>Stop propagation so the model isn’t selected.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		event.stopPropagation();

		<span class="hljs-keyword">this</span>.collection.remove( <span class="hljs-keyword">this</span>.model );
	},

	<span class="hljs-comment">/**
	 * Add the model if it isn't in the selection, if it is in the selection,
	 * remove it.
	 *
	 * @param  {[type]} event [description]
	 * @return {[type]}       [description]
	 */</span>
	checkClickHandler: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.options.selection;
		<span class="hljs-keyword">if</span> ( ! selection ) {
			<span class="hljs-keyword">return</span>;
		}
		event.stopPropagation();
		<span class="hljs-keyword">if</span> ( selection.where( { <span class="hljs-attr">id</span>: <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'id'</span> ) } ).length ) {
			selection.remove( <span class="hljs-keyword">this</span>.model );</pre></div></div>
            
        </li>
        
        
        <li id="section-88">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-88">&#182;</a>
              </div>
              <p>Move focus back to the attachment tile (from the check).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.$el.focus();
		} <span class="hljs-keyword">else</span> {
			selection.add( <span class="hljs-keyword">this</span>.model );
		}
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-89">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-89">&#182;</a>
              </div>
              <p>Ensure settings remain in sync between attachment views.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>_.each({
	<span class="hljs-attr">caption</span>: <span class="hljs-string">'_syncCaption'</span>,
	<span class="hljs-attr">title</span>:   <span class="hljs-string">'_syncTitle'</span>,
	<span class="hljs-attr">artist</span>:  <span class="hljs-string">'_syncArtist'</span>,
	<span class="hljs-attr">album</span>:   <span class="hljs-string">'_syncAlbum'</span>
}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> method, setting </span>) </span>{
	<span class="hljs-comment">/**
	 * @param {Backbone.Model} model
	 * @param {string} value
	 * @returns {wp.media.view.Attachment} Returns itself to allow chaining
	 */</span>
	Attachment.prototype[ method ] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model, value </span>) </span>{
		<span class="hljs-keyword">var</span> $setting = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'[data-setting="'</span> + setting + <span class="hljs-string">'"]'</span>);

		<span class="hljs-keyword">if</span> ( ! $setting.length ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-90">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-90">&#182;</a>
              </div>
              <p>If the updated value is in sync with the value in the DOM, there
is no need to re-render. If we’re currently editing the value,
it will automatically be in sync, suppressing the re-render for
the view we’re editing, while updating any others.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( value === $setting.find(<span class="hljs-string">'input, textarea, select, [value]'</span>).val() ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.render();
	};
});

<span class="hljs-built_in">module</span>.exports = Attachment;

},{}],<span class="hljs-number">26</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Attachment.Details
 *
 * @class
 * @augments wp.media.view.Attachment
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Attachment = wp.media.view.Attachment,
	l10n = wp.media.view.l10n,
	Details;

Details = Attachment.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'div'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'attachment-details'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'attachment-details'</span>),

	<span class="hljs-attr">attributes</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> {
			<span class="hljs-string">'tabIndex'</span>:     <span class="hljs-number">0</span>,
			<span class="hljs-string">'data-id'</span>:      <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'id'</span> )
		};
	},

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'change [data-setting]'</span>:          <span class="hljs-string">'updateSetting'</span>,
		<span class="hljs-string">'change [data-setting] input'</span>:    <span class="hljs-string">'updateSetting'</span>,
		<span class="hljs-string">'change [data-setting] select'</span>:   <span class="hljs-string">'updateSetting'</span>,
		<span class="hljs-string">'change [data-setting] textarea'</span>: <span class="hljs-string">'updateSetting'</span>,
		<span class="hljs-string">'click .delete-attachment'</span>:       <span class="hljs-string">'deleteAttachment'</span>,
		<span class="hljs-string">'click .trash-attachment'</span>:        <span class="hljs-string">'trashAttachment'</span>,
		<span class="hljs-string">'click .untrash-attachment'</span>:      <span class="hljs-string">'untrashAttachment'</span>,
		<span class="hljs-string">'click .edit-attachment'</span>:         <span class="hljs-string">'editAttachment'</span>,
		<span class="hljs-string">'keydown'</span>:                        <span class="hljs-string">'toggleSelectionHandler'</span>
	},

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.options = _.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">rerenderOnModelChange</span>: <span class="hljs-literal">false</span>
		});

		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'ready'</span>, <span class="hljs-keyword">this</span>.initialFocus );</pre></div></div>
            
        </li>
        
        
        <li id="section-91">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-91">&#182;</a>
              </div>
              <p>Call ‘initialize’ directly on the parent class.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		Attachment.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-attr">initialFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( ! wp.media.isTouchDevice ) {
			<span class="hljs-comment">/*
			Previously focused the first ':input' (the readonly URL text field).
			Since the first ':input' is now a button (delete/trash): when pressing
			spacebar on an attachment, Firefox fires deleteAttachment/trashAttachment
			as soon as focus is moved. Explicitly target the first text field for now.
			@todo change initial focus logic, also for accessibility.
			*/</span>
			<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'input[type="text"]'</span> ).eq( <span class="hljs-number">0</span> ).focus();
		}
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	deleteAttachment: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		event.preventDefault();

		<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">window</span>.confirm( l10n.warnDelete ) ) {
			<span class="hljs-keyword">this</span>.model.destroy();</pre></div></div>
            
        </li>
        
        
        <li id="section-92">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-92">&#182;</a>
              </div>
              <p>Keep focus inside media modal
after image is deleted</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.controller.modal.focusManager.focus();
		}
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	trashAttachment: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> library = <span class="hljs-keyword">this</span>.controller.library;
		event.preventDefault();

		<span class="hljs-keyword">if</span> ( wp.media.view.settings.mediaTrash &amp;&amp;
			<span class="hljs-string">'edit-metadata'</span> === <span class="hljs-keyword">this</span>.controller.content.mode() ) {

			<span class="hljs-keyword">this</span>.model.set( <span class="hljs-string">'status'</span>, <span class="hljs-string">'trash'</span> );
			<span class="hljs-keyword">this</span>.model.save().done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				library._requery( <span class="hljs-literal">true</span> );
			} );
		}  <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.model.destroy();
		}
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	untrashAttachment: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> library = <span class="hljs-keyword">this</span>.controller.library;
		event.preventDefault();

		<span class="hljs-keyword">this</span>.model.set( <span class="hljs-string">'status'</span>, <span class="hljs-string">'inherit'</span> );
		<span class="hljs-keyword">this</span>.model.save().done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			library._requery( <span class="hljs-literal">true</span> );
		} );
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	editAttachment: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> editState = <span class="hljs-keyword">this</span>.controller.states.get( <span class="hljs-string">'edit-image'</span> );
		<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">window</span>.imageEdit &amp;&amp; editState ) {
			event.preventDefault();

			editState.set( <span class="hljs-string">'image'</span>, <span class="hljs-keyword">this</span>.model );
			<span class="hljs-keyword">this</span>.controller.setState( <span class="hljs-string">'edit-image'</span> );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.$el.addClass(<span class="hljs-string">'needs-refresh'</span>);
		}
	},
	<span class="hljs-comment">/**
	 * When reverse tabbing(shift+tab) out of the right details panel, deliver
	 * the focus to the item in the list that was being edited.
	 *
	 * @param {Object} event
	 */</span>
	toggleSelectionHandler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'keydown'</span> === event.type &amp;&amp; <span class="hljs-number">9</span> === event.keyCode &amp;&amp; event.shiftKey &amp;&amp; event.target === <span class="hljs-keyword">this</span>.$( <span class="hljs-string">':tabbable'</span> ).get( <span class="hljs-number">0</span> ) ) {
			<span class="hljs-keyword">this</span>.controller.trigger( <span class="hljs-string">'attachment:details:shift-tab'</span>, event );
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-number">37</span> === event.keyCode || <span class="hljs-number">38</span> === event.keyCode || <span class="hljs-number">39</span> === event.keyCode || <span class="hljs-number">40</span> === event.keyCode ) {
			<span class="hljs-keyword">this</span>.controller.trigger( <span class="hljs-string">'attachment:keydown:arrow'</span>, event );
			<span class="hljs-keyword">return</span>;
		}
	}
});

<span class="hljs-built_in">module</span>.exports = Details;

},{}],<span class="hljs-number">27</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Attachment.EditLibrary
 *
 * @class
 * @augments wp.media.view.Attachment
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> EditLibrary = wp.media.view.Attachment.extend({
	<span class="hljs-attr">buttons</span>: {
		<span class="hljs-attr">close</span>: <span class="hljs-literal">true</span>
	}
});

<span class="hljs-built_in">module</span>.exports = EditLibrary;

},{}],<span class="hljs-number">28</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Attachments.EditSelection
 *
 * @class
 * @augments wp.media.view.Attachment.Selection
 * @augments wp.media.view.Attachment
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> EditSelection = wp.media.view.Attachment.Selection.extend({
	<span class="hljs-attr">buttons</span>: {
		<span class="hljs-attr">close</span>: <span class="hljs-literal">true</span>
	}
});

<span class="hljs-built_in">module</span>.exports = EditSelection;

},{}],<span class="hljs-number">29</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Attachment.Library
 *
 * @class
 * @augments wp.media.view.Attachment
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Library = wp.media.view.Attachment.extend({
	<span class="hljs-attr">buttons</span>: {
		<span class="hljs-attr">check</span>: <span class="hljs-literal">true</span>
	}
});

<span class="hljs-built_in">module</span>.exports = Library;

},{}],<span class="hljs-number">30</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Attachment.Selection
 *
 * @class
 * @augments wp.media.view.Attachment
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Selection = wp.media.view.Attachment.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'attachment selection'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-93">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-93">&#182;</a>
              </div>
              <p>On click, just select the model, instead of removing the model from
the selection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	toggleSelection: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.options.selection.single( <span class="hljs-keyword">this</span>.model );
	}
});

<span class="hljs-built_in">module</span>.exports = Selection;

},{}],<span class="hljs-number">31</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Attachments
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	$ = jQuery,
	Attachments;

Attachments = View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'ul'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'attachments'</span>,

	<span class="hljs-attr">attributes</span>: {
		<span class="hljs-attr">tabIndex</span>: <span class="hljs-number">-1</span>
	},

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.el.id = _.uniqueId(<span class="hljs-string">'__attachments-view-'</span>);

		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">refreshSensitivity</span>: wp.media.isTouchDevice ? <span class="hljs-number">300</span> : <span class="hljs-number">200</span>,
			<span class="hljs-attr">refreshThreshold</span>:   <span class="hljs-number">3</span>,
			<span class="hljs-attr">AttachmentView</span>:     wp.media.view.Attachment,
			<span class="hljs-attr">sortable</span>:           <span class="hljs-literal">false</span>,
			<span class="hljs-attr">resize</span>:             <span class="hljs-literal">true</span>,
			<span class="hljs-attr">idealColumnWidth</span>:   $( <span class="hljs-built_in">window</span> ).width() &lt; <span class="hljs-number">640</span> ? <span class="hljs-number">135</span> : <span class="hljs-number">150</span>
		});

		<span class="hljs-keyword">this</span>._viewsByCid = {};
		<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span> = $( <span class="hljs-built_in">window</span> );
		<span class="hljs-keyword">this</span>.resizeEvent = <span class="hljs-string">'resize.media-modal-columns'</span>;

		<span class="hljs-keyword">this</span>.collection.on( <span class="hljs-string">'add'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
			<span class="hljs-keyword">this</span>.views.add( <span class="hljs-keyword">this</span>.createAttachmentView( attachment ), {
				<span class="hljs-attr">at</span>: <span class="hljs-keyword">this</span>.collection.indexOf( attachment )
			});
		}, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.collection.on( <span class="hljs-string">'remove'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
			<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>._viewsByCid[ attachment.cid ];
			<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._viewsByCid[ attachment.cid ];

			<span class="hljs-keyword">if</span> ( view ) {
				view.remove();
			}
		}, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.collection.on( <span class="hljs-string">'reset'</span>, <span class="hljs-keyword">this</span>.render, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.controller, <span class="hljs-string">'library:selection:add'</span>,    <span class="hljs-keyword">this</span>.attachmentFocus );</pre></div></div>
            
        </li>
        
        
        <li id="section-94">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-94">&#182;</a>
              </div>
              <p>Throttle the scroll handler and bind this.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.scroll = _.chain( <span class="hljs-keyword">this</span>.scroll ).bind( <span class="hljs-keyword">this</span> ).throttle( <span class="hljs-keyword">this</span>.options.refreshSensitivity ).value();

		<span class="hljs-keyword">this</span>.options.scrollElement = <span class="hljs-keyword">this</span>.options.scrollElement || <span class="hljs-keyword">this</span>.el;
		$( <span class="hljs-keyword">this</span>.options.scrollElement ).on( <span class="hljs-string">'scroll'</span>, <span class="hljs-keyword">this</span>.scroll );

		<span class="hljs-keyword">this</span>.initSortable();

		_.bindAll( <span class="hljs-keyword">this</span>, <span class="hljs-string">'setColumns'</span> );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.resize ) {
			<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'ready'</span>, <span class="hljs-keyword">this</span>.bindEvents );
			<span class="hljs-keyword">this</span>.controller.on( <span class="hljs-string">'open'</span>, <span class="hljs-keyword">this</span>.setColumns );</pre></div></div>
            
        </li>
        
        
        <li id="section-95">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-95">&#182;</a>
              </div>
              <p>Call this.setColumns() after this view has been rendered in the DOM so
attachments get proper width applied.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			_.defer( <span class="hljs-keyword">this</span>.setColumns, <span class="hljs-keyword">this</span> );
		}
	},

	<span class="hljs-attr">bindEvents</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>.off( <span class="hljs-keyword">this</span>.resizeEvent ).on( <span class="hljs-keyword">this</span>.resizeEvent, _.debounce( <span class="hljs-keyword">this</span>.setColumns, <span class="hljs-number">50</span> ) );
	},

	<span class="hljs-attr">attachmentFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'li:first'</span> ).focus();
	},

	<span class="hljs-attr">restoreFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'li.selected:first'</span> ).focus();
	},

	<span class="hljs-attr">arrowEvent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> attachments = <span class="hljs-keyword">this</span>.$el.children( <span class="hljs-string">'li'</span> ),
			perRow = <span class="hljs-keyword">this</span>.columns,
			index = attachments.filter( <span class="hljs-string">':focus'</span> ).index(),
			row = ( index + <span class="hljs-number">1</span> ) &lt;= perRow ? <span class="hljs-number">1</span> : <span class="hljs-built_in">Math</span>.ceil( ( index + <span class="hljs-number">1</span> ) / perRow );

		<span class="hljs-keyword">if</span> ( index === <span class="hljs-number">-1</span> ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-96">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-96">&#182;</a>
              </div>
              <p>Left arrow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-number">37</span> === event.keyCode ) {
			<span class="hljs-keyword">if</span> ( <span class="hljs-number">0</span> === index ) {
				<span class="hljs-keyword">return</span>;
			}
			attachments.eq( index - <span class="hljs-number">1</span> ).focus();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-97">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-97">&#182;</a>
              </div>
              <p>Up arrow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-number">38</span> === event.keyCode ) {
			<span class="hljs-keyword">if</span> ( <span class="hljs-number">1</span> === row ) {
				<span class="hljs-keyword">return</span>;
			}
			attachments.eq( index - perRow ).focus();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-98">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-98">&#182;</a>
              </div>
              <p>Right arrow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-number">39</span> === event.keyCode ) {
			<span class="hljs-keyword">if</span> ( attachments.length === index ) {
				<span class="hljs-keyword">return</span>;
			}
			attachments.eq( index + <span class="hljs-number">1</span> ).focus();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-99">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-99">&#182;</a>
              </div>
              <p>Down arrow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-number">40</span> === event.keyCode ) {
			<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">Math</span>.ceil( attachments.length / perRow ) === row ) {
				<span class="hljs-keyword">return</span>;
			}
			attachments.eq( index + perRow ).focus();
		}
	},

	<span class="hljs-attr">dispose</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.collection.props.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.resize ) {
			<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>.off( <span class="hljs-keyword">this</span>.resizeEvent );
		}

		<span class="hljs-comment">/**
		 * call 'dispose' directly on the parent class
		 */</span>
		View.prototype.dispose.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-attr">setColumns</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> prev = <span class="hljs-keyword">this</span>.columns,
			width = <span class="hljs-keyword">this</span>.$el.width();

		<span class="hljs-keyword">if</span> ( width ) {
			<span class="hljs-keyword">this</span>.columns = <span class="hljs-built_in">Math</span>.min( <span class="hljs-built_in">Math</span>.round( width / <span class="hljs-keyword">this</span>.options.idealColumnWidth ), <span class="hljs-number">12</span> ) || <span class="hljs-number">1</span>;

			<span class="hljs-keyword">if</span> ( ! prev || prev !== <span class="hljs-keyword">this</span>.columns ) {
				<span class="hljs-keyword">this</span>.$el.closest( <span class="hljs-string">'.media-frame-content'</span> ).attr( <span class="hljs-string">'data-columns'</span>, <span class="hljs-keyword">this</span>.columns );
			}
		}
	},

	<span class="hljs-attr">initSortable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> collection = <span class="hljs-keyword">this</span>.collection;

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.options.sortable || ! $.fn.sortable ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.$el.sortable( _.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-100">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-100">&#182;</a>
              </div>
              <p>If the <code>collection</code> has a <code>comparator</code>, disable sorting.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			disabled: !! collection.comparator,</pre></div></div>
            
        </li>
        
        
        <li id="section-101">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-101">&#182;</a>
              </div>
              <p>Change the position of the attachment as soon as the
mouse pointer overlaps a thumbnail.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			tolerance: <span class="hljs-string">'pointer'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-102">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-102">&#182;</a>
              </div>
              <p>Record the initial <code>index</code> of the dragged model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			start: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event, ui </span>) </span>{
				ui.item.data(<span class="hljs-string">'sortableIndexStart'</span>, ui.item.index());
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-103">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-103">&#182;</a>
              </div>
              <p>Update the model’s index in the collection.
Do so silently, as the view is already accurate.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			update: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event, ui </span>) </span>{
				<span class="hljs-keyword">var</span> model = collection.at( ui.item.data(<span class="hljs-string">'sortableIndexStart'</span>) ),
					comparator = collection.comparator;</pre></div></div>
            
        </li>
        
        
        <li id="section-104">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-104">&#182;</a>
              </div>
              <p>Temporarily disable the comparator to prevent <code>add</code>
from re-sorting.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">delete</span> collection.comparator;</pre></div></div>
            
        </li>
        
        
        <li id="section-105">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-105">&#182;</a>
              </div>
              <p>Silently shift the model to its new index.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				collection.remove( model, {
					<span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span>
				});
				collection.add( model, {
					<span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span>,
					<span class="hljs-attr">at</span>:     ui.item.index()
				});</pre></div></div>
            
        </li>
        
        
        <li id="section-106">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-106">&#182;</a>
              </div>
              <p>Restore the comparator.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				collection.comparator = comparator;</pre></div></div>
            
        </li>
        
        
        <li id="section-107">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-107">&#182;</a>
              </div>
              <p>Fire the <code>reset</code> event to ensure other collections sync.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				collection.trigger( <span class="hljs-string">'reset'</span>, collection );</pre></div></div>
            
        </li>
        
        
        <li id="section-108">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-108">&#182;</a>
              </div>
              <p>If the collection is sorted by menu order,
update the menu order.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				collection.saveMenuOrder();
			}
		}, <span class="hljs-keyword">this</span>.options.sortable ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-109">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-109">&#182;</a>
              </div>
              <p>If the <code>orderby</code> property is changed on the <code>collection</code>,
check to see if we have a <code>comparator</code>. If so, disable sorting.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		collection.props.on( <span class="hljs-string">'change:orderby'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">this</span>.$el.sortable( <span class="hljs-string">'option'</span>, <span class="hljs-string">'disabled'</span>, !! collection.comparator );
		}, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.collection.props.on( <span class="hljs-string">'change:orderby'</span>, <span class="hljs-keyword">this</span>.refreshSortable, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.refreshSortable();
	},

	<span class="hljs-attr">refreshSortable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.options.sortable || ! $.fn.sortable ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-110">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-110">&#182;</a>
              </div>
              <p>If the <code>collection</code> has a <code>comparator</code>, disable sorting.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> collection = <span class="hljs-keyword">this</span>.collection,
			orderby = collection.props.get(<span class="hljs-string">'orderby'</span>),
			enabled = <span class="hljs-string">'menuOrder'</span> === orderby || ! collection.comparator;

		<span class="hljs-keyword">this</span>.$el.sortable( <span class="hljs-string">'option'</span>, <span class="hljs-string">'disabled'</span>, ! enabled );
	},

	<span class="hljs-comment">/**
	 * @param {wp.media.model.Attachment} attachment
	 * @returns {wp.media.View}
	 */</span>
	createAttachmentView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
		<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">new</span> <span class="hljs-keyword">this</span>.options.AttachmentView({
			<span class="hljs-attr">controller</span>:           <span class="hljs-keyword">this</span>.controller,
			<span class="hljs-attr">model</span>:                attachment,
			<span class="hljs-attr">collection</span>:           <span class="hljs-keyword">this</span>.collection,
			<span class="hljs-attr">selection</span>:            <span class="hljs-keyword">this</span>.options.selection
		});

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._viewsByCid[ attachment.cid ] = view;
	},

	<span class="hljs-attr">prepare</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-111">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-111">&#182;</a>
              </div>
              <p>Create all of the Attachment views, and replace
the list in a single DOM operation.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.collection.length ) {
			<span class="hljs-keyword">this</span>.views.set( <span class="hljs-keyword">this</span>.collection.map( <span class="hljs-keyword">this</span>.createAttachmentView, <span class="hljs-keyword">this</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-112">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-112">&#182;</a>
              </div>
              <p>If there are no elements, clear the views and load some.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.views.unset();
			<span class="hljs-keyword">this</span>.collection.more().done( <span class="hljs-keyword">this</span>.scroll );
		}
	},

	<span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-113">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-113">&#182;</a>
              </div>
              <p>Trigger the scroll event to check if we’re within the
threshold to query for additional attachments.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.scroll();
	},

	<span class="hljs-attr">scroll</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>,
			el = <span class="hljs-keyword">this</span>.options.scrollElement,
			scrollTop = el.scrollTop,
			toolbar;</pre></div></div>
            
        </li>
        
        
        <li id="section-114">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-114">&#182;</a>
              </div>
              <p>The scroll event occurs on the document, but the element
that should be checked is the document body.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( el === <span class="hljs-built_in">document</span> ) {
			el = <span class="hljs-built_in">document</span>.body;
			scrollTop = $(<span class="hljs-built_in">document</span>).scrollTop();
		}

		<span class="hljs-keyword">if</span> ( ! $(el).is(<span class="hljs-string">':visible'</span>) || ! <span class="hljs-keyword">this</span>.collection.hasMore() ) {
			<span class="hljs-keyword">return</span>;
		}

		toolbar = <span class="hljs-keyword">this</span>.views.parent.toolbar;</pre></div></div>
            
        </li>
        
        
        <li id="section-115">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-115">&#182;</a>
              </div>
              <p>Show the spinner only if we are close to the bottom.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( el.scrollHeight - ( scrollTop + el.clientHeight ) &lt; el.clientHeight / <span class="hljs-number">3</span> ) {
			toolbar.get(<span class="hljs-string">'spinner'</span>).show();
		}

		<span class="hljs-keyword">if</span> ( el.scrollHeight &lt; scrollTop + ( el.clientHeight * <span class="hljs-keyword">this</span>.options.refreshThreshold ) ) {
			<span class="hljs-keyword">this</span>.collection.more().done(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				view.scroll();
				toolbar.get(<span class="hljs-string">'spinner'</span>).hide();
			});
		}
	}
});

<span class="hljs-built_in">module</span>.exports = Attachments;

},{}],<span class="hljs-number">32</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.AttachmentsBrowser
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 *
 * @param {object}         [options]               The options hash passed to the view.
 * @param {boolean|string} [options.filters=false] Which filters to show in the browser's toolbar.
 *                                                 Accepts 'uploaded' and 'all'.
 * @param {boolean}        [options.search=true]   Whether to show the search interface in the
 *                                                 browser's toolbar.
 * @param {boolean}        [options.date=true]     Whether to show the date filter in the
 *                                                 browser's toolbar.
 * @param {boolean}        [options.display=false] Whether to show the attachments display settings
 *                                                 view in the sidebar.
 * @param {boolean|string} [options.sidebar=true]  Whether to create a sidebar for the browser.
 *                                                 Accepts true, false, and 'errors'.
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	mediaTrash = wp.media.view.settings.mediaTrash,
	l10n = wp.media.view.l10n,
	$ = jQuery,
	AttachmentsBrowser;

AttachmentsBrowser = View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'div'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'attachments-browser'</span>,

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">filters</span>: <span class="hljs-literal">false</span>,
			<span class="hljs-attr">search</span>:  <span class="hljs-literal">true</span>,
			<span class="hljs-attr">date</span>:    <span class="hljs-literal">true</span>,
			<span class="hljs-attr">display</span>: <span class="hljs-literal">false</span>,
			<span class="hljs-attr">sidebar</span>: <span class="hljs-literal">true</span>,
			<span class="hljs-attr">AttachmentView</span>: wp.media.view.Attachment.Library
		});

		<span class="hljs-keyword">this</span>.controller.on( <span class="hljs-string">'toggle:upload:attachment'</span>, <span class="hljs-keyword">this</span>.toggleUploader, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.controller.on( <span class="hljs-string">'edit:selection'</span>, <span class="hljs-keyword">this</span>.editSelection );</pre></div></div>
            
        </li>
        
        
        <li id="section-116">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-116">&#182;</a>
              </div>
              <p>In the Media Library, the sidebar is used to display errors before the attachments grid.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.sidebar &amp;&amp; <span class="hljs-string">'errors'</span> === <span class="hljs-keyword">this</span>.options.sidebar ) {
			<span class="hljs-keyword">this</span>.createSidebar();
		}

		<span class="hljs-comment">/*
		 * For accessibility reasons, place the Inline Uploader before other sections.
		 * This way, in the Media Library, it's right after the Add New button, see ticket #37188.
		 */</span>
		<span class="hljs-keyword">this</span>.createUploader();

		<span class="hljs-comment">/*
		 * Create a multi-purpose toolbar. Used as main toolbar in the Media Library
		 * and also for other things, for example the "Drag and drop to reorder" and
		 * "Suggested dimensions" info in the media modal.
		 */</span>
		<span class="hljs-keyword">this</span>.createToolbar();</pre></div></div>
            
        </li>
        
        
        <li id="section-117">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-117">&#182;</a>
              </div>
              <p>Create the list of attachments.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.createAttachments();</pre></div></div>
            
        </li>
        
        
        <li id="section-118">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-118">&#182;</a>
              </div>
              <p>For accessibility reasons, place the normal sidebar after the attachments, see ticket #36909.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.sidebar &amp;&amp; <span class="hljs-string">'errors'</span> !== <span class="hljs-keyword">this</span>.options.sidebar ) {
			<span class="hljs-keyword">this</span>.createSidebar();
		}

		<span class="hljs-keyword">this</span>.updateContent();

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.options.sidebar || <span class="hljs-string">'errors'</span> === <span class="hljs-keyword">this</span>.options.sidebar ) {
			<span class="hljs-keyword">this</span>.$el.addClass( <span class="hljs-string">'hide-sidebar'</span> );

			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'errors'</span> === <span class="hljs-keyword">this</span>.options.sidebar ) {
				<span class="hljs-keyword">this</span>.$el.addClass( <span class="hljs-string">'sidebar-for-errors'</span> );
			}
		}

		<span class="hljs-keyword">this</span>.collection.on( <span class="hljs-string">'add remove reset'</span>, <span class="hljs-keyword">this</span>.updateContent, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-attr">editSelection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> modal </span>) </span>{
		modal.$( <span class="hljs-string">'.media-button-backToLibrary'</span> ).focus();
	},

	<span class="hljs-comment">/**
	 * @returns {wp.media.view.AttachmentsBrowser} Returns itself to allow chaining
	 */</span>
	dispose: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.options.selection.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
		View.prototype.dispose.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">createToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> LibraryViewSwitcher, Filters, toolbarOptions;

		toolbarOptions = {
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller
		};

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.isModeActive( <span class="hljs-string">'grid'</span> ) ) {
			toolbarOptions.className = <span class="hljs-string">'media-toolbar wp-filter'</span>;
		}

		<span class="hljs-comment">/**
		* @member {wp.media.view.Toolbar}
		*/</span>
		<span class="hljs-keyword">this</span>.toolbar = <span class="hljs-keyword">new</span> wp.media.view.Toolbar( toolbarOptions );

		<span class="hljs-keyword">this</span>.views.add( <span class="hljs-keyword">this</span>.toolbar );

		<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'spinner'</span>, <span class="hljs-keyword">new</span> wp.media.view.Spinner({
			<span class="hljs-attr">priority</span>: <span class="hljs-number">-60</span>
		}) );

		<span class="hljs-keyword">if</span> ( <span class="hljs-number">-1</span> !== $.inArray( <span class="hljs-keyword">this</span>.options.filters, [ <span class="hljs-string">'uploaded'</span>, <span class="hljs-string">'all'</span> ] ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-119">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-119">&#182;</a>
              </div>
              <p>“Filters” will return a <select>, need to render
screen reader text before</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'filtersLabel'</span>, <span class="hljs-keyword">new</span> wp.media.view.Label({
				<span class="hljs-attr">value</span>: l10n.filterByType,
				<span class="hljs-attr">attributes</span>: {
					<span class="hljs-string">'for'</span>:  <span class="hljs-string">'media-attachment-filters'</span>
				},
				<span class="hljs-attr">priority</span>:   <span class="hljs-number">-80</span>
			}).render() );

			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'uploaded'</span> === <span class="hljs-keyword">this</span>.options.filters ) {
				<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'filters'</span>, <span class="hljs-keyword">new</span> wp.media.view.AttachmentFilters.Uploaded({
					<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
					<span class="hljs-attr">model</span>:      <span class="hljs-keyword">this</span>.collection.props,
					<span class="hljs-attr">priority</span>:   <span class="hljs-number">-80</span>
				}).render() );
			} <span class="hljs-keyword">else</span> {
				Filters = <span class="hljs-keyword">new</span> wp.media.view.AttachmentFilters.All({
					<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
					<span class="hljs-attr">model</span>:      <span class="hljs-keyword">this</span>.collection.props,
					<span class="hljs-attr">priority</span>:   <span class="hljs-number">-80</span>
				});

				<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'filters'</span>, Filters.render() );
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-120">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-120">&#182;</a>
              </div>
              <p>Feels odd to bring the global media library switcher into the Attachment
browser view. Is this a use case for doAction( ‘add:toolbar-items:attachments-browser’, this.toolbar );
which the controller can tap into and add this view?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.isModeActive( <span class="hljs-string">'grid'</span> ) ) {
			LibraryViewSwitcher = View.extend({
				<span class="hljs-attr">className</span>: <span class="hljs-string">'view-switch media-grid-view-switch'</span>,
				<span class="hljs-attr">template</span>: wp.template( <span class="hljs-string">'media-library-view-switcher'</span>)
			});

			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'libraryViewSwitcher'</span>, <span class="hljs-keyword">new</span> LibraryViewSwitcher({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">-90</span>
			}).render() );</pre></div></div>
            
        </li>
        
        
        <li id="section-121">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-121">&#182;</a>
              </div>
              <p>DateFilter is a <select>, screen reader text needs to be rendered before</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'dateFilterLabel'</span>, <span class="hljs-keyword">new</span> wp.media.view.Label({
				<span class="hljs-attr">value</span>: l10n.filterByDate,
				<span class="hljs-attr">attributes</span>: {
					<span class="hljs-string">'for'</span>: <span class="hljs-string">'media-attachment-date-filters'</span>
				},
				<span class="hljs-attr">priority</span>: <span class="hljs-number">-75</span>
			}).render() );
			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'dateFilter'</span>, <span class="hljs-keyword">new</span> wp.media.view.DateFilter({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
				<span class="hljs-attr">model</span>:      <span class="hljs-keyword">this</span>.collection.props,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">-75</span>
			}).render() );</pre></div></div>
            
        </li>
        
        
        <li id="section-122">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-122">&#182;</a>
              </div>
              <p>BulkSelection is a <div> with subviews, including screen reader text</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'selectModeToggleButton'</span>, <span class="hljs-keyword">new</span> wp.media.view.SelectModeToggleButton({
				<span class="hljs-attr">text</span>: l10n.bulkSelect,
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">-70</span>
			}).render() );

			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'deleteSelectedButton'</span>, <span class="hljs-keyword">new</span> wp.media.view.DeleteSelectedButton({
				<span class="hljs-attr">filters</span>: Filters,
				<span class="hljs-attr">style</span>: <span class="hljs-string">'primary'</span>,
				<span class="hljs-attr">disabled</span>: <span class="hljs-literal">true</span>,
				<span class="hljs-attr">text</span>: mediaTrash ? l10n.trashSelected : l10n.deleteSelected,
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">-60</span>,
				<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					<span class="hljs-keyword">var</span> changed = [], removed = [],
						selection = <span class="hljs-keyword">this</span>.controller.state().get( <span class="hljs-string">'selection'</span> ),
						library = <span class="hljs-keyword">this</span>.controller.state().get( <span class="hljs-string">'library'</span> );

					<span class="hljs-keyword">if</span> ( ! selection.length ) {
						<span class="hljs-keyword">return</span>;
					}

					<span class="hljs-keyword">if</span> ( ! mediaTrash &amp;&amp; ! <span class="hljs-built_in">window</span>.confirm( l10n.warnBulkDelete ) ) {
						<span class="hljs-keyword">return</span>;
					}

					<span class="hljs-keyword">if</span> ( mediaTrash &amp;&amp;
						<span class="hljs-string">'trash'</span> !== selection.at( <span class="hljs-number">0</span> ).get( <span class="hljs-string">'status'</span> ) &amp;&amp;
						! <span class="hljs-built_in">window</span>.confirm( l10n.warnBulkTrash ) ) {

						<span class="hljs-keyword">return</span>;
					}

					selection.each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model </span>) </span>{
						<span class="hljs-keyword">if</span> ( ! model.get( <span class="hljs-string">'nonces'</span> )[<span class="hljs-string">'delete'</span>] ) {
							removed.push( model );
							<span class="hljs-keyword">return</span>;
						}

						<span class="hljs-keyword">if</span> ( mediaTrash &amp;&amp; <span class="hljs-string">'trash'</span> === model.get( <span class="hljs-string">'status'</span> ) ) {
							model.set( <span class="hljs-string">'status'</span>, <span class="hljs-string">'inherit'</span> );
							changed.push( model.save() );
							removed.push( model );
						} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( mediaTrash ) {
							model.set( <span class="hljs-string">'status'</span>, <span class="hljs-string">'trash'</span> );
							changed.push( model.save() );
							removed.push( model );
						} <span class="hljs-keyword">else</span> {
							model.destroy({<span class="hljs-attr">wait</span>: <span class="hljs-literal">true</span>});
						}
					} );

					<span class="hljs-keyword">if</span> ( changed.length ) {
						selection.remove( removed );

						$.when.apply( <span class="hljs-literal">null</span>, changed ).then( _.bind( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
							library._requery( <span class="hljs-literal">true</span> );
							<span class="hljs-keyword">this</span>.controller.trigger( <span class="hljs-string">'selection:action:done'</span> );
						}, <span class="hljs-keyword">this</span> ) );
					} <span class="hljs-keyword">else</span> {
						<span class="hljs-keyword">this</span>.controller.trigger( <span class="hljs-string">'selection:action:done'</span> );
					}
				}
			}).render() );

			<span class="hljs-keyword">if</span> ( mediaTrash ) {
				<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'deleteSelectedPermanentlyButton'</span>, <span class="hljs-keyword">new</span> wp.media.view.DeleteSelectedPermanentlyButton({
					<span class="hljs-attr">filters</span>: Filters,
					<span class="hljs-attr">style</span>: <span class="hljs-string">'primary'</span>,
					<span class="hljs-attr">disabled</span>: <span class="hljs-literal">true</span>,
					<span class="hljs-attr">text</span>: l10n.deleteSelected,
					<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">-55</span>,
					<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> removed = [],
							destroy = [],
							selection = <span class="hljs-keyword">this</span>.controller.state().get( <span class="hljs-string">'selection'</span> );

						<span class="hljs-keyword">if</span> ( ! selection.length || ! <span class="hljs-built_in">window</span>.confirm( l10n.warnBulkDelete ) ) {
							<span class="hljs-keyword">return</span>;
						}

						selection.each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model </span>) </span>{
							<span class="hljs-keyword">if</span> ( ! model.get( <span class="hljs-string">'nonces'</span> )[<span class="hljs-string">'delete'</span>] ) {
								removed.push( model );
								<span class="hljs-keyword">return</span>;
							}

							destroy.push( model );
						} );

						<span class="hljs-keyword">if</span> ( removed.length ) {
							selection.remove( removed );
						}

						<span class="hljs-keyword">if</span> ( destroy.length ) {
							$.when.apply( <span class="hljs-literal">null</span>, destroy.map( <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{
								<span class="hljs-keyword">return</span> item.destroy();
							} ) ).then( _.bind( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
								<span class="hljs-keyword">this</span>.controller.trigger( <span class="hljs-string">'selection:action:done'</span> );
							}, <span class="hljs-keyword">this</span> ) );
						}
					}
				}).render() );
			}

		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.date ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-123">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-123">&#182;</a>
              </div>
              <p>DateFilter is a <select>, screen reader text needs to be rendered before</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'dateFilterLabel'</span>, <span class="hljs-keyword">new</span> wp.media.view.Label({
				<span class="hljs-attr">value</span>: l10n.filterByDate,
				<span class="hljs-attr">attributes</span>: {
					<span class="hljs-string">'for'</span>: <span class="hljs-string">'media-attachment-date-filters'</span>
				},
				<span class="hljs-attr">priority</span>: <span class="hljs-number">-75</span>
			}).render() );
			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'dateFilter'</span>, <span class="hljs-keyword">new</span> wp.media.view.DateFilter({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
				<span class="hljs-attr">model</span>:      <span class="hljs-keyword">this</span>.collection.props,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">-75</span>
			}).render() );
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.search ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-124">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-124">&#182;</a>
              </div>
              <p>Search is an input, screen reader text needs to be rendered before</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'searchLabel'</span>, <span class="hljs-keyword">new</span> wp.media.view.Label({
				<span class="hljs-attr">value</span>: l10n.searchMediaLabel,
				<span class="hljs-attr">attributes</span>: {
					<span class="hljs-string">'for'</span>: <span class="hljs-string">'media-search-input'</span>
				},
				<span class="hljs-attr">priority</span>:   <span class="hljs-number">60</span>
			}).render() );
			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'search'</span>, <span class="hljs-keyword">new</span> wp.media.view.Search({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
				<span class="hljs-attr">model</span>:      <span class="hljs-keyword">this</span>.collection.props,
				<span class="hljs-attr">priority</span>:   <span class="hljs-number">60</span>
			}).render() );
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.dragInfo ) {
			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'dragInfo'</span>, <span class="hljs-keyword">new</span> View({
				<span class="hljs-attr">el</span>: $( <span class="hljs-string">'&lt;div class="instructions"&gt;'</span> + l10n.dragInfo + <span class="hljs-string">'&lt;/div&gt;'</span> )[<span class="hljs-number">0</span>],
				<span class="hljs-attr">priority</span>: <span class="hljs-number">-40</span>
			}) );
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.suggestedWidth &amp;&amp; <span class="hljs-keyword">this</span>.options.suggestedHeight ) {
			<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-string">'suggestedDimensions'</span>, <span class="hljs-keyword">new</span> View({
				<span class="hljs-attr">el</span>: $( <span class="hljs-string">'&lt;div class="instructions"&gt;'</span> + l10n.suggestedDimensions.replace( <span class="hljs-string">'%1$s'</span>, <span class="hljs-keyword">this</span>.options.suggestedWidth ).replace( <span class="hljs-string">'%2$s'</span>, <span class="hljs-keyword">this</span>.options.suggestedHeight ) + <span class="hljs-string">'&lt;/div&gt;'</span> )[<span class="hljs-number">0</span>],
				<span class="hljs-attr">priority</span>: <span class="hljs-number">-40</span>
			}) );
		}
	},

	<span class="hljs-attr">updateContent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>,
			noItemsView;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.isModeActive( <span class="hljs-string">'grid'</span> ) ) {
			noItemsView = view.attachmentsNoResults;
		} <span class="hljs-keyword">else</span> {
			noItemsView = view.uploader;
		}

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.collection.length ) {
			<span class="hljs-keyword">this</span>.toolbar.get( <span class="hljs-string">'spinner'</span> ).show();
			<span class="hljs-keyword">this</span>.dfd = <span class="hljs-keyword">this</span>.collection.more().done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">if</span> ( ! view.collection.length ) {
					noItemsView.$el.removeClass( <span class="hljs-string">'hidden'</span> );
				} <span class="hljs-keyword">else</span> {
					noItemsView.$el.addClass( <span class="hljs-string">'hidden'</span> );
				}
				view.toolbar.get( <span class="hljs-string">'spinner'</span> ).hide();
			} );
		} <span class="hljs-keyword">else</span> {
			noItemsView.$el.addClass( <span class="hljs-string">'hidden'</span> );
			view.toolbar.get( <span class="hljs-string">'spinner'</span> ).hide();
		}
	},

	<span class="hljs-attr">createUploader</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.uploader = <span class="hljs-keyword">new</span> wp.media.view.UploaderInline({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
			<span class="hljs-attr">status</span>:     <span class="hljs-literal">false</span>,
			<span class="hljs-attr">message</span>:    <span class="hljs-keyword">this</span>.controller.isModeActive( <span class="hljs-string">'grid'</span> ) ? <span class="hljs-string">''</span> : l10n.noItemsFound,
			<span class="hljs-attr">canClose</span>:   <span class="hljs-keyword">this</span>.controller.isModeActive( <span class="hljs-string">'grid'</span> )
		});

		<span class="hljs-keyword">this</span>.uploader.$el.addClass( <span class="hljs-string">'hidden'</span> );
		<span class="hljs-keyword">this</span>.views.add( <span class="hljs-keyword">this</span>.uploader );
	},

	<span class="hljs-attr">toggleUploader</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.uploader.$el.hasClass( <span class="hljs-string">'hidden'</span> ) ) {
			<span class="hljs-keyword">this</span>.uploader.show();
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.uploader.hide();
		}
	},

	<span class="hljs-attr">createAttachments</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.attachments = <span class="hljs-keyword">new</span> wp.media.view.Attachments({
			<span class="hljs-attr">controller</span>:           <span class="hljs-keyword">this</span>.controller,
			<span class="hljs-attr">collection</span>:           <span class="hljs-keyword">this</span>.collection,
			<span class="hljs-attr">selection</span>:            <span class="hljs-keyword">this</span>.options.selection,
			<span class="hljs-attr">model</span>:                <span class="hljs-keyword">this</span>.model,
			<span class="hljs-attr">sortable</span>:             <span class="hljs-keyword">this</span>.options.sortable,
			<span class="hljs-attr">scrollElement</span>:        <span class="hljs-keyword">this</span>.options.scrollElement,
			<span class="hljs-attr">idealColumnWidth</span>:     <span class="hljs-keyword">this</span>.options.idealColumnWidth,</pre></div></div>
            
        </li>
        
        
        <li id="section-125">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-125">&#182;</a>
              </div>
              <p>The single <code>Attachment</code> view to be used in the <code>Attachments</code> view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			AttachmentView: <span class="hljs-keyword">this</span>.options.AttachmentView
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-126">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-126">&#182;</a>
              </div>
              <p>Add keydown listener to the instance of the Attachments view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.controller.on( <span class="hljs-string">'attachment:keydown:arrow'</span>,     _.bind( <span class="hljs-keyword">this</span>.attachments.arrowEvent, <span class="hljs-keyword">this</span>.attachments ) );
		<span class="hljs-keyword">this</span>.controller.on( <span class="hljs-string">'attachment:details:shift-tab'</span>, _.bind( <span class="hljs-keyword">this</span>.attachments.restoreFocus, <span class="hljs-keyword">this</span>.attachments ) );

		<span class="hljs-keyword">this</span>.views.add( <span class="hljs-keyword">this</span>.attachments );


		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.isModeActive( <span class="hljs-string">'grid'</span> ) ) {
			<span class="hljs-keyword">this</span>.attachmentsNoResults = <span class="hljs-keyword">new</span> View({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
				<span class="hljs-attr">tagName</span>: <span class="hljs-string">'p'</span>
			});

			<span class="hljs-keyword">this</span>.attachmentsNoResults.$el.addClass( <span class="hljs-string">'hidden no-media'</span> );
			<span class="hljs-keyword">this</span>.attachmentsNoResults.$el.html( l10n.noMedia );

			<span class="hljs-keyword">this</span>.views.add( <span class="hljs-keyword">this</span>.attachmentsNoResults );
		}
	},

	<span class="hljs-attr">createSidebar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
			selection = options.selection,
			sidebar = <span class="hljs-keyword">this</span>.sidebar = <span class="hljs-keyword">new</span> wp.media.view.Sidebar({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller
			});

		<span class="hljs-keyword">this</span>.views.add( sidebar );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.uploader ) {
			sidebar.set( <span class="hljs-string">'uploads'</span>, <span class="hljs-keyword">new</span> wp.media.view.UploaderStatus({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
				<span class="hljs-attr">priority</span>:   <span class="hljs-number">40</span>
			}) );
		}

		selection.on( <span class="hljs-string">'selection:single'</span>, <span class="hljs-keyword">this</span>.createSingle, <span class="hljs-keyword">this</span> );
		selection.on( <span class="hljs-string">'selection:unsingle'</span>, <span class="hljs-keyword">this</span>.disposeSingle, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">if</span> ( selection.single() ) {
			<span class="hljs-keyword">this</span>.createSingle();
		}
	},

	<span class="hljs-attr">createSingle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> sidebar = <span class="hljs-keyword">this</span>.sidebar,
			single = <span class="hljs-keyword">this</span>.options.selection.single();

		sidebar.set( <span class="hljs-string">'details'</span>, <span class="hljs-keyword">new</span> wp.media.view.Attachment.Details({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
			<span class="hljs-attr">model</span>:      single,
			<span class="hljs-attr">priority</span>:   <span class="hljs-number">80</span>
		}) );

		sidebar.set( <span class="hljs-string">'compat'</span>, <span class="hljs-keyword">new</span> wp.media.view.AttachmentCompat({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
			<span class="hljs-attr">model</span>:      single,
			<span class="hljs-attr">priority</span>:   <span class="hljs-number">120</span>
		}) );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.display ) {
			sidebar.set( <span class="hljs-string">'display'</span>, <span class="hljs-keyword">new</span> wp.media.view.Settings.AttachmentDisplay({
				<span class="hljs-attr">controller</span>:   <span class="hljs-keyword">this</span>.controller,
				<span class="hljs-attr">model</span>:        <span class="hljs-keyword">this</span>.model.display( single ),
				<span class="hljs-attr">attachment</span>:   single,
				<span class="hljs-attr">priority</span>:     <span class="hljs-number">160</span>,
				<span class="hljs-attr">userSettings</span>: <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'displayUserSettings'</span>)
			}) );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-127">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-127">&#182;</a>
              </div>
              <p>Show the sidebar on mobile</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.model.id === <span class="hljs-string">'insert'</span> ) {
			sidebar.$el.addClass( <span class="hljs-string">'visible'</span> );
		}
	},

	<span class="hljs-attr">disposeSingle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> sidebar = <span class="hljs-keyword">this</span>.sidebar;
		sidebar.unset(<span class="hljs-string">'details'</span>);
		sidebar.unset(<span class="hljs-string">'compat'</span>);
		sidebar.unset(<span class="hljs-string">'display'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-128">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-128">&#182;</a>
              </div>
              <p>Hide the sidebar on mobile</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		sidebar.$el.removeClass( <span class="hljs-string">'visible'</span> );
	}
});

<span class="hljs-built_in">module</span>.exports = AttachmentsBrowser;

},{}],<span class="hljs-number">33</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Attachments.Selection
 *
 * @class
 * @augments wp.media.view.Attachments
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Attachments = wp.media.view.Attachments,
	Selection;

Selection = Attachments.extend({
	<span class="hljs-attr">events</span>: {},
	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">sortable</span>:   <span class="hljs-literal">false</span>,
			<span class="hljs-attr">resize</span>:     <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-129">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-129">&#182;</a>
              </div>
              <p>The single <code>Attachment</code> view to be used in the <code>Attachments</code> view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			AttachmentView: wp.media.view.Attachment.Selection
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-130">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-130">&#182;</a>
              </div>
              <p>Call ‘initialize’ directly on the parent class.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">return</span> Attachments.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	}
});

<span class="hljs-built_in">module</span>.exports = Selection;

},{}],<span class="hljs-number">34</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.ButtonGroup
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> $ = Backbone.$,
	ButtonGroup;

ButtonGroup = wp.media.View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'div'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'button-group button-large media-button-group'</span>,

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-comment">/**
		 * @member {wp.media.view.Button[]}
		 */</span>
		<span class="hljs-keyword">this</span>.buttons = _.map( <span class="hljs-keyword">this</span>.options.buttons || [], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> button </span>) </span>{
			<span class="hljs-keyword">if</span> ( button <span class="hljs-keyword">instanceof</span> Backbone.View ) {
				<span class="hljs-keyword">return</span> button;
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> wp.media.view.Button( button ).render();
			}
		});

		<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.options.buttons;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.classes ) {
			<span class="hljs-keyword">this</span>.$el.addClass( <span class="hljs-keyword">this</span>.options.classes );
		}
	},

	<span class="hljs-comment">/**
	 * @returns {wp.media.view.ButtonGroup}
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$el.html( $( _.pluck( <span class="hljs-keyword">this</span>.buttons, <span class="hljs-string">'el'</span> ) ).detach() );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	}
});

<span class="hljs-built_in">module</span>.exports = ButtonGroup;

},{}],<span class="hljs-number">35</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Button
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Button = wp.media.View.extend({
	<span class="hljs-attr">tagName</span>:    <span class="hljs-string">'button'</span>,
	<span class="hljs-attr">className</span>:  <span class="hljs-string">'media-button'</span>,
	<span class="hljs-attr">attributes</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'button'</span> },

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'click'</span>: <span class="hljs-string">'click'</span>
	},

	<span class="hljs-attr">defaults</span>: {
		<span class="hljs-attr">text</span>:     <span class="hljs-string">''</span>,
		<span class="hljs-attr">style</span>:    <span class="hljs-string">''</span>,
		<span class="hljs-attr">size</span>:     <span class="hljs-string">'large'</span>,
		<span class="hljs-attr">disabled</span>: <span class="hljs-literal">false</span>
	},

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-comment">/**
		 * Create a model with the provided `defaults`.
		 *
		 * @member {Backbone.Model}
		 */</span>
		<span class="hljs-keyword">this</span>.model = <span class="hljs-keyword">new</span> Backbone.Model( <span class="hljs-keyword">this</span>.defaults );</pre></div></div>
            
        </li>
        
        
        <li id="section-131">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-131">&#182;</a>
              </div>
              <p>If any of the <code>options</code> have a key from <code>defaults</code>, apply its
value to the <code>model</code> and remove it from the `options object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_.each( <span class="hljs-keyword">this</span>.defaults, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> def, key </span>) </span>{
			<span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>.options[ key ];
			<span class="hljs-keyword">if</span> ( _.isUndefined( value ) ) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">this</span>.model.set( key, value );
			<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.options[ key ];
		}, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>.render );
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.Button} Returns itself to allow chaining
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> classes = [ <span class="hljs-string">'button'</span>, <span class="hljs-keyword">this</span>.className ],
			model = <span class="hljs-keyword">this</span>.model.toJSON();

		<span class="hljs-keyword">if</span> ( model.style ) {
			classes.push( <span class="hljs-string">'button-'</span> + model.style );
		}

		<span class="hljs-keyword">if</span> ( model.size ) {
			classes.push( <span class="hljs-string">'button-'</span> + model.size );
		}

		classes = _.uniq( classes.concat( <span class="hljs-keyword">this</span>.options.classes ) );
		<span class="hljs-keyword">this</span>.el.className = classes.join(<span class="hljs-string">' '</span>);

		<span class="hljs-keyword">this</span>.$el.attr( <span class="hljs-string">'disabled'</span>, model.disabled );
		<span class="hljs-keyword">this</span>.$el.text( <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'text'</span>) );

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	click: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'#'</span> === <span class="hljs-keyword">this</span>.attributes.href ) {
			event.preventDefault();
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.click &amp;&amp; ! <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'disabled'</span>) ) {
			<span class="hljs-keyword">this</span>.options.click.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		}
	}
});

<span class="hljs-built_in">module</span>.exports = Button;

},{}],<span class="hljs-number">36</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Cropper
 *
 * Uses the imgAreaSelect plugin to allow a user to crop an image.
 *
 * Takes imgAreaSelect options from
 * wp.customize.HeaderControl.calculateImageSelectOptions via
 * wp.customize.HeaderControl.openMM.
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	UploaderStatus = wp.media.view.UploaderStatus,
	l10n = wp.media.view.l10n,
	$ = jQuery,
	Cropper;

Cropper = View.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'crop-content'</span>,
	<span class="hljs-attr">template</span>: wp.template(<span class="hljs-string">'crop-content'</span>),
	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		_.bindAll(<span class="hljs-keyword">this</span>, <span class="hljs-string">'onImageLoad'</span>);
	},
	<span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.controller.frame.on(<span class="hljs-string">'content:error:crop'</span>, <span class="hljs-keyword">this</span>.onError, <span class="hljs-keyword">this</span>);
		<span class="hljs-keyword">this</span>.$image = <span class="hljs-keyword">this</span>.$el.find(<span class="hljs-string">'.crop-image'</span>);
		<span class="hljs-keyword">this</span>.$image.on(<span class="hljs-string">'load'</span>, <span class="hljs-keyword">this</span>.onImageLoad);
		$(<span class="hljs-built_in">window</span>).on(<span class="hljs-string">'resize.cropper'</span>, _.debounce(<span class="hljs-keyword">this</span>.onImageLoad, <span class="hljs-number">250</span>));
	},
	<span class="hljs-attr">remove</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		$(<span class="hljs-built_in">window</span>).off(<span class="hljs-string">'resize.cropper'</span>);
		<span class="hljs-keyword">this</span>.$el.remove();
		<span class="hljs-keyword">this</span>.$el.off();
		View.prototype.remove.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
	},
	<span class="hljs-attr">prepare</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> {
			<span class="hljs-attr">title</span>: l10n.cropYourImage,
			<span class="hljs-attr">url</span>: <span class="hljs-keyword">this</span>.options.attachment.get(<span class="hljs-string">'url'</span>)
		};
	},
	<span class="hljs-attr">onImageLoad</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> imgOptions = <span class="hljs-keyword">this</span>.controller.get(<span class="hljs-string">'imgSelectOptions'</span>);
		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> imgOptions === <span class="hljs-string">'function'</span>) {
			imgOptions = imgOptions(<span class="hljs-keyword">this</span>.options.attachment, <span class="hljs-keyword">this</span>.controller);
		}

		imgOptions = _.extend(imgOptions, {<span class="hljs-attr">parent</span>: <span class="hljs-keyword">this</span>.$el});
		<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'image-loaded'</span>);
		<span class="hljs-keyword">this</span>.controller.imgSelect = <span class="hljs-keyword">this</span>.$image.imgAreaSelect(imgOptions);
	},
	<span class="hljs-attr">onError</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> filename = <span class="hljs-keyword">this</span>.options.attachment.get(<span class="hljs-string">'filename'</span>);

		<span class="hljs-keyword">this</span>.views.add( <span class="hljs-string">'.upload-errors'</span>, <span class="hljs-keyword">new</span> wp.media.view.UploaderStatusError({
			<span class="hljs-attr">filename</span>: UploaderStatus.prototype.filename(filename),
			<span class="hljs-attr">message</span>: <span class="hljs-built_in">window</span>._wpMediaViewsL10n.cropError
		}), { <span class="hljs-attr">at</span>: <span class="hljs-number">0</span> });
	}
});

<span class="hljs-built_in">module</span>.exports = Cropper;

},{}],<span class="hljs-number">37</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.EditImage
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	EditImage;

EditImage = View.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'image-editor'</span>,
	<span class="hljs-attr">template</span>: wp.template(<span class="hljs-string">'image-editor'</span>),

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">this</span>.editor = <span class="hljs-built_in">window</span>.imageEdit;
		<span class="hljs-keyword">this</span>.controller = options.controller;
		View.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-attr">prepare</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.model.toJSON();
	},

	<span class="hljs-attr">loadEditor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> dfd = <span class="hljs-keyword">this</span>.editor.open( <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'id'</span>), <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'nonces'</span>).edit, <span class="hljs-keyword">this</span> );
		dfd.done( _.bind( <span class="hljs-keyword">this</span>.focus, <span class="hljs-keyword">this</span> ) );
	},

	<span class="hljs-attr">focus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.imgedit-submit .button'</span> ).eq( <span class="hljs-number">0</span> ).focus();
	},

	<span class="hljs-attr">back</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> lastState = <span class="hljs-keyword">this</span>.controller.lastState();
		<span class="hljs-keyword">this</span>.controller.setState( lastState );
	},

	<span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.model.fetch();
	},

	<span class="hljs-attr">save</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> lastState = <span class="hljs-keyword">this</span>.controller.lastState();

		<span class="hljs-keyword">this</span>.model.fetch().done( _.bind( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">this</span>.controller.setState( lastState );
		}, <span class="hljs-keyword">this</span> ) );
	}

});

<span class="hljs-built_in">module</span>.exports = EditImage;

},{}],<span class="hljs-number">38</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Embed
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Embed = wp.media.View.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'media-embed'</span>,

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-comment">/**
		 * @member {wp.media.view.EmbedUrl}
		 */</span>
		<span class="hljs-keyword">this</span>.url = <span class="hljs-keyword">new</span> wp.media.view.EmbedUrl({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
			<span class="hljs-attr">model</span>:      <span class="hljs-keyword">this</span>.model.props
		}).render();

		<span class="hljs-keyword">this</span>.views.set([ <span class="hljs-keyword">this</span>.url ]);
		<span class="hljs-keyword">this</span>.refresh();
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:type'</span>, <span class="hljs-keyword">this</span>.refresh );
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:loading'</span>, <span class="hljs-keyword">this</span>.loading );
	},

	<span class="hljs-comment">/**
	 * @param {Object} view
	 */</span>
	settings: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._settings ) {
			<span class="hljs-keyword">this</span>._settings.remove();
		}
		<span class="hljs-keyword">this</span>._settings = view;
		<span class="hljs-keyword">this</span>.views.add( view );
	},

	<span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> type = <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'type'</span>),
			<span class="hljs-keyword">constructor</span>;

		if ( 'image' === type ) {
			<span class="hljs-keyword">constructor</span> = wp.media.view.EmbedImage;
		} else if ( 'link' === type ) {
			<span class="hljs-keyword">constructor</span> = wp.media.view.EmbedLink;
		} else {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.settings( <span class="hljs-keyword">new</span> <span class="hljs-keyword">constructor</span>({
			controller: <span class="hljs-keyword">this</span>.controller,
			<span class="hljs-attr">model</span>:      <span class="hljs-keyword">this</span>.model.props,
			<span class="hljs-attr">priority</span>:   <span class="hljs-number">40</span>
		}) );
	},

	<span class="hljs-attr">loading</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$el.toggleClass( <span class="hljs-string">'embed-loading'</span>, <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'loading'</span>) );
	}
});

<span class="hljs-built_in">module</span>.exports = Embed;

},{}],<span class="hljs-number">39</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.EmbedImage
 *
 * @class
 * @augments wp.media.view.Settings.AttachmentDisplay
 * @augments wp.media.view.Settings
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> AttachmentDisplay = wp.media.view.Settings.AttachmentDisplay,
	EmbedImage;

EmbedImage = AttachmentDisplay.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'embed-media-settings'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'embed-image-settings'</span>),

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-comment">/**
		 * Call `initialize` directly on parent class with passed arguments
		 */</span>
		AttachmentDisplay.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:url'</span>, <span class="hljs-keyword">this</span>.updateImage );
	},

	<span class="hljs-attr">updateImage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$(<span class="hljs-string">'img'</span>).attr( <span class="hljs-string">'src'</span>, <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'url'</span>) );
	}
});

<span class="hljs-built_in">module</span>.exports = EmbedImage;

},{}],<span class="hljs-number">40</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.EmbedLink
 *
 * @class
 * @augments wp.media.view.Settings
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> $ = jQuery,
	EmbedLink;

EmbedLink = wp.media.view.Settings.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'embed-link-settings'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'embed-link-settings'</span>),

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:url'</span>, <span class="hljs-keyword">this</span>.updateoEmbed );
	},

	<span class="hljs-attr">updateoEmbed</span>: _.debounce( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> url = <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'url'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-132">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-132">&#182;</a>
              </div>
              <p>clear out previous results</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.$(<span class="hljs-string">'.embed-container'</span>).hide().find(<span class="hljs-string">'.embed-preview'</span>).empty();
		<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.setting'</span> ).hide();</pre></div></div>
            
        </li>
        
        
        <li id="section-133">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-133">&#182;</a>
              </div>
              <p>only proceed with embed if the field contains more than 11 characters
Example: <a href="http://a.io">http://a.io</a> is 11 chars</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( url &amp;&amp; ( url.length &lt; <span class="hljs-number">11</span> || ! url.match(<span class="hljs-regexp">/^http(s)?:\/\//</span>) ) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.fetch();
	}, wp.media.controller.Embed.sensitivity ),

	<span class="hljs-attr">fetch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-134">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-134">&#182;</a>
              </div>
              <p>check if they haven’t typed in 500 ms</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $(<span class="hljs-string">'#embed-url-field'</span>).val() !== <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'url'</span>) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.dfd &amp;&amp; <span class="hljs-string">'pending'</span> === <span class="hljs-keyword">this</span>.dfd.state() ) {
			<span class="hljs-keyword">this</span>.dfd.abort();
		}

		<span class="hljs-keyword">this</span>.dfd = $.ajax({
			<span class="hljs-attr">url</span>: wp.media.view.settings.oEmbedProxyUrl,
			<span class="hljs-attr">data</span>: {
				<span class="hljs-attr">url</span>: <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'url'</span> ),
				<span class="hljs-attr">maxwidth</span>: <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'width'</span> ),
				<span class="hljs-attr">maxheight</span>: <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'height'</span> ),
				<span class="hljs-attr">_wpnonce</span>: wp.media.view.settings.nonce.wpRestApi
			},
			<span class="hljs-attr">type</span>: <span class="hljs-string">'GET'</span>,
			<span class="hljs-attr">dataType</span>: <span class="hljs-string">'json'</span>,
			<span class="hljs-attr">context</span>: <span class="hljs-keyword">this</span>
		})
			.done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> response </span>) </span>{
				<span class="hljs-keyword">this</span>.renderoEmbed( {
					<span class="hljs-attr">data</span>: {
						<span class="hljs-attr">body</span>: response.html || <span class="hljs-string">''</span>
					}
				} );
			} )
			.fail( <span class="hljs-keyword">this</span>.renderFail );
	},

	<span class="hljs-attr">renderFail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"> response, status </span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'abort'</span> === status ) {
			<span class="hljs-keyword">return</span>;
		}
		<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.link-text'</span> ).show();
	},

	<span class="hljs-attr">renderoEmbed</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> response </span>) </span>{
		<span class="hljs-keyword">var</span> html = ( response &amp;&amp; response.data &amp;&amp; response.data.body ) || <span class="hljs-string">''</span>;

		<span class="hljs-keyword">if</span> ( html ) {
			<span class="hljs-keyword">this</span>.$(<span class="hljs-string">'.embed-container'</span>).show().find(<span class="hljs-string">'.embed-preview'</span>).html( html );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.renderFail();
		}
	}
});

<span class="hljs-built_in">module</span>.exports = EmbedLink;

},{}],<span class="hljs-number">41</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.EmbedUrl
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	$ = jQuery,
	EmbedUrl;

EmbedUrl = View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'label'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'embed-url'</span>,

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'input'</span>:  <span class="hljs-string">'url'</span>,
		<span class="hljs-string">'keyup'</span>:  <span class="hljs-string">'url'</span>,
		<span class="hljs-string">'change'</span>: <span class="hljs-string">'url'</span>
	},

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$input = $(<span class="hljs-string">'&lt;input id="embed-url-field" type="url" /&gt;'</span>).val( <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'url'</span>) );
		<span class="hljs-keyword">this</span>.input = <span class="hljs-keyword">this</span>.$input[<span class="hljs-number">0</span>];

		<span class="hljs-keyword">this</span>.spinner = $(<span class="hljs-string">'&lt;span class="spinner" /&gt;'</span>)[<span class="hljs-number">0</span>];
		<span class="hljs-keyword">this</span>.$el.append([ <span class="hljs-keyword">this</span>.input, <span class="hljs-keyword">this</span>.spinner ]);

		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:url'</span>, <span class="hljs-keyword">this</span>.render );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'url'</span> ) ) {
			_.delay( _.bind( <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">this</span>.model.trigger( <span class="hljs-string">'change:url'</span> );
			}, <span class="hljs-keyword">this</span> ), <span class="hljs-number">500</span> );
		}
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.EmbedUrl} Returns itself to allow chaining
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> $input = <span class="hljs-keyword">this</span>.$input;

		<span class="hljs-keyword">if</span> ( $input.is(<span class="hljs-string">':focus'</span>) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.input.value = <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'url'</span>) || <span class="hljs-string">'http://'</span>;
		<span class="hljs-comment">/**
		 * Call `render` directly on parent class with passed arguments
		 */</span>
		View.prototype.render.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( ! wp.media.isTouchDevice ) {
			<span class="hljs-keyword">this</span>.focus();
		}
	},

	<span class="hljs-attr">url</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">this</span>.model.set( <span class="hljs-string">'url'</span>, $.trim( event.target.value ) );
	},

	<span class="hljs-comment">/**
	 * If the input is visible, focus and select its contents.
	 */</span>
	focus: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> $input = <span class="hljs-keyword">this</span>.$input;
		<span class="hljs-keyword">if</span> ( $input.is(<span class="hljs-string">':visible'</span>) ) {
			$input.focus()[<span class="hljs-number">0</span>].select();
		}
	}
});

<span class="hljs-built_in">module</span>.exports = EmbedUrl;

},{}],<span class="hljs-number">42</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.FocusManager
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> FocusManager = wp.media.View.extend({

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'keydown'</span>: <span class="hljs-string">'constrainTabbing'</span>
	},

	<span class="hljs-attr">focus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-comment">// Reset focus on first left menu item</span>
		<span class="hljs-keyword">this</span>.$(<span class="hljs-string">'.media-menu-item'</span>).first().focus();
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	constrainTabbing: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> tabbables;</pre></div></div>
            
        </li>
        
        
        <li id="section-135">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-135">&#182;</a>
              </div>
              <p>Look for the tab key.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-number">9</span> !== event.keyCode ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-136">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-136">&#182;</a>
              </div>
              <p>Skip the file input added by Plupload.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		tabbables = <span class="hljs-keyword">this</span>.$( <span class="hljs-string">':tabbable'</span> ).not( <span class="hljs-string">'.moxie-shim input[type="file"]'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-137">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-137">&#182;</a>
              </div>
              <p>Keep tab focus within media modal while it’s open</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( tabbables.last()[<span class="hljs-number">0</span>] === event.target &amp;&amp; ! event.shiftKey ) {
			tabbables.first().focus();
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( tabbables.first()[<span class="hljs-number">0</span>] === event.target &amp;&amp; event.shiftKey ) {
			tabbables.last().focus();
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}
	}

});

<span class="hljs-built_in">module</span>.exports = FocusManager;

},{}],<span class="hljs-number">43</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Frame
 *
 * A frame is a composite view consisting of one or more regions and one or more
 * states.
 *
 * @see wp.media.controller.State
 * @see wp.media.controller.Region
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 * @mixes wp.media.controller.StateMachine
 */</span>
<span class="hljs-keyword">var</span> Frame = wp.media.View.extend({
	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">mode</span>: [ <span class="hljs-string">'select'</span> ]
		});
		<span class="hljs-keyword">this</span>._createRegions();
		<span class="hljs-keyword">this</span>._createStates();
		<span class="hljs-keyword">this</span>._createModes();
	},

	<span class="hljs-attr">_createRegions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-138">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-138">&#182;</a>
              </div>
              <p>Clone the regions array.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.regions = <span class="hljs-keyword">this</span>.regions ? <span class="hljs-keyword">this</span>.regions.slice() : [];</pre></div></div>
            
        </li>
        
        
        <li id="section-139">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-139">&#182;</a>
              </div>
              <p>Initialize regions.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_.each( <span class="hljs-keyword">this</span>.regions, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> region </span>) </span>{
			<span class="hljs-keyword">this</span>[ region ] = <span class="hljs-keyword">new</span> wp.media.controller.Region({
				<span class="hljs-attr">view</span>:     <span class="hljs-keyword">this</span>,
				<span class="hljs-attr">id</span>:       region,
				<span class="hljs-attr">selector</span>: <span class="hljs-string">'.media-frame-'</span> + region
			});
		}, <span class="hljs-keyword">this</span> );
	},
	<span class="hljs-comment">/**
	 * Create the frame's states.
	 *
	 * @see wp.media.controller.State
	 * @see wp.media.controller.StateMachine
	 *
	 * @fires wp.media.controller.State#ready
	 */</span>
	_createStates: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-140">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-140">&#182;</a>
              </div>
              <p>Create the default <code>states</code> collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.states = <span class="hljs-keyword">new</span> Backbone.Collection( <span class="hljs-literal">null</span>, {
			<span class="hljs-attr">model</span>: wp.media.controller.State
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-141">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-141">&#182;</a>
              </div>
              <p>Ensure states have a reference to the frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.states.on( <span class="hljs-string">'add'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model </span>) </span>{
			model.frame = <span class="hljs-keyword">this</span>;
			model.trigger(<span class="hljs-string">'ready'</span>);
		}, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.states ) {
			<span class="hljs-keyword">this</span>.states.add( <span class="hljs-keyword">this</span>.options.states );
		}
	},

	<span class="hljs-comment">/**
	 * A frame can be in a mode or multiple modes at one time.
	 *
	 * For example, the manage media frame can be in the `Bulk Select` or `Edit` mode.
	 */</span>
	_createModes: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-142">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-142">&#182;</a>
              </div>
              <p>Store active “modes” that the frame is in. Unrelated to region modes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.activeModes = <span class="hljs-keyword">new</span> Backbone.Collection();
		<span class="hljs-keyword">this</span>.activeModes.on( <span class="hljs-string">'add remove reset'</span>, _.bind( <span class="hljs-keyword">this</span>.triggerModeEvents, <span class="hljs-keyword">this</span> ) );

		_.each( <span class="hljs-keyword">this</span>.options.mode, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> mode </span>) </span>{
			<span class="hljs-keyword">this</span>.activateMode( mode );
		}, <span class="hljs-keyword">this</span> );
	},
	<span class="hljs-comment">/**
	 * Reset all states on the frame to their defaults.
	 *
	 * @returns {wp.media.view.Frame} Returns itself to allow chaining
	 */</span>
	reset: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.states.invoke( <span class="hljs-string">'trigger'</span>, <span class="hljs-string">'reset'</span> );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * Map activeMode collection events to the frame.
	 */</span>
	triggerModeEvents: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model, collection, options </span>) </span>{
		<span class="hljs-keyword">var</span> collectionEvent,
			modeEventMap = {
				<span class="hljs-attr">add</span>: <span class="hljs-string">'activate'</span>,
				<span class="hljs-attr">remove</span>: <span class="hljs-string">'deactivate'</span>
			},
			eventToTrigger;</pre></div></div>
            
        </li>
        
        
        <li id="section-143">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-143">&#182;</a>
              </div>
              <p>Probably a better way to do this.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_.each( options, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, key </span>) </span>{
			<span class="hljs-keyword">if</span> ( value ) {
				collectionEvent = key;
			}
		} );

		<span class="hljs-keyword">if</span> ( ! _.has( modeEventMap, collectionEvent ) ) {
			<span class="hljs-keyword">return</span>;
		}

		eventToTrigger = model.get(<span class="hljs-string">'id'</span>) + <span class="hljs-string">':'</span> + modeEventMap[collectionEvent];
		<span class="hljs-keyword">this</span>.trigger( eventToTrigger );
	},
	<span class="hljs-comment">/**
	 * Activate a mode on the frame.
	 *
	 * @param string mode Mode ID.
	 * @returns {this} Returns itself to allow chaining.
	 */</span>
	activateMode: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> mode </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-144">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-144">&#182;</a>
              </div>
              <p>Bail if the mode is already active.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isModeActive( mode ) ) {
			<span class="hljs-keyword">return</span>;
		}
		<span class="hljs-keyword">this</span>.activeModes.add( [ { <span class="hljs-attr">id</span>: mode } ] );</pre></div></div>
            
        </li>
        
        
        <li id="section-145">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-145">&#182;</a>
              </div>
              <p>Add a CSS class to the frame so elements can be styled for the mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.$el.addClass( <span class="hljs-string">'mode-'</span> + mode );

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * Deactivate a mode on the frame.
	 *
	 * @param string mode Mode ID.
	 * @returns {this} Returns itself to allow chaining.
	 */</span>
	deactivateMode: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> mode </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-146">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-146">&#182;</a>
              </div>
              <p>Bail if the mode isn’t active.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.isModeActive( mode ) ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}
		<span class="hljs-keyword">this</span>.activeModes.remove( <span class="hljs-keyword">this</span>.activeModes.where( { <span class="hljs-attr">id</span>: mode } ) );
		<span class="hljs-keyword">this</span>.$el.removeClass( <span class="hljs-string">'mode-'</span> + mode );
		<span class="hljs-comment">/**
		 * Frame mode deactivation event.
		 *
		 * @event this#{mode}:deactivate
		 */</span>
		<span class="hljs-keyword">this</span>.trigger( mode + <span class="hljs-string">':deactivate'</span> );

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * Check if a mode is enabled on the frame.
	 *
	 * @param  string mode Mode ID.
	 * @return bool
	 */</span>
	isModeActive: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> mode </span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-built_in">Boolean</span>( <span class="hljs-keyword">this</span>.activeModes.where( { <span class="hljs-attr">id</span>: mode } ).length );
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-147">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-147">&#182;</a>
              </div>
              <p>Make the <code>Frame</code> a <code>StateMachine</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>_.extend( Frame.prototype, wp.media.controller.StateMachine.prototype );

<span class="hljs-built_in">module</span>.exports = Frame;

},{}],<span class="hljs-number">44</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.MediaFrame.ImageDetails
 *
 * A media frame for manipulating an image that's already been inserted
 * into a post.
 *
 * @class
 * @augments wp.media.view.MediaFrame.Select
 * @augments wp.media.view.MediaFrame
 * @augments wp.media.view.Frame
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 * @mixes wp.media.controller.StateMachine
 */</span>
<span class="hljs-keyword">var</span> Select = wp.media.view.MediaFrame.Select,
	l10n = wp.media.view.l10n,
	ImageDetails;

ImageDetails = Select.extend({
	<span class="hljs-attr">defaults</span>: {
		<span class="hljs-attr">id</span>:      <span class="hljs-string">'image'</span>,
		<span class="hljs-attr">url</span>:     <span class="hljs-string">''</span>,
		<span class="hljs-attr">menu</span>:    <span class="hljs-string">'image-details'</span>,
		<span class="hljs-attr">content</span>: <span class="hljs-string">'image-details'</span>,
		<span class="hljs-attr">toolbar</span>: <span class="hljs-string">'image-details'</span>,
		<span class="hljs-attr">type</span>:    <span class="hljs-string">'link'</span>,
		<span class="hljs-attr">title</span>:    l10n.imageDetailsTitle,
		<span class="hljs-attr">priority</span>: <span class="hljs-number">120</span>
	},

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">this</span>.image = <span class="hljs-keyword">new</span> wp.media.model.PostImage( options.metadata );
		<span class="hljs-keyword">this</span>.options.selection = <span class="hljs-keyword">new</span> wp.media.model.Selection( <span class="hljs-keyword">this</span>.image.attachment, { <span class="hljs-attr">multiple</span>: <span class="hljs-literal">false</span> } );
		Select.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-attr">bindHandlers</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		Select.prototype.bindHandlers.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'menu:create:image-details'</span>, <span class="hljs-keyword">this</span>.createMenu, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'content:create:image-details'</span>, <span class="hljs-keyword">this</span>.imageDetailsContent, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'content:render:edit-image'</span>, <span class="hljs-keyword">this</span>.editImageContent, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'toolbar:render:image-details'</span>, <span class="hljs-keyword">this</span>.renderImageDetailsToolbar, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-148">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-148">&#182;</a>
              </div>
              <p>override the select toolbar</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'toolbar:render:replace'</span>, <span class="hljs-keyword">this</span>.renderReplaceImageToolbar, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-attr">createStates</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.states.add([
			<span class="hljs-keyword">new</span> wp.media.controller.ImageDetails({
				<span class="hljs-attr">image</span>: <span class="hljs-keyword">this</span>.image,
				<span class="hljs-attr">editable</span>: <span class="hljs-literal">false</span>
			}),
			<span class="hljs-keyword">new</span> wp.media.controller.ReplaceImage({
				<span class="hljs-attr">id</span>: <span class="hljs-string">'replace-image'</span>,
				<span class="hljs-attr">library</span>: wp.media.query( { <span class="hljs-attr">type</span>: <span class="hljs-string">'image'</span> } ),
				<span class="hljs-attr">image</span>: <span class="hljs-keyword">this</span>.image,
				<span class="hljs-attr">multiple</span>:  <span class="hljs-literal">false</span>,
				<span class="hljs-attr">title</span>:     l10n.imageReplaceTitle,
				<span class="hljs-attr">toolbar</span>: <span class="hljs-string">'replace'</span>,
				<span class="hljs-attr">priority</span>:  <span class="hljs-number">80</span>,
				<span class="hljs-attr">displaySettings</span>: <span class="hljs-literal">true</span>
			}),
			<span class="hljs-keyword">new</span> wp.media.controller.EditImage( {
				<span class="hljs-attr">image</span>: <span class="hljs-keyword">this</span>.image,
				<span class="hljs-attr">selection</span>: <span class="hljs-keyword">this</span>.options.selection
			} )
		]);
	},

	<span class="hljs-attr">imageDetailsContent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		options.view = <span class="hljs-keyword">new</span> wp.media.view.ImageDetails({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">model</span>: <span class="hljs-keyword">this</span>.state().image,
			<span class="hljs-attr">attachment</span>: <span class="hljs-keyword">this</span>.state().image.attachment
		});
	},

	<span class="hljs-attr">editImageContent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> state = <span class="hljs-keyword">this</span>.state(),
			model = state.get(<span class="hljs-string">'image'</span>),
			view;

		<span class="hljs-keyword">if</span> ( ! model ) {
			<span class="hljs-keyword">return</span>;
		}

		view = <span class="hljs-keyword">new</span> wp.media.view.EditImage( { <span class="hljs-attr">model</span>: model, <span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span> } ).render();

		<span class="hljs-keyword">this</span>.content.set( view );</pre></div></div>
            
        </li>
        
        
        <li id="section-149">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-149">&#182;</a>
              </div>
              <p>after bringing in the frame, load the actual editor via an ajax call</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		view.loadEditor();

	},

	<span class="hljs-attr">renderImageDetailsToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-keyword">new</span> wp.media.view.Toolbar({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">items</span>: {
				<span class="hljs-attr">select</span>: {
					<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
					<span class="hljs-attr">text</span>:     l10n.update,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,

					<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>.controller,
							state = controller.state();

						controller.close();</pre></div></div>
            
        </li>
        
        
        <li id="section-150">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-150">&#182;</a>
              </div>
              <p>not sure if we want to use wp.media.string.image which will create a shortcode or
perhaps wp.html.string to at least to build the <img /></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						state.trigger( <span class="hljs-string">'update'</span>, controller.image.toJSON() );</pre></div></div>
            
        </li>
        
        
        <li id="section-151">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-151">&#182;</a>
              </div>
              <p>Restore and reset the default state.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						controller.setState( controller.options.state );
						controller.reset();
					}
				}
			}
		}) );
	},

	<span class="hljs-attr">renderReplaceImageToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> frame = <span class="hljs-keyword">this</span>,
			lastState = frame.lastState(),
			previous = lastState &amp;&amp; lastState.id;

		<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-keyword">new</span> wp.media.view.Toolbar({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">items</span>: {
				<span class="hljs-attr">back</span>: {
					<span class="hljs-attr">text</span>:     l10n.back,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
					<span class="hljs-attr">click</span>:    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">if</span> ( previous ) {
							frame.setState( previous );
						} <span class="hljs-keyword">else</span> {
							frame.close();
						}
					}
				},

				<span class="hljs-attr">replace</span>: {
					<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
					<span class="hljs-attr">text</span>:     l10n.replace,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,

					<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>.controller,
							state = controller.state(),
							selection = state.get( <span class="hljs-string">'selection'</span> ),
							attachment = selection.single();

						controller.close();

						controller.image.changeAttachment( attachment, state.display( attachment ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-152">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-152">&#182;</a>
              </div>
              <p>not sure if we want to use wp.media.string.image which will create a shortcode or
perhaps wp.html.string to at least to build the <img /></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						state.trigger( <span class="hljs-string">'replace'</span>, controller.image.toJSON() );</pre></div></div>
            
        </li>
        
        
        <li id="section-153">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-153">&#182;</a>
              </div>
              <p>Restore and reset the default state.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						controller.setState( controller.options.state );
						controller.reset();
					}
				}
			}
		}) );
	}

});

<span class="hljs-built_in">module</span>.exports = ImageDetails;

},{}],<span class="hljs-number">45</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.MediaFrame.Post
 *
 * The frame for manipulating media on the Edit Post page.
 *
 * @class
 * @augments wp.media.view.MediaFrame.Select
 * @augments wp.media.view.MediaFrame
 * @augments wp.media.view.Frame
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 * @mixes wp.media.controller.StateMachine
 */</span>
<span class="hljs-keyword">var</span> Select = wp.media.view.MediaFrame.Select,
	Library = wp.media.controller.Library,
	l10n = wp.media.view.l10n,
	Post;

Post = Select.extend({
	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.counts = {
			<span class="hljs-attr">audio</span>: {
				<span class="hljs-attr">count</span>: wp.media.view.settings.attachmentCounts.audio,
				<span class="hljs-attr">state</span>: <span class="hljs-string">'playlist'</span>
			},
			<span class="hljs-attr">video</span>: {
				<span class="hljs-attr">count</span>: wp.media.view.settings.attachmentCounts.video,
				<span class="hljs-attr">state</span>: <span class="hljs-string">'video-playlist'</span>
			}
		};

		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">multiple</span>:  <span class="hljs-literal">true</span>,
			<span class="hljs-attr">editing</span>:   <span class="hljs-literal">false</span>,
			<span class="hljs-attr">state</span>:    <span class="hljs-string">'insert'</span>,
			<span class="hljs-attr">metadata</span>:  {}
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-154">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-154">&#182;</a>
              </div>
              <p>Call ‘initialize’ directly on the parent class.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		Select.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">this</span>.createIframeStates();

	},

	<span class="hljs-comment">/**
	 * Create the default states.
	 */</span>
	createStates: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options;

		<span class="hljs-keyword">this</span>.states.add([</pre></div></div>
            
        </li>
        
        
        <li id="section-155">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-155">&#182;</a>
              </div>
              <p>Main states.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">new</span> Library({
				<span class="hljs-attr">id</span>:         <span class="hljs-string">'insert'</span>,
				<span class="hljs-attr">title</span>:      l10n.insertMediaTitle,
				<span class="hljs-attr">priority</span>:   <span class="hljs-number">20</span>,
				<span class="hljs-attr">toolbar</span>:    <span class="hljs-string">'main-insert'</span>,
				<span class="hljs-attr">filterable</span>: <span class="hljs-string">'all'</span>,
				<span class="hljs-attr">library</span>:    wp.media.query( options.library ),
				<span class="hljs-attr">multiple</span>:   options.multiple ? <span class="hljs-string">'reset'</span> : <span class="hljs-literal">false</span>,
				<span class="hljs-attr">editable</span>:   <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-156">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-156">&#182;</a>
              </div>
              <p>If the user isn’t allowed to edit fields,
can they still edit it locally?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				allowLocalEdits: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-157">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-157">&#182;</a>
              </div>
              <p>Show the attachment display settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				displaySettings: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-158">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-158">&#182;</a>
              </div>
              <p>Update user settings when users adjust the
attachment display settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				displayUserSettings: <span class="hljs-literal">true</span>
			}),

			<span class="hljs-keyword">new</span> Library({
				<span class="hljs-attr">id</span>:         <span class="hljs-string">'gallery'</span>,
				<span class="hljs-attr">title</span>:      l10n.createGalleryTitle,
				<span class="hljs-attr">priority</span>:   <span class="hljs-number">40</span>,
				<span class="hljs-attr">toolbar</span>:    <span class="hljs-string">'main-gallery'</span>,
				<span class="hljs-attr">filterable</span>: <span class="hljs-string">'uploaded'</span>,
				<span class="hljs-attr">multiple</span>:   <span class="hljs-string">'add'</span>,
				<span class="hljs-attr">editable</span>:   <span class="hljs-literal">false</span>,

				<span class="hljs-attr">library</span>:  wp.media.query( _.defaults({
					<span class="hljs-attr">type</span>: <span class="hljs-string">'image'</span>
				}, options.library ) )
			}),</pre></div></div>
            
        </li>
        
        
        <li id="section-159">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-159">&#182;</a>
              </div>
              <p>Embed states.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">new</span> wp.media.controller.Embed( { <span class="hljs-attr">metadata</span>: options.metadata } ),

			<span class="hljs-keyword">new</span> wp.media.controller.EditImage( { <span class="hljs-attr">model</span>: options.editImage } ),</pre></div></div>
            
        </li>
        
        
        <li id="section-160">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-160">&#182;</a>
              </div>
              <p>Gallery states.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">new</span> wp.media.controller.GalleryEdit({
				<span class="hljs-attr">library</span>: options.selection,
				<span class="hljs-attr">editing</span>: options.editing,
				<span class="hljs-attr">menu</span>:    <span class="hljs-string">'gallery'</span>
			}),

			<span class="hljs-keyword">new</span> wp.media.controller.GalleryAdd(),

			<span class="hljs-keyword">new</span> Library({
				<span class="hljs-attr">id</span>:         <span class="hljs-string">'playlist'</span>,
				<span class="hljs-attr">title</span>:      l10n.createPlaylistTitle,
				<span class="hljs-attr">priority</span>:   <span class="hljs-number">60</span>,
				<span class="hljs-attr">toolbar</span>:    <span class="hljs-string">'main-playlist'</span>,
				<span class="hljs-attr">filterable</span>: <span class="hljs-string">'uploaded'</span>,
				<span class="hljs-attr">multiple</span>:   <span class="hljs-string">'add'</span>,
				<span class="hljs-attr">editable</span>:   <span class="hljs-literal">false</span>,

				<span class="hljs-attr">library</span>:  wp.media.query( _.defaults({
					<span class="hljs-attr">type</span>: <span class="hljs-string">'audio'</span>
				}, options.library ) )
			}),</pre></div></div>
            
        </li>
        
        
        <li id="section-161">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-161">&#182;</a>
              </div>
              <p>Playlist states.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">new</span> wp.media.controller.CollectionEdit({
				<span class="hljs-attr">type</span>: <span class="hljs-string">'audio'</span>,
				<span class="hljs-attr">collectionType</span>: <span class="hljs-string">'playlist'</span>,
				<span class="hljs-attr">title</span>:          l10n.editPlaylistTitle,
				<span class="hljs-attr">SettingsView</span>:   wp.media.view.Settings.Playlist,
				<span class="hljs-attr">library</span>:        options.selection,
				<span class="hljs-attr">editing</span>:        options.editing,
				<span class="hljs-attr">menu</span>:           <span class="hljs-string">'playlist'</span>,
				<span class="hljs-attr">dragInfoText</span>:   l10n.playlistDragInfo,
				<span class="hljs-attr">dragInfo</span>:       <span class="hljs-literal">false</span>
			}),

			<span class="hljs-keyword">new</span> wp.media.controller.CollectionAdd({
				<span class="hljs-attr">type</span>: <span class="hljs-string">'audio'</span>,
				<span class="hljs-attr">collectionType</span>: <span class="hljs-string">'playlist'</span>,
				<span class="hljs-attr">title</span>: l10n.addToPlaylistTitle
			}),

			<span class="hljs-keyword">new</span> Library({
				<span class="hljs-attr">id</span>:         <span class="hljs-string">'video-playlist'</span>,
				<span class="hljs-attr">title</span>:      l10n.createVideoPlaylistTitle,
				<span class="hljs-attr">priority</span>:   <span class="hljs-number">60</span>,
				<span class="hljs-attr">toolbar</span>:    <span class="hljs-string">'main-video-playlist'</span>,
				<span class="hljs-attr">filterable</span>: <span class="hljs-string">'uploaded'</span>,
				<span class="hljs-attr">multiple</span>:   <span class="hljs-string">'add'</span>,
				<span class="hljs-attr">editable</span>:   <span class="hljs-literal">false</span>,

				<span class="hljs-attr">library</span>:  wp.media.query( _.defaults({
					<span class="hljs-attr">type</span>: <span class="hljs-string">'video'</span>
				}, options.library ) )
			}),

			<span class="hljs-keyword">new</span> wp.media.controller.CollectionEdit({
				<span class="hljs-attr">type</span>: <span class="hljs-string">'video'</span>,
				<span class="hljs-attr">collectionType</span>: <span class="hljs-string">'playlist'</span>,
				<span class="hljs-attr">title</span>:          l10n.editVideoPlaylistTitle,
				<span class="hljs-attr">SettingsView</span>:   wp.media.view.Settings.Playlist,
				<span class="hljs-attr">library</span>:        options.selection,
				<span class="hljs-attr">editing</span>:        options.editing,
				<span class="hljs-attr">menu</span>:           <span class="hljs-string">'video-playlist'</span>,
				<span class="hljs-attr">dragInfoText</span>:   l10n.videoPlaylistDragInfo,
				<span class="hljs-attr">dragInfo</span>:       <span class="hljs-literal">false</span>
			}),

			<span class="hljs-keyword">new</span> wp.media.controller.CollectionAdd({
				<span class="hljs-attr">type</span>: <span class="hljs-string">'video'</span>,
				<span class="hljs-attr">collectionType</span>: <span class="hljs-string">'playlist'</span>,
				<span class="hljs-attr">title</span>: l10n.addToVideoPlaylistTitle
			})
		]);

		<span class="hljs-keyword">if</span> ( wp.media.view.settings.post.featuredImageId ) {
			<span class="hljs-keyword">this</span>.states.add( <span class="hljs-keyword">new</span> wp.media.controller.FeaturedImage() );
		}
	},

	<span class="hljs-attr">bindHandlers</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> handlers, checkCounts;

		Select.prototype.bindHandlers.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );

		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'activate'</span>, <span class="hljs-keyword">this</span>.activate, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-162">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-162">&#182;</a>
              </div>
              <p>Only bother checking media type counts if one of the counts is zero</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		checkCounts = _.find( <span class="hljs-keyword">this</span>.counts, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> type </span>) </span>{
			<span class="hljs-keyword">return</span> type.count === <span class="hljs-number">0</span>;
		} );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> checkCounts !== <span class="hljs-string">'undefined'</span> ) {
			<span class="hljs-keyword">this</span>.listenTo( wp.media.model.Attachments.all, <span class="hljs-string">'change:type'</span>, <span class="hljs-keyword">this</span>.mediaTypeCounts );
		}

		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'menu:create:gallery'</span>, <span class="hljs-keyword">this</span>.createMenu, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'menu:create:playlist'</span>, <span class="hljs-keyword">this</span>.createMenu, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'menu:create:video-playlist'</span>, <span class="hljs-keyword">this</span>.createMenu, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'toolbar:create:main-insert'</span>, <span class="hljs-keyword">this</span>.createToolbar, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'toolbar:create:main-gallery'</span>, <span class="hljs-keyword">this</span>.createToolbar, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'toolbar:create:main-playlist'</span>, <span class="hljs-keyword">this</span>.createToolbar, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'toolbar:create:main-video-playlist'</span>, <span class="hljs-keyword">this</span>.createToolbar, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'toolbar:create:featured-image'</span>, <span class="hljs-keyword">this</span>.featuredImageToolbar, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'toolbar:create:main-embed'</span>, <span class="hljs-keyword">this</span>.mainEmbedToolbar, <span class="hljs-keyword">this</span> );

		handlers = {
			<span class="hljs-attr">menu</span>: {
				<span class="hljs-string">'default'</span>: <span class="hljs-string">'mainMenu'</span>,
				<span class="hljs-string">'gallery'</span>: <span class="hljs-string">'galleryMenu'</span>,
				<span class="hljs-string">'playlist'</span>: <span class="hljs-string">'playlistMenu'</span>,
				<span class="hljs-string">'video-playlist'</span>: <span class="hljs-string">'videoPlaylistMenu'</span>
			},

			<span class="hljs-attr">content</span>: {
				<span class="hljs-string">'embed'</span>:          <span class="hljs-string">'embedContent'</span>,
				<span class="hljs-string">'edit-image'</span>:     <span class="hljs-string">'editImageContent'</span>,
				<span class="hljs-string">'edit-selection'</span>: <span class="hljs-string">'editSelectionContent'</span>
			},

			<span class="hljs-attr">toolbar</span>: {
				<span class="hljs-string">'main-insert'</span>:      <span class="hljs-string">'mainInsertToolbar'</span>,
				<span class="hljs-string">'main-gallery'</span>:     <span class="hljs-string">'mainGalleryToolbar'</span>,
				<span class="hljs-string">'gallery-edit'</span>:     <span class="hljs-string">'galleryEditToolbar'</span>,
				<span class="hljs-string">'gallery-add'</span>:      <span class="hljs-string">'galleryAddToolbar'</span>,
				<span class="hljs-string">'main-playlist'</span>:	<span class="hljs-string">'mainPlaylistToolbar'</span>,
				<span class="hljs-string">'playlist-edit'</span>:	<span class="hljs-string">'playlistEditToolbar'</span>,
				<span class="hljs-string">'playlist-add'</span>:		<span class="hljs-string">'playlistAddToolbar'</span>,
				<span class="hljs-string">'main-video-playlist'</span>: <span class="hljs-string">'mainVideoPlaylistToolbar'</span>,
				<span class="hljs-string">'video-playlist-edit'</span>: <span class="hljs-string">'videoPlaylistEditToolbar'</span>,
				<span class="hljs-string">'video-playlist-add'</span>: <span class="hljs-string">'videoPlaylistAddToolbar'</span>
			}
		};

		_.each( handlers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> regionHandlers, region </span>) </span>{
			_.each( regionHandlers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> callback, handler </span>) </span>{
				<span class="hljs-keyword">this</span>.on( region + <span class="hljs-string">':render:'</span> + handler, <span class="hljs-keyword">this</span>[ callback ], <span class="hljs-keyword">this</span> );
			}, <span class="hljs-keyword">this</span> );
		}, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-attr">activate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-163">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-163">&#182;</a>
              </div>
              <p>Hide menu items for states tied to particular media types if there are no items</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_.each( <span class="hljs-keyword">this</span>.counts, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> type </span>) </span>{
			<span class="hljs-keyword">if</span> ( type.count &lt; <span class="hljs-number">1</span> ) {
				<span class="hljs-keyword">this</span>.menuItemVisibility( type.state, <span class="hljs-string">'hide'</span> );
			}
		}, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-attr">mediaTypeCounts</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model, attr </span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.counts[ attr ] !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-keyword">this</span>.counts[ attr ].count &lt; <span class="hljs-number">1</span> ) {
			<span class="hljs-keyword">this</span>.counts[ attr ].count++;
			<span class="hljs-keyword">this</span>.menuItemVisibility( <span class="hljs-keyword">this</span>.counts[ attr ].state, <span class="hljs-string">'show'</span> );
		}
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-164">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-164">&#182;</a>
              </div>
              <p>Menus</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-comment">/**
	 * @param {wp.Backbone.View} view
	 */</span>
	mainMenu: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		view.set({
			<span class="hljs-string">'library-separator'</span>: <span class="hljs-keyword">new</span> wp.media.View({
				<span class="hljs-attr">className</span>: <span class="hljs-string">'separator'</span>,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">100</span>
			})
		});
	},

	<span class="hljs-attr">menuItemVisibility</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> state, visibility </span>) </span>{
		<span class="hljs-keyword">var</span> menu = <span class="hljs-keyword">this</span>.menu.get();
		<span class="hljs-keyword">if</span> ( visibility === <span class="hljs-string">'hide'</span> ) {
			menu.hide( state );
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( visibility === <span class="hljs-string">'show'</span> ) {
			menu.show( state );
		}
	},
	<span class="hljs-comment">/**
	 * @param {wp.Backbone.View} view
	 */</span>
	galleryMenu: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		<span class="hljs-keyword">var</span> lastState = <span class="hljs-keyword">this</span>.lastState(),
			previous = lastState &amp;&amp; lastState.id,
			frame = <span class="hljs-keyword">this</span>;

		view.set({
			<span class="hljs-attr">cancel</span>: {
				<span class="hljs-attr">text</span>:     l10n.cancelGalleryTitle,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
				<span class="hljs-attr">click</span>:    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					<span class="hljs-keyword">if</span> ( previous ) {
						frame.setState( previous );
					} <span class="hljs-keyword">else</span> {
						frame.close();
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-165">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-165">&#182;</a>
              </div>
              <p>Keep focus inside media modal
after canceling a gallery</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">this</span>.controller.modal.focusManager.focus();
				}
			},
			<span class="hljs-attr">separateCancel</span>: <span class="hljs-keyword">new</span> wp.media.View({
				<span class="hljs-attr">className</span>: <span class="hljs-string">'separator'</span>,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">40</span>
			})
		});
	},

	<span class="hljs-attr">playlistMenu</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		<span class="hljs-keyword">var</span> lastState = <span class="hljs-keyword">this</span>.lastState(),
			previous = lastState &amp;&amp; lastState.id,
			frame = <span class="hljs-keyword">this</span>;

		view.set({
			<span class="hljs-attr">cancel</span>: {
				<span class="hljs-attr">text</span>:     l10n.cancelPlaylistTitle,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
				<span class="hljs-attr">click</span>:    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					<span class="hljs-keyword">if</span> ( previous ) {
						frame.setState( previous );
					} <span class="hljs-keyword">else</span> {
						frame.close();
					}
				}
			},
			<span class="hljs-attr">separateCancel</span>: <span class="hljs-keyword">new</span> wp.media.View({
				<span class="hljs-attr">className</span>: <span class="hljs-string">'separator'</span>,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">40</span>
			})
		});
	},

	<span class="hljs-attr">videoPlaylistMenu</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		<span class="hljs-keyword">var</span> lastState = <span class="hljs-keyword">this</span>.lastState(),
			previous = lastState &amp;&amp; lastState.id,
			frame = <span class="hljs-keyword">this</span>;

		view.set({
			<span class="hljs-attr">cancel</span>: {
				<span class="hljs-attr">text</span>:     l10n.cancelVideoPlaylistTitle,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
				<span class="hljs-attr">click</span>:    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					<span class="hljs-keyword">if</span> ( previous ) {
						frame.setState( previous );
					} <span class="hljs-keyword">else</span> {
						frame.close();
					}
				}
			},
			<span class="hljs-attr">separateCancel</span>: <span class="hljs-keyword">new</span> wp.media.View({
				<span class="hljs-attr">className</span>: <span class="hljs-string">'separator'</span>,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">40</span>
			})
		});
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-166">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-166">&#182;</a>
              </div>
              <p>Content</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	embedContent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">new</span> wp.media.view.Embed({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">model</span>:      <span class="hljs-keyword">this</span>.state()
		}).render();

		<span class="hljs-keyword">this</span>.content.set( view );

		<span class="hljs-keyword">if</span> ( ! wp.media.isTouchDevice ) {
			view.url.focus();
		}
	},

	<span class="hljs-attr">editSelectionContent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> state = <span class="hljs-keyword">this</span>.state(),
			selection = state.get(<span class="hljs-string">'selection'</span>),
			view;

		view = <span class="hljs-keyword">new</span> wp.media.view.AttachmentsBrowser({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">collection</span>: selection,
			<span class="hljs-attr">selection</span>:  selection,
			<span class="hljs-attr">model</span>:      state,
			<span class="hljs-attr">sortable</span>:   <span class="hljs-literal">true</span>,
			<span class="hljs-attr">search</span>:     <span class="hljs-literal">false</span>,
			<span class="hljs-attr">date</span>:       <span class="hljs-literal">false</span>,
			<span class="hljs-attr">dragInfo</span>:   <span class="hljs-literal">true</span>,

			<span class="hljs-attr">AttachmentView</span>: wp.media.view.Attachments.EditSelection
		}).render();

		view.toolbar.set( <span class="hljs-string">'backToLibrary'</span>, {
			<span class="hljs-attr">text</span>:     l10n.returnToLibrary,
			<span class="hljs-attr">priority</span>: <span class="hljs-number">-100</span>,

			<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">this</span>.controller.content.mode(<span class="hljs-string">'browse'</span>);
			}
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-167">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-167">&#182;</a>
              </div>
              <p>Browse our library of attachments.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.content.set( view );</pre></div></div>
            
        </li>
        
        
        <li id="section-168">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-168">&#182;</a>
              </div>
              <p>Trigger the controller to set focus</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'edit:selection'</span>, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-attr">editImageContent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> image = <span class="hljs-keyword">this</span>.state().get(<span class="hljs-string">'image'</span>),
			view = <span class="hljs-keyword">new</span> wp.media.view.EditImage( { <span class="hljs-attr">model</span>: image, <span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span> } ).render();

		<span class="hljs-keyword">this</span>.content.set( view );</pre></div></div>
            
        </li>
        
        
        <li id="section-169">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-169">&#182;</a>
              </div>
              <p>after creating the wrapper view, load the actual editor via an ajax call</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		view.loadEditor();

	},</pre></div></div>
            
        </li>
        
        
        <li id="section-170">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-170">&#182;</a>
              </div>
              <p>Toolbars</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
	<span class="hljs-comment">/**
	 * @param {wp.Backbone.View} view
	 */</span>
	selectionStatusToolbar: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		<span class="hljs-keyword">var</span> editable = <span class="hljs-keyword">this</span>.state().get(<span class="hljs-string">'editable'</span>);

		view.set( <span class="hljs-string">'selection'</span>, <span class="hljs-keyword">new</span> wp.media.view.Selection({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">collection</span>: <span class="hljs-keyword">this</span>.state().get(<span class="hljs-string">'selection'</span>),
			<span class="hljs-attr">priority</span>:   <span class="hljs-number">-40</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-171">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-171">&#182;</a>
              </div>
              <p>If the selection is editable, pass the callback to
switch the content mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			editable: editable &amp;&amp; <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">this</span>.controller.content.mode(<span class="hljs-string">'edit-selection'</span>);
			}
		}).render() );
	},

	<span class="hljs-comment">/**
	 * @param {wp.Backbone.View} view
	 */</span>
	mainInsertToolbar: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">this</span>.selectionStatusToolbar( view );

		view.set( <span class="hljs-string">'insert'</span>, {
			<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
			<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,
			<span class="hljs-attr">text</span>:     l10n.insertIntoPost,
			<span class="hljs-attr">requires</span>: { <span class="hljs-attr">selection</span>: <span class="hljs-literal">true</span> },

			<span class="hljs-comment">/**
			 * @fires wp.media.controller.State#insert
			 */</span>
			click: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">var</span> state = controller.state(),
					selection = state.get(<span class="hljs-string">'selection'</span>);

				controller.close();
				state.trigger( <span class="hljs-string">'insert'</span>, selection ).reset();
			}
		});
	},

	<span class="hljs-comment">/**
	 * @param {wp.Backbone.View} view
	 */</span>
	mainGalleryToolbar: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">this</span>.selectionStatusToolbar( view );

		view.set( <span class="hljs-string">'gallery'</span>, {
			<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
			<span class="hljs-attr">text</span>:     l10n.createNewGallery,
			<span class="hljs-attr">priority</span>: <span class="hljs-number">60</span>,
			<span class="hljs-attr">requires</span>: { <span class="hljs-attr">selection</span>: <span class="hljs-literal">true</span> },

			<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">var</span> selection = controller.state().get(<span class="hljs-string">'selection'</span>),
					edit = controller.state(<span class="hljs-string">'gallery-edit'</span>),
					models = selection.where({ <span class="hljs-attr">type</span>: <span class="hljs-string">'image'</span> });

				edit.set( <span class="hljs-string">'library'</span>, <span class="hljs-keyword">new</span> wp.media.model.Selection( models, {
					<span class="hljs-attr">props</span>:    selection.props.toJSON(),
					<span class="hljs-attr">multiple</span>: <span class="hljs-literal">true</span>
				}) );

				<span class="hljs-keyword">this</span>.controller.setState(<span class="hljs-string">'gallery-edit'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-172">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-172">&#182;</a>
              </div>
              <p>Keep focus inside media modal
after jumping to gallery view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.controller.modal.focusManager.focus();
			}
		});
	},

	<span class="hljs-attr">mainPlaylistToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">this</span>.selectionStatusToolbar( view );

		view.set( <span class="hljs-string">'playlist'</span>, {
			<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
			<span class="hljs-attr">text</span>:     l10n.createNewPlaylist,
			<span class="hljs-attr">priority</span>: <span class="hljs-number">100</span>,
			<span class="hljs-attr">requires</span>: { <span class="hljs-attr">selection</span>: <span class="hljs-literal">true</span> },

			<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">var</span> selection = controller.state().get(<span class="hljs-string">'selection'</span>),
					edit = controller.state(<span class="hljs-string">'playlist-edit'</span>),
					models = selection.where({ <span class="hljs-attr">type</span>: <span class="hljs-string">'audio'</span> });

				edit.set( <span class="hljs-string">'library'</span>, <span class="hljs-keyword">new</span> wp.media.model.Selection( models, {
					<span class="hljs-attr">props</span>:    selection.props.toJSON(),
					<span class="hljs-attr">multiple</span>: <span class="hljs-literal">true</span>
				}) );

				<span class="hljs-keyword">this</span>.controller.setState(<span class="hljs-string">'playlist-edit'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-173">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-173">&#182;</a>
              </div>
              <p>Keep focus inside media modal
after jumping to playlist view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.controller.modal.focusManager.focus();
			}
		});
	},

	<span class="hljs-attr">mainVideoPlaylistToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">this</span>.selectionStatusToolbar( view );

		view.set( <span class="hljs-string">'video-playlist'</span>, {
			<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
			<span class="hljs-attr">text</span>:     l10n.createNewVideoPlaylist,
			<span class="hljs-attr">priority</span>: <span class="hljs-number">100</span>,
			<span class="hljs-attr">requires</span>: { <span class="hljs-attr">selection</span>: <span class="hljs-literal">true</span> },

			<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">var</span> selection = controller.state().get(<span class="hljs-string">'selection'</span>),
					edit = controller.state(<span class="hljs-string">'video-playlist-edit'</span>),
					models = selection.where({ <span class="hljs-attr">type</span>: <span class="hljs-string">'video'</span> });

				edit.set( <span class="hljs-string">'library'</span>, <span class="hljs-keyword">new</span> wp.media.model.Selection( models, {
					<span class="hljs-attr">props</span>:    selection.props.toJSON(),
					<span class="hljs-attr">multiple</span>: <span class="hljs-literal">true</span>
				}) );

				<span class="hljs-keyword">this</span>.controller.setState(<span class="hljs-string">'video-playlist-edit'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-174">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-174">&#182;</a>
              </div>
              <p>Keep focus inside media modal
after jumping to video playlist view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.controller.modal.focusManager.focus();
			}
		});
	},

	<span class="hljs-attr">featuredImageToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> toolbar </span>) </span>{
		<span class="hljs-keyword">this</span>.createSelectToolbar( toolbar, {
			<span class="hljs-attr">text</span>:  l10n.setFeaturedImage,
			<span class="hljs-attr">state</span>: <span class="hljs-keyword">this</span>.options.state
		});
	},

	<span class="hljs-attr">mainEmbedToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> toolbar </span>) </span>{
		toolbar.view = <span class="hljs-keyword">new</span> wp.media.view.Toolbar.Embed({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>
		});
	},

	<span class="hljs-attr">galleryEditToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> editing = <span class="hljs-keyword">this</span>.state().get(<span class="hljs-string">'editing'</span>);
		<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-keyword">new</span> wp.media.view.Toolbar({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">items</span>: {
				<span class="hljs-attr">insert</span>: {
					<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
					<span class="hljs-attr">text</span>:     editing ? l10n.updateGallery : l10n.insertGallery,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,
					<span class="hljs-attr">requires</span>: { <span class="hljs-attr">library</span>: <span class="hljs-literal">true</span> },

					<span class="hljs-comment">/**
					 * @fires wp.media.controller.State#update
					 */</span>
					click: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>.controller,
							state = controller.state();

						controller.close();
						state.trigger( <span class="hljs-string">'update'</span>, state.get(<span class="hljs-string">'library'</span>) );</pre></div></div>
            
        </li>
        
        
        <li id="section-175">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-175">&#182;</a>
              </div>
              <p>Restore and reset the default state.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						controller.setState( controller.options.state );
						controller.reset();
					}
				}
			}
		}) );
	},

	<span class="hljs-attr">galleryAddToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-keyword">new</span> wp.media.view.Toolbar({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">items</span>: {
				<span class="hljs-attr">insert</span>: {
					<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
					<span class="hljs-attr">text</span>:     l10n.addToGallery,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,
					<span class="hljs-attr">requires</span>: { <span class="hljs-attr">selection</span>: <span class="hljs-literal">true</span> },

					<span class="hljs-comment">/**
					 * @fires wp.media.controller.State#reset
					 */</span>
					click: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>.controller,
							state = controller.state(),
							edit = controller.state(<span class="hljs-string">'gallery-edit'</span>);

						edit.get(<span class="hljs-string">'library'</span>).add( state.get(<span class="hljs-string">'selection'</span>).models );
						state.trigger(<span class="hljs-string">'reset'</span>);
						controller.setState(<span class="hljs-string">'gallery-edit'</span>);
					}
				}
			}
		}) );
	},

	<span class="hljs-attr">playlistEditToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> editing = <span class="hljs-keyword">this</span>.state().get(<span class="hljs-string">'editing'</span>);
		<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-keyword">new</span> wp.media.view.Toolbar({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">items</span>: {
				<span class="hljs-attr">insert</span>: {
					<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
					<span class="hljs-attr">text</span>:     editing ? l10n.updatePlaylist : l10n.insertPlaylist,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,
					<span class="hljs-attr">requires</span>: { <span class="hljs-attr">library</span>: <span class="hljs-literal">true</span> },

					<span class="hljs-comment">/**
					 * @fires wp.media.controller.State#update
					 */</span>
					click: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>.controller,
							state = controller.state();

						controller.close();
						state.trigger( <span class="hljs-string">'update'</span>, state.get(<span class="hljs-string">'library'</span>) );</pre></div></div>
            
        </li>
        
        
        <li id="section-176">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-176">&#182;</a>
              </div>
              <p>Restore and reset the default state.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						controller.setState( controller.options.state );
						controller.reset();
					}
				}
			}
		}) );
	},

	<span class="hljs-attr">playlistAddToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-keyword">new</span> wp.media.view.Toolbar({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">items</span>: {
				<span class="hljs-attr">insert</span>: {
					<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
					<span class="hljs-attr">text</span>:     l10n.addToPlaylist,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,
					<span class="hljs-attr">requires</span>: { <span class="hljs-attr">selection</span>: <span class="hljs-literal">true</span> },

					<span class="hljs-comment">/**
					 * @fires wp.media.controller.State#reset
					 */</span>
					click: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>.controller,
							state = controller.state(),
							edit = controller.state(<span class="hljs-string">'playlist-edit'</span>);

						edit.get(<span class="hljs-string">'library'</span>).add( state.get(<span class="hljs-string">'selection'</span>).models );
						state.trigger(<span class="hljs-string">'reset'</span>);
						controller.setState(<span class="hljs-string">'playlist-edit'</span>);
					}
				}
			}
		}) );
	},

	<span class="hljs-attr">videoPlaylistEditToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> editing = <span class="hljs-keyword">this</span>.state().get(<span class="hljs-string">'editing'</span>);
		<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-keyword">new</span> wp.media.view.Toolbar({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">items</span>: {
				<span class="hljs-attr">insert</span>: {
					<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
					<span class="hljs-attr">text</span>:     editing ? l10n.updateVideoPlaylist : l10n.insertVideoPlaylist,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">140</span>,
					<span class="hljs-attr">requires</span>: { <span class="hljs-attr">library</span>: <span class="hljs-literal">true</span> },

					<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>.controller,
							state = controller.state(),
							library = state.get(<span class="hljs-string">'library'</span>);

						library.type = <span class="hljs-string">'video'</span>;

						controller.close();
						state.trigger( <span class="hljs-string">'update'</span>, library );</pre></div></div>
            
        </li>
        
        
        <li id="section-177">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-177">&#182;</a>
              </div>
              <p>Restore and reset the default state.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						controller.setState( controller.options.state );
						controller.reset();
					}
				}
			}
		}) );
	},

	<span class="hljs-attr">videoPlaylistAddToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.toolbar.set( <span class="hljs-keyword">new</span> wp.media.view.Toolbar({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">items</span>: {
				<span class="hljs-attr">insert</span>: {
					<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
					<span class="hljs-attr">text</span>:     l10n.addToVideoPlaylist,
					<span class="hljs-attr">priority</span>: <span class="hljs-number">140</span>,
					<span class="hljs-attr">requires</span>: { <span class="hljs-attr">selection</span>: <span class="hljs-literal">true</span> },

					<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>.controller,
							state = controller.state(),
							edit = controller.state(<span class="hljs-string">'video-playlist-edit'</span>);

						edit.get(<span class="hljs-string">'library'</span>).add( state.get(<span class="hljs-string">'selection'</span>).models );
						state.trigger(<span class="hljs-string">'reset'</span>);
						controller.setState(<span class="hljs-string">'video-playlist-edit'</span>);
					}
				}
			}
		}) );
	}
});

<span class="hljs-built_in">module</span>.exports = Post;

},{}],<span class="hljs-number">46</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.MediaFrame.Select
 *
 * A frame for selecting an item or items from the media library.
 *
 * @class
 * @augments wp.media.view.MediaFrame
 * @augments wp.media.view.Frame
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 * @mixes wp.media.controller.StateMachine
 */</span>

<span class="hljs-keyword">var</span> MediaFrame = wp.media.view.MediaFrame,
	l10n = wp.media.view.l10n,
	Select;

Select = MediaFrame.extend({
	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-178">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-178">&#182;</a>
              </div>
              <p>Call ‘initialize’ directly on the parent class.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		MediaFrame.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );

		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">selection</span>: [],
			<span class="hljs-attr">library</span>:   {},
			<span class="hljs-attr">multiple</span>:  <span class="hljs-literal">false</span>,
			<span class="hljs-attr">state</span>:    <span class="hljs-string">'library'</span>
		});

		<span class="hljs-keyword">this</span>.createSelection();
		<span class="hljs-keyword">this</span>.createStates();
		<span class="hljs-keyword">this</span>.bindHandlers();
	},

	<span class="hljs-comment">/**
	 * Attach a selection collection to the frame.
	 *
	 * A selection is a collection of attachments used for a specific purpose
	 * by a media frame. e.g. Selecting an attachment (or many) to insert into
	 * post content.
	 *
	 * @see media.model.Selection
	 */</span>
	createSelection: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.options.selection;

		<span class="hljs-keyword">if</span> ( ! (selection <span class="hljs-keyword">instanceof</span> wp.media.model.Selection) ) {
			<span class="hljs-keyword">this</span>.options.selection = <span class="hljs-keyword">new</span> wp.media.model.Selection( selection, {
				<span class="hljs-attr">multiple</span>: <span class="hljs-keyword">this</span>.options.multiple
			});
		}

		<span class="hljs-keyword">this</span>._selection = {
			<span class="hljs-attr">attachments</span>: <span class="hljs-keyword">new</span> wp.media.model.Attachments(),
			<span class="hljs-attr">difference</span>: []
		};
	},

	<span class="hljs-comment">/**
	 * Create the default states on the frame.
	 */</span>
	createStates: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.states ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-179">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-179">&#182;</a>
              </div>
              <p>Add the default states.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.states.add([</pre></div></div>
            
        </li>
        
        
        <li id="section-180">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-180">&#182;</a>
              </div>
              <p>Main states.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">new</span> wp.media.controller.Library({
				<span class="hljs-attr">library</span>:   wp.media.query( options.library ),
				<span class="hljs-attr">multiple</span>:  options.multiple,
				<span class="hljs-attr">title</span>:     options.title,
				<span class="hljs-attr">priority</span>:  <span class="hljs-number">20</span>
			})
		]);
	},

	<span class="hljs-comment">/**
	 * Bind region mode event callbacks.
	 *
	 * @see media.controller.Region.render
	 */</span>
	bindHandlers: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'router:create:browse'</span>, <span class="hljs-keyword">this</span>.createRouter, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'router:render:browse'</span>, <span class="hljs-keyword">this</span>.browseRouter, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'content:create:browse'</span>, <span class="hljs-keyword">this</span>.browseContent, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'content:render:upload'</span>, <span class="hljs-keyword">this</span>.uploadContent, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'toolbar:create:select'</span>, <span class="hljs-keyword">this</span>.createSelectToolbar, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-comment">/**
	 * Render callback for the router region in the `browse` mode.
	 *
	 * @param {wp.media.view.Router} routerView
	 */</span>
	browseRouter: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> routerView </span>) </span>{
		routerView.set({
			<span class="hljs-attr">upload</span>: {
				<span class="hljs-attr">text</span>:     l10n.uploadFilesTitle,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>
			},
			<span class="hljs-attr">browse</span>: {
				<span class="hljs-attr">text</span>:     l10n.mediaLibraryTitle,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">40</span>
			}
		});
	},

	<span class="hljs-comment">/**
	 * Render callback for the content region in the `browse` mode.
	 *
	 * @param {wp.media.controller.Region} contentRegion
	 */</span>
	browseContent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> contentRegion </span>) </span>{
		<span class="hljs-keyword">var</span> state = <span class="hljs-keyword">this</span>.state();

		<span class="hljs-keyword">this</span>.$el.removeClass(<span class="hljs-string">'hide-toolbar'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-181">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-181">&#182;</a>
              </div>
              <p>Browse our library of attachments.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		contentRegion.view = <span class="hljs-keyword">new</span> wp.media.view.AttachmentsBrowser({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">collection</span>: state.get(<span class="hljs-string">'library'</span>),
			<span class="hljs-attr">selection</span>:  state.get(<span class="hljs-string">'selection'</span>),
			<span class="hljs-attr">model</span>:      state,
			<span class="hljs-attr">sortable</span>:   state.get(<span class="hljs-string">'sortable'</span>),
			<span class="hljs-attr">search</span>:     state.get(<span class="hljs-string">'searchable'</span>),
			<span class="hljs-attr">filters</span>:    state.get(<span class="hljs-string">'filterable'</span>),
			<span class="hljs-attr">date</span>:       state.get(<span class="hljs-string">'date'</span>),
			<span class="hljs-attr">display</span>:    state.has(<span class="hljs-string">'display'</span>) ? state.get(<span class="hljs-string">'display'</span>) : state.get(<span class="hljs-string">'displaySettings'</span>),
			<span class="hljs-attr">dragInfo</span>:   state.get(<span class="hljs-string">'dragInfo'</span>),

			<span class="hljs-attr">idealColumnWidth</span>: state.get(<span class="hljs-string">'idealColumnWidth'</span>),
			<span class="hljs-attr">suggestedWidth</span>:   state.get(<span class="hljs-string">'suggestedWidth'</span>),
			<span class="hljs-attr">suggestedHeight</span>:  state.get(<span class="hljs-string">'suggestedHeight'</span>),

			<span class="hljs-attr">AttachmentView</span>: state.get(<span class="hljs-string">'AttachmentView'</span>)
		});
	},

	<span class="hljs-comment">/**
	 * Render callback for the content region in the `upload` mode.
	 */</span>
	uploadContent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$el.removeClass( <span class="hljs-string">'hide-toolbar'</span> );
		<span class="hljs-keyword">this</span>.content.set( <span class="hljs-keyword">new</span> wp.media.view.UploaderInline({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>
		}) );
	},

	<span class="hljs-comment">/**
	 * Toolbars
	 *
	 * @param {Object} toolbar
	 * @param {Object} [options={}]
	 * @this wp.media.controller.Region
	 */</span>
	createSelectToolbar: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> toolbar, options </span>) </span>{
		options = options || <span class="hljs-keyword">this</span>.options.button || {};
		options.controller = <span class="hljs-keyword">this</span>;

		toolbar.view = <span class="hljs-keyword">new</span> wp.media.view.Toolbar.Select( options );
	}
});

<span class="hljs-built_in">module</span>.exports = Select;

},{}],<span class="hljs-number">47</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Iframe
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Iframe = wp.media.View.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'media-iframe'</span>,
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.Iframe} Returns itself to allow chaining
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.views.detach();
		<span class="hljs-keyword">this</span>.$el.html( <span class="hljs-string">'&lt;iframe src="'</span> + <span class="hljs-keyword">this</span>.controller.state().get(<span class="hljs-string">'src'</span>) + <span class="hljs-string">'" /&gt;'</span> );
		<span class="hljs-keyword">this</span>.views.render();
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	}
});

<span class="hljs-built_in">module</span>.exports = Iframe;

},{}],<span class="hljs-number">48</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.ImageDetails
 *
 * @class
 * @augments wp.media.view.Settings.AttachmentDisplay
 * @augments wp.media.view.Settings
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> AttachmentDisplay = wp.media.view.Settings.AttachmentDisplay,
	$ = jQuery,
	ImageDetails;

ImageDetails = AttachmentDisplay.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'image-details'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'image-details'</span>),
	<span class="hljs-attr">events</span>: _.defaults( AttachmentDisplay.prototype.events, {
		<span class="hljs-string">'click .edit-attachment'</span>: <span class="hljs-string">'editAttachment'</span>,
		<span class="hljs-string">'click .replace-attachment'</span>: <span class="hljs-string">'replaceAttachment'</span>,
		<span class="hljs-string">'click .advanced-toggle'</span>: <span class="hljs-string">'onToggleAdvanced'</span>,
		<span class="hljs-string">'change [data-setting="customWidth"]'</span>: <span class="hljs-string">'onCustomSize'</span>,
		<span class="hljs-string">'change [data-setting="customHeight"]'</span>: <span class="hljs-string">'onCustomSize'</span>,
		<span class="hljs-string">'keyup [data-setting="customWidth"]'</span>: <span class="hljs-string">'onCustomSize'</span>,
		<span class="hljs-string">'keyup [data-setting="customHeight"]'</span>: <span class="hljs-string">'onCustomSize'</span>
	} ),
	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-182">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-182">&#182;</a>
              </div>
              <p>used in AttachmentDisplay.prototype.updateLinkTo</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.options.attachment = <span class="hljs-keyword">this</span>.model.attachment;
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:url'</span>, <span class="hljs-keyword">this</span>.updateUrl );
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:link'</span>, <span class="hljs-keyword">this</span>.toggleLinkSettings );
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:size'</span>, <span class="hljs-keyword">this</span>.toggleCustomSize );

		AttachmentDisplay.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-attr">prepare</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> attachment = <span class="hljs-literal">false</span>;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.model.attachment ) {
			attachment = <span class="hljs-keyword">this</span>.model.attachment.toJSON();
		}
		<span class="hljs-keyword">return</span> _.defaults({
			<span class="hljs-attr">model</span>: <span class="hljs-keyword">this</span>.model.toJSON(),
			<span class="hljs-attr">attachment</span>: attachment
		}, <span class="hljs-keyword">this</span>.options );
	},

	<span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> args = <span class="hljs-built_in">arguments</span>;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.model.attachment &amp;&amp; <span class="hljs-string">'pending'</span> === <span class="hljs-keyword">this</span>.model.dfd.state() ) {
			<span class="hljs-keyword">this</span>.model.dfd
				.done( _.bind( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					AttachmentDisplay.prototype.render.apply( <span class="hljs-keyword">this</span>, args );
					<span class="hljs-keyword">this</span>.postRender();
				}, <span class="hljs-keyword">this</span> ) )
				.fail( _.bind( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					<span class="hljs-keyword">this</span>.model.attachment = <span class="hljs-literal">false</span>;
					AttachmentDisplay.prototype.render.apply( <span class="hljs-keyword">this</span>, args );
					<span class="hljs-keyword">this</span>.postRender();
				}, <span class="hljs-keyword">this</span> ) );
		} <span class="hljs-keyword">else</span> {
			AttachmentDisplay.prototype.render.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
			<span class="hljs-keyword">this</span>.postRender();
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">postRender</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		setTimeout( _.bind( <span class="hljs-keyword">this</span>.resetFocus, <span class="hljs-keyword">this</span> ), <span class="hljs-number">10</span> );
		<span class="hljs-keyword">this</span>.toggleLinkSettings();
		<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">window</span>.getUserSetting( <span class="hljs-string">'advImgDetails'</span> ) === <span class="hljs-string">'show'</span> ) {
			<span class="hljs-keyword">this</span>.toggleAdvanced( <span class="hljs-literal">true</span> );
		}
		<span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'post-render'</span> );
	},

	<span class="hljs-attr">resetFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.link-to-custom'</span> ).blur();
		<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.embed-media-settings'</span> ).scrollTop( <span class="hljs-number">0</span> );
	},

	<span class="hljs-attr">updateUrl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.image img'</span> ).attr( <span class="hljs-string">'src'</span>, <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'url'</span> ) );
		<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.url'</span> ).val( <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'url'</span> ) );
	},

	<span class="hljs-attr">toggleLinkSettings</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'link'</span> ) === <span class="hljs-string">'none'</span> ) {
			<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.link-settings'</span> ).addClass(<span class="hljs-string">'hidden'</span>);
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.link-settings'</span> ).removeClass(<span class="hljs-string">'hidden'</span>);
		}
	},

	<span class="hljs-attr">toggleCustomSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'size'</span> ) !== <span class="hljs-string">'custom'</span> ) {
			<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.custom-size'</span> ).addClass(<span class="hljs-string">'hidden'</span>);
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.custom-size'</span> ).removeClass(<span class="hljs-string">'hidden'</span>);
		}
	},

	<span class="hljs-attr">onCustomSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> dimension = $( event.target ).data(<span class="hljs-string">'setting'</span>),
			num = $( event.target ).val(),
			value;</pre></div></div>
            
        </li>
        
        
        <li id="section-183">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-183">&#182;</a>
              </div>
              <p>Ignore bogus input</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-regexp">/^\d+/</span>.test( num ) || <span class="hljs-built_in">parseInt</span>( num, <span class="hljs-number">10</span> ) &lt; <span class="hljs-number">1</span> ) {
			event.preventDefault();
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( dimension === <span class="hljs-string">'customWidth'</span> ) {
			value = <span class="hljs-built_in">Math</span>.round( <span class="hljs-number">1</span> / <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'aspectRatio'</span> ) * num );
			<span class="hljs-keyword">this</span>.model.set( <span class="hljs-string">'customHeight'</span>, value, { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> } );
			<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'[data-setting="customHeight"]'</span> ).val( value );
		} <span class="hljs-keyword">else</span> {
			value = <span class="hljs-built_in">Math</span>.round( <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'aspectRatio'</span> ) * num );
			<span class="hljs-keyword">this</span>.model.set( <span class="hljs-string">'customWidth'</span>, value, { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span>  } );
			<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'[data-setting="customWidth"]'</span> ).val( value );
		}
	},

	<span class="hljs-attr">onToggleAdvanced</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		event.preventDefault();
		<span class="hljs-keyword">this</span>.toggleAdvanced();
	},

	<span class="hljs-attr">toggleAdvanced</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> show </span>) </span>{
		<span class="hljs-keyword">var</span> $advanced = <span class="hljs-keyword">this</span>.$el.find( <span class="hljs-string">'.advanced-section'</span> ),
			mode;

		<span class="hljs-keyword">if</span> ( $advanced.hasClass(<span class="hljs-string">'advanced-visible'</span>) || show === <span class="hljs-literal">false</span> ) {
			$advanced.removeClass(<span class="hljs-string">'advanced-visible'</span>);
			$advanced.find(<span class="hljs-string">'.advanced-settings'</span>).addClass(<span class="hljs-string">'hidden'</span>);
			mode = <span class="hljs-string">'hide'</span>;
		} <span class="hljs-keyword">else</span> {
			$advanced.addClass(<span class="hljs-string">'advanced-visible'</span>);
			$advanced.find(<span class="hljs-string">'.advanced-settings'</span>).removeClass(<span class="hljs-string">'hidden'</span>);
			mode = <span class="hljs-string">'show'</span>;
		}

		<span class="hljs-built_in">window</span>.setUserSetting( <span class="hljs-string">'advImgDetails'</span>, mode );
	},

	<span class="hljs-attr">editAttachment</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> editState = <span class="hljs-keyword">this</span>.controller.states.get( <span class="hljs-string">'edit-image'</span> );

		<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">window</span>.imageEdit &amp;&amp; editState ) {
			event.preventDefault();
			editState.set( <span class="hljs-string">'image'</span>, <span class="hljs-keyword">this</span>.model.attachment );
			<span class="hljs-keyword">this</span>.controller.setState( <span class="hljs-string">'edit-image'</span> );
		}
	},

	<span class="hljs-attr">replaceAttachment</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		event.preventDefault();
		<span class="hljs-keyword">this</span>.controller.setState( <span class="hljs-string">'replace-image'</span> );
	}
});

<span class="hljs-built_in">module</span>.exports = ImageDetails;

},{}],<span class="hljs-number">49</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Label
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Label = wp.media.View.extend({
	<span class="hljs-attr">tagName</span>: <span class="hljs-string">'label'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'screen-reader-text'</span>,

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.value = <span class="hljs-keyword">this</span>.options.value;
	},

	<span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$el.html( <span class="hljs-keyword">this</span>.value );

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	}
});

<span class="hljs-built_in">module</span>.exports = Label;

},{}],<span class="hljs-number">50</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.MediaFrame
 *
 * The frame used to create the media modal.
 *
 * @class
 * @augments wp.media.view.Frame
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 * @mixes wp.media.controller.StateMachine
 */</span>
<span class="hljs-keyword">var</span> Frame = wp.media.view.Frame,
	$ = jQuery,
	MediaFrame;

MediaFrame = Frame.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'media-frame'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'media-frame'</span>),
	<span class="hljs-attr">regions</span>:   [<span class="hljs-string">'menu'</span>,<span class="hljs-string">'title'</span>,<span class="hljs-string">'content'</span>,<span class="hljs-string">'toolbar'</span>,<span class="hljs-string">'router'</span>],

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'click div.media-frame-title h1'</span>: <span class="hljs-string">'toggleMenu'</span>
	},

	<span class="hljs-comment">/**
	 * @global wp.Uploader
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		Frame.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );

		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">title</span>:    <span class="hljs-string">''</span>,
			<span class="hljs-attr">modal</span>:    <span class="hljs-literal">true</span>,
			<span class="hljs-attr">uploader</span>: <span class="hljs-literal">true</span>
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-184">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-184">&#182;</a>
              </div>
              <p>Ensure core UI is enabled.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.$el.addClass(<span class="hljs-string">'wp-core-ui'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-185">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-185">&#182;</a>
              </div>
              <p>Initialize modal container view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.modal ) {
			<span class="hljs-keyword">this</span>.modal = <span class="hljs-keyword">new</span> wp.media.view.Modal({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
				<span class="hljs-attr">title</span>:      <span class="hljs-keyword">this</span>.options.title
			});

			<span class="hljs-keyword">this</span>.modal.content( <span class="hljs-keyword">this</span> );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-186">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-186">&#182;</a>
              </div>
              <p>Force the uploader off if the upload limit has been exceeded or
if the browser isn’t supported.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( wp.Uploader.limitExceeded || ! wp.Uploader.browser.supported ) {
			<span class="hljs-keyword">this</span>.options.uploader = <span class="hljs-literal">false</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-187">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-187">&#182;</a>
              </div>
              <p>Initialize window-wide uploader.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.uploader ) {
			<span class="hljs-keyword">this</span>.uploader = <span class="hljs-keyword">new</span> wp.media.view.UploaderWindow({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
				<span class="hljs-attr">uploader</span>: {
					<span class="hljs-attr">dropzone</span>:  <span class="hljs-keyword">this</span>.modal ? <span class="hljs-keyword">this</span>.modal.$el : <span class="hljs-keyword">this</span>.$el,
					<span class="hljs-attr">container</span>: <span class="hljs-keyword">this</span>.$el
				}
			});
			<span class="hljs-keyword">this</span>.views.set( <span class="hljs-string">'.media-frame-uploader'</span>, <span class="hljs-keyword">this</span>.uploader );
		}

		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'attach'</span>, _.bind( <span class="hljs-keyword">this</span>.views.ready, <span class="hljs-keyword">this</span>.views ), <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-188">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-188">&#182;</a>
              </div>
              <p>Bind default title creation.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'title:create:default'</span>, <span class="hljs-keyword">this</span>.createTitle, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.title.mode(<span class="hljs-string">'default'</span>);

		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'title:render'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
			view.$el.append( <span class="hljs-string">'&lt;span class="dashicons dashicons-arrow-down"&gt;&lt;/span&gt;'</span> );
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-189">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-189">&#182;</a>
              </div>
              <p>Bind default menu.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'menu:create:default'</span>, <span class="hljs-keyword">this</span>.createMenu, <span class="hljs-keyword">this</span> );
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.MediaFrame} Returns itself to allow chaining
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-190">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-190">&#182;</a>
              </div>
              <p>Activate the default state if no active state exists.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.state() &amp;&amp; <span class="hljs-keyword">this</span>.options.state ) {
			<span class="hljs-keyword">this</span>.setState( <span class="hljs-keyword">this</span>.options.state );
		}
		<span class="hljs-comment">/**
		 * call 'render' directly on the parent class
		 */</span>
		<span class="hljs-keyword">return</span> Frame.prototype.render.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},
	<span class="hljs-comment">/**
	 * @param {Object} title
	 * @this wp.media.controller.Region
	 */</span>
	createTitle: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> title </span>) </span>{
		title.view = <span class="hljs-keyword">new</span> wp.media.View({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
			<span class="hljs-attr">tagName</span>: <span class="hljs-string">'h1'</span>
		});
	},
	<span class="hljs-comment">/**
	 * @param {Object} menu
	 * @this wp.media.controller.Region
	 */</span>
	createMenu: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> menu </span>) </span>{
		menu.view = <span class="hljs-keyword">new</span> wp.media.view.Menu({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>
		});
	},

	<span class="hljs-attr">toggleMenu</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$el.find( <span class="hljs-string">'.media-menu'</span> ).toggleClass( <span class="hljs-string">'visible'</span> );
	},

	<span class="hljs-comment">/**
	 * @param {Object} toolbar
	 * @this wp.media.controller.Region
	 */</span>
	createToolbar: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> toolbar </span>) </span>{
		toolbar.view = <span class="hljs-keyword">new</span> wp.media.view.Toolbar({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>
		});
	},
	<span class="hljs-comment">/**
	 * @param {Object} router
	 * @this wp.media.controller.Region
	 */</span>
	createRouter: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> router </span>) </span>{
		router.view = <span class="hljs-keyword">new</span> wp.media.view.Router({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>
		});
	},
	<span class="hljs-comment">/**
	 * @param {Object} options
	 */</span>
	createIframeStates: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">var</span> settings = wp.media.view.settings,
			tabs = settings.tabs,
			tabUrl = settings.tabUrl,
			$postId;

		<span class="hljs-keyword">if</span> ( ! tabs || ! tabUrl ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-191">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-191">&#182;</a>
              </div>
              <p>Add the post ID to the tab URL if it exists.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$postId = $(<span class="hljs-string">'#post_ID'</span>);
		<span class="hljs-keyword">if</span> ( $postId.length ) {
			tabUrl += <span class="hljs-string">'&amp;post_id='</span> + $postId.val();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-192">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-192">&#182;</a>
              </div>
              <p>Generate the tab states.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_.each( tabs, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> title, id </span>) </span>{
			<span class="hljs-keyword">this</span>.state( <span class="hljs-string">'iframe:'</span> + id ).set( _.defaults({
				<span class="hljs-attr">tab</span>:     id,
				<span class="hljs-attr">src</span>:     tabUrl + <span class="hljs-string">'&amp;tab='</span> + id,
				<span class="hljs-attr">title</span>:   title,
				<span class="hljs-attr">content</span>: <span class="hljs-string">'iframe'</span>,
				<span class="hljs-attr">menu</span>:    <span class="hljs-string">'default'</span>
			}, options ) );
		}, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'content:create:iframe'</span>, <span class="hljs-keyword">this</span>.iframeContent, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'content:deactivate:iframe'</span>, <span class="hljs-keyword">this</span>.iframeContentCleanup, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'menu:render:default'</span>, <span class="hljs-keyword">this</span>.iframeMenu, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'open'</span>, <span class="hljs-keyword">this</span>.hijackThickbox, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'close'</span>, <span class="hljs-keyword">this</span>.restoreThickbox, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-comment">/**
	 * @param {Object} content
	 * @this wp.media.controller.Region
	 */</span>
	iframeContent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> content </span>) </span>{
		<span class="hljs-keyword">this</span>.$el.addClass(<span class="hljs-string">'hide-toolbar'</span>);
		content.view = <span class="hljs-keyword">new</span> wp.media.view.Iframe({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>
		});
	},

	<span class="hljs-attr">iframeContentCleanup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$el.removeClass(<span class="hljs-string">'hide-toolbar'</span>);
	},

	<span class="hljs-attr">iframeMenu</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view </span>) </span>{
		<span class="hljs-keyword">var</span> views = {};

		<span class="hljs-keyword">if</span> ( ! view ) {
			<span class="hljs-keyword">return</span>;
		}

		_.each( wp.media.view.settings.tabs, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> title, id </span>) </span>{
			views[ <span class="hljs-string">'iframe:'</span> + id ] = {
				<span class="hljs-attr">text</span>: <span class="hljs-keyword">this</span>.state( <span class="hljs-string">'iframe:'</span> + id ).get(<span class="hljs-string">'title'</span>),
				<span class="hljs-attr">priority</span>: <span class="hljs-number">200</span>
			};
		}, <span class="hljs-keyword">this</span> );

		view.set( views );
	},

	<span class="hljs-attr">hijackThickbox</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> frame = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-built_in">window</span>.tb_remove || <span class="hljs-keyword">this</span>._tb_remove ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>._tb_remove = <span class="hljs-built_in">window</span>.tb_remove;
		<span class="hljs-built_in">window</span>.tb_remove = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			frame.close();
			frame.reset();
			frame.setState( frame.options.state );
			frame._tb_remove.call( <span class="hljs-built_in">window</span> );
		};
	},

	<span class="hljs-attr">restoreThickbox</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>._tb_remove ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-built_in">window</span>.tb_remove = <span class="hljs-keyword">this</span>._tb_remove;
		<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._tb_remove;
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-193">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-193">&#182;</a>
              </div>
              <p>Map some of the modal’s methods to the frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>_.each([<span class="hljs-string">'open'</span>,<span class="hljs-string">'close'</span>,<span class="hljs-string">'attach'</span>,<span class="hljs-string">'detach'</span>,<span class="hljs-string">'escape'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> method </span>) </span>{
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.MediaFrame} Returns itself to allow chaining
	 */</span>
	MediaFrame.prototype[ method ] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.modal ) {
			<span class="hljs-keyword">this</span>.modal[ method ].apply( <span class="hljs-keyword">this</span>.modal, <span class="hljs-built_in">arguments</span> );
		}
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	};
});

<span class="hljs-built_in">module</span>.exports = MediaFrame;

},{}],<span class="hljs-number">51</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.MenuItem
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> $ = jQuery,
	MenuItem;

MenuItem = wp.media.View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'a'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'media-menu-item'</span>,

	<span class="hljs-attr">attributes</span>: {
		<span class="hljs-attr">href</span>: <span class="hljs-string">'#'</span>
	},

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'click'</span>: <span class="hljs-string">'_click'</span>
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	_click: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> clickOverride = <span class="hljs-keyword">this</span>.options.click;

		<span class="hljs-keyword">if</span> ( event ) {
			event.preventDefault();
		}

		<span class="hljs-keyword">if</span> ( clickOverride ) {
			clickOverride.call( <span class="hljs-keyword">this</span> );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.click();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-194">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-194">&#182;</a>
              </div>
              <p>When selecting a tab along the left side,
focus should be transferred into the main panel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! wp.media.isTouchDevice ) {
			$(<span class="hljs-string">'.media-frame-content input'</span>).first().focus();
		}
	},

	<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> state = <span class="hljs-keyword">this</span>.options.state;

		<span class="hljs-keyword">if</span> ( state ) {
			<span class="hljs-keyword">this</span>.controller.setState( state );
			<span class="hljs-keyword">this</span>.views.parent.$el.removeClass( <span class="hljs-string">'visible'</span> ); <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> or hide on any click, see below</span>
		}
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.MenuItem} returns itself to allow chaining
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options;

		<span class="hljs-keyword">if</span> ( options.text ) {
			<span class="hljs-keyword">this</span>.$el.text( options.text );
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( options.html ) {
			<span class="hljs-keyword">this</span>.$el.html( options.html );
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	}
});

<span class="hljs-built_in">module</span>.exports = MenuItem;

},{}],<span class="hljs-number">52</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Menu
 *
 * @class
 * @augments wp.media.view.PriorityList
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> MenuItem = wp.media.view.MenuItem,
	PriorityList = wp.media.view.PriorityList,
	Menu;

Menu = PriorityList.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'div'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'media-menu'</span>,
	<span class="hljs-attr">property</span>:  <span class="hljs-string">'state'</span>,
	<span class="hljs-attr">ItemView</span>:  MenuItem,
	<span class="hljs-attr">region</span>:    <span class="hljs-string">'menu'</span>,

	<span class="hljs-comment">/* <span class="hljs-doctag">TODO:</span> alternatively hide on any click anywhere
	events: {
		'click': 'click'
	},

	click: function() {
		this.$el.removeClass( 'visible' );
	},
	*/</span>

	<span class="hljs-comment">/**
	 * @param {Object} options
	 * @param {string} id
	 * @returns {wp.media.View}
	 */</span>
	toView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options, id </span>) </span>{
		options = options || {};
		options[ <span class="hljs-keyword">this</span>.property ] = options[ <span class="hljs-keyword">this</span>.property ] || id;
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">this</span>.ItemView( options ).render();
	},

	<span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-comment">/**
		 * call 'ready' directly on the parent class
		 */</span>
		PriorityList.prototype.ready.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">this</span>.visibility();
	},

	<span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-comment">/**
		 * call 'set' directly on the parent class
		 */</span>
		PriorityList.prototype.set.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">this</span>.visibility();
	},

	<span class="hljs-attr">unset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-comment">/**
		 * call 'unset' directly on the parent class
		 */</span>
		PriorityList.prototype.unset.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">this</span>.visibility();
	},

	<span class="hljs-attr">visibility</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> region = <span class="hljs-keyword">this</span>.region,
			view = <span class="hljs-keyword">this</span>.controller[ region ].get(),
			views = <span class="hljs-keyword">this</span>.views.get(),
			hide = ! views || views.length &lt; <span class="hljs-number">2</span>;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span> === view ) {
			<span class="hljs-keyword">this</span>.controller.$el.toggleClass( <span class="hljs-string">'hide-'</span> + region, hide );
		}
	},
	<span class="hljs-comment">/**
	 * @param {string} id
	 */</span>
	select: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
		<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>.get( id );

		<span class="hljs-keyword">if</span> ( ! view ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.deselect();
		view.$el.addClass(<span class="hljs-string">'active'</span>);
	},

	<span class="hljs-attr">deselect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$el.children().removeClass(<span class="hljs-string">'active'</span>);
	},

	<span class="hljs-attr">hide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
		<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>.get( id );

		<span class="hljs-keyword">if</span> ( ! view ) {
			<span class="hljs-keyword">return</span>;
		}

		view.$el.addClass(<span class="hljs-string">'hidden'</span>);
	},

	<span class="hljs-attr">show</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
		<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>.get( id );

		<span class="hljs-keyword">if</span> ( ! view ) {
			<span class="hljs-keyword">return</span>;
		}

		view.$el.removeClass(<span class="hljs-string">'hidden'</span>);
	}
});

<span class="hljs-built_in">module</span>.exports = Menu;

},{}],<span class="hljs-number">53</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Modal
 *
 * A modal view, which the media modal uses as its default container.
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> $ = jQuery,
	Modal;

Modal = wp.media.View.extend({
	<span class="hljs-attr">tagName</span>:  <span class="hljs-string">'div'</span>,
	<span class="hljs-attr">template</span>: wp.template(<span class="hljs-string">'media-modal'</span>),

	<span class="hljs-attr">attributes</span>: {
		<span class="hljs-attr">tabindex</span>: <span class="hljs-number">0</span>
	},

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'click .media-modal-backdrop, .media-modal-close'</span>: <span class="hljs-string">'escapeHandler'</span>,
		<span class="hljs-string">'keydown'</span>: <span class="hljs-string">'keydown'</span>
	},

	<span class="hljs-attr">clickedOpenerEl</span>: <span class="hljs-literal">null</span>,

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">container</span>: <span class="hljs-built_in">document</span>.body,
			<span class="hljs-attr">title</span>:     <span class="hljs-string">''</span>,
			<span class="hljs-attr">propagate</span>: <span class="hljs-literal">true</span>,
			<span class="hljs-attr">freeze</span>:    <span class="hljs-literal">true</span>
		});

		<span class="hljs-keyword">this</span>.focusManager = <span class="hljs-keyword">new</span> wp.media.view.FocusManager({
			<span class="hljs-attr">el</span>: <span class="hljs-keyword">this</span>.el
		});
	},
	<span class="hljs-comment">/**
	 * @returns {Object}
	 */</span>
	prepare: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> {
			<span class="hljs-attr">title</span>: <span class="hljs-keyword">this</span>.options.title
		};
	},

	<span class="hljs-comment">/**
	 * @returns {wp.media.view.Modal} Returns itself to allow chaining
	 */</span>
	attach: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.views.attached ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.views.rendered ) {
			<span class="hljs-keyword">this</span>.render();
		}

		<span class="hljs-keyword">this</span>.$el.appendTo( <span class="hljs-keyword">this</span>.options.container );</pre></div></div>
            
        </li>
        
        
        <li id="section-195">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-195">&#182;</a>
              </div>
              <p>Manually mark the view as attached and trigger ready.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.views.attached = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">this</span>.views.ready();

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.propagate(<span class="hljs-string">'attach'</span>);
	},

	<span class="hljs-comment">/**
	 * @returns {wp.media.view.Modal} Returns itself to allow chaining
	 */</span>
	detach: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.$el.is(<span class="hljs-string">':visible'</span>) ) {
			<span class="hljs-keyword">this</span>.close();
		}

		<span class="hljs-keyword">this</span>.$el.detach();
		<span class="hljs-keyword">this</span>.views.attached = <span class="hljs-literal">false</span>;
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.propagate(<span class="hljs-string">'detach'</span>);
	},

	<span class="hljs-comment">/**
	 * @returns {wp.media.view.Modal} Returns itself to allow chaining
	 */</span>
	open: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> $el = <span class="hljs-keyword">this</span>.$el,
			options = <span class="hljs-keyword">this</span>.options,
			mceEditor;

		<span class="hljs-keyword">if</span> ( $el.is(<span class="hljs-string">':visible'</span>) ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}

		<span class="hljs-keyword">this</span>.clickedOpenerEl = <span class="hljs-built_in">document</span>.activeElement;

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.views.attached ) {
			<span class="hljs-keyword">this</span>.attach();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-196">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-196">&#182;</a>
              </div>
              <p>If the <code>freeze</code> option is set, record the window’s scroll position.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( options.freeze ) {
			<span class="hljs-keyword">this</span>._freeze = {
				<span class="hljs-attr">scrollTop</span>: $( <span class="hljs-built_in">window</span> ).scrollTop()
			};
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-197">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-197">&#182;</a>
              </div>
              <p>Disable page scrolling.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$( <span class="hljs-string">'body'</span> ).addClass( <span class="hljs-string">'modal-open'</span> );

		$el.show();</pre></div></div>
            
        </li>
        
        
        <li id="section-198">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-198">&#182;</a>
              </div>
              <p>Try to close the onscreen keyboard</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'ontouchend'</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">document</span> ) {
			<span class="hljs-keyword">if</span> ( ( mceEditor = <span class="hljs-built_in">window</span>.tinymce &amp;&amp; <span class="hljs-built_in">window</span>.tinymce.activeEditor )  &amp;&amp; ! mceEditor.isHidden() &amp;&amp; mceEditor.iframeElement ) {
				mceEditor.iframeElement.focus();
				mceEditor.iframeElement.blur();

				setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					mceEditor.iframeElement.blur();
				}, <span class="hljs-number">100</span> );
			}
		}

		<span class="hljs-keyword">this</span>.$el.focus();

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.propagate(<span class="hljs-string">'open'</span>);
	},

	<span class="hljs-comment">/**
	 * @param {Object} options
	 * @returns {wp.media.view.Modal} Returns itself to allow chaining
	 */</span>
	close: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">var</span> freeze = <span class="hljs-keyword">this</span>._freeze;

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.views.attached || ! <span class="hljs-keyword">this</span>.$el.is(<span class="hljs-string">':visible'</span>) ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-199">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-199">&#182;</a>
              </div>
              <p>Enable page scrolling.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$( <span class="hljs-string">'body'</span> ).removeClass( <span class="hljs-string">'modal-open'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-200">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-200">&#182;</a>
              </div>
              <p>Hide modal and remove restricted media modal tab focus once it’s closed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.$el.hide().undelegate( <span class="hljs-string">'keydown'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-201">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-201">&#182;</a>
              </div>
              <p>Put focus back in useful location once modal is closed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-literal">null</span> !== <span class="hljs-keyword">this</span>.clickedOpenerEl ) {
			<span class="hljs-keyword">this</span>.clickedOpenerEl.focus();
		} <span class="hljs-keyword">else</span> {
			$( <span class="hljs-string">'#wpbody-content'</span> ).focus();
		}

		<span class="hljs-keyword">this</span>.propagate(<span class="hljs-string">'close'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-202">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-202">&#182;</a>
              </div>
              <p>If the <code>freeze</code> option is set, restore the container’s scroll position.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( freeze ) {
			$( <span class="hljs-built_in">window</span> ).scrollTop( freeze.scrollTop );
		}

		<span class="hljs-keyword">if</span> ( options &amp;&amp; options.escape ) {
			<span class="hljs-keyword">this</span>.propagate(<span class="hljs-string">'escape'</span>);
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.Modal} Returns itself to allow chaining
	 */</span>
	<span class="hljs-built_in">escape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.close({ <span class="hljs-attr">escape</span>: <span class="hljs-literal">true</span> });
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	escapeHandler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		event.preventDefault();
		<span class="hljs-keyword">this</span>.escape();
	},

	<span class="hljs-comment">/**
	 * @param {Array|Object} content Views to register to '.media-modal-content'
	 * @returns {wp.media.view.Modal} Returns itself to allow chaining
	 */</span>
	content: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> content </span>) </span>{
		<span class="hljs-keyword">this</span>.views.set( <span class="hljs-string">'.media-modal-content'</span>, content );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-comment">/**
	 * Triggers a modal event and if the `propagate` option is set,
	 * forwards events to the modal's controller.
	 *
	 * @param {string} id
	 * @returns {wp.media.view.Modal} Returns itself to allow chaining
	 */</span>
	propagate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
		<span class="hljs-keyword">this</span>.trigger( id );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.propagate ) {
			<span class="hljs-keyword">this</span>.controller.trigger( id );
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	keydown: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-203">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-203">&#182;</a>
              </div>
              <p>Close the modal when escape is pressed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-number">27</span> === event.which &amp;&amp; <span class="hljs-keyword">this</span>.$el.is(<span class="hljs-string">':visible'</span>) ) {
			<span class="hljs-keyword">this</span>.escape();
			event.stopImmediatePropagation();
		}
	}
});

<span class="hljs-built_in">module</span>.exports = Modal;

},{}],<span class="hljs-number">54</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.PriorityList
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> PriorityList = wp.media.View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'div'</span>,

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>._views = {};

		<span class="hljs-keyword">this</span>.set( _.extend( {}, <span class="hljs-keyword">this</span>._views, <span class="hljs-keyword">this</span>.options.views ), { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> });
		<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.options.views;

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.options.silent ) {
			<span class="hljs-keyword">this</span>.render();
		}
	},
	<span class="hljs-comment">/**
	 * @param {string} id
	 * @param {wp.media.View|Object} view
	 * @param {Object} options
	 * @returns {wp.media.view.PriorityList} Returns itself to allow chaining
	 */</span>
	set: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id, view, options </span>) </span>{
		<span class="hljs-keyword">var</span> priority, views, index;

		options = options || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-204">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-204">&#182;</a>
              </div>
              <p>Accept an object with an <code>id</code> : <code>view</code> mapping.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( _.isObject( id ) ) {
			_.each( id, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view, id </span>) </span>{
				<span class="hljs-keyword">this</span>.set( id, view );
			}, <span class="hljs-keyword">this</span> );
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}

		<span class="hljs-keyword">if</span> ( ! (view <span class="hljs-keyword">instanceof</span> Backbone.View) ) {
			view = <span class="hljs-keyword">this</span>.toView( view, id, options );
		}
		view.controller = view.controller || <span class="hljs-keyword">this</span>.controller;

		<span class="hljs-keyword">this</span>.unset( id );

		priority = view.options.priority || <span class="hljs-number">10</span>;
		views = <span class="hljs-keyword">this</span>.views.get() || [];

		_.find( views, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> existing, i </span>) </span>{
			<span class="hljs-keyword">if</span> ( existing.options.priority &gt; priority ) {
				index = i;
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
		});

		<span class="hljs-keyword">this</span>._views[ id ] = view;
		<span class="hljs-keyword">this</span>.views.add( view, {
			<span class="hljs-attr">at</span>: _.isNumber( index ) ? index : views.length || <span class="hljs-number">0</span>
		});

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * @param {string} id
	 * @returns {wp.media.View}
	 */</span>
	get: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._views[ id ];
	},
	<span class="hljs-comment">/**
	 * @param {string} id
	 * @returns {wp.media.view.PriorityList}
	 */</span>
	unset: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
		<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>.get( id );

		<span class="hljs-keyword">if</span> ( view ) {
			view.remove();
		}

		<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._views[ id ];
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * @param {Object} options
	 * @returns {wp.media.View}
	 */</span>
	toView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> wp.media.View( options );
	}
});

<span class="hljs-built_in">module</span>.exports = PriorityList;

},{}],<span class="hljs-number">55</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.RouterItem
 *
 * @class
 * @augments wp.media.view.MenuItem
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> RouterItem = wp.media.view.MenuItem.extend({
	<span class="hljs-comment">/**
	 * On click handler to activate the content region's corresponding mode.
	 */</span>
	click: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> contentMode = <span class="hljs-keyword">this</span>.options.contentMode;
		<span class="hljs-keyword">if</span> ( contentMode ) {
			<span class="hljs-keyword">this</span>.controller.content.mode( contentMode );
		}
	}
});

<span class="hljs-built_in">module</span>.exports = RouterItem;

},{}],<span class="hljs-number">56</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Router
 *
 * @class
 * @augments wp.media.view.Menu
 * @augments wp.media.view.PriorityList
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Menu = wp.media.view.Menu,
	Router;

Router = Menu.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'div'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'media-router'</span>,
	<span class="hljs-attr">property</span>:  <span class="hljs-string">'contentMode'</span>,
	<span class="hljs-attr">ItemView</span>:  wp.media.view.RouterItem,
	<span class="hljs-attr">region</span>:    <span class="hljs-string">'router'</span>,

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.controller.on( <span class="hljs-string">'content:render'</span>, <span class="hljs-keyword">this</span>.update, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-205">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-205">&#182;</a>
              </div>
              <p>Call ‘initialize’ directly on the parent class.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		Menu.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-attr">update</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> mode = <span class="hljs-keyword">this</span>.controller.content.mode();
		<span class="hljs-keyword">if</span> ( mode ) {
			<span class="hljs-keyword">this</span>.select( mode );
		}
	}
});

<span class="hljs-built_in">module</span>.exports = Router;

},{}],<span class="hljs-number">57</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Search
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> l10n = wp.media.view.l10n,
	Search;

Search = wp.media.View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'input'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'search'</span>,
	<span class="hljs-attr">id</span>:        <span class="hljs-string">'media-search-input'</span>,

	<span class="hljs-attr">attributes</span>: {
		<span class="hljs-attr">type</span>:        <span class="hljs-string">'search'</span>,
		<span class="hljs-attr">placeholder</span>: l10n.searchMediaPlaceholder
	},

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'input'</span>:  <span class="hljs-string">'search'</span>,
		<span class="hljs-string">'keyup'</span>:  <span class="hljs-string">'search'</span>
	},

	<span class="hljs-comment">/**
	 * @returns {wp.media.view.Search} Returns itself to allow chaining
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.el.value = <span class="hljs-keyword">this</span>.model.escape(<span class="hljs-string">'search'</span>);
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">search</span>: _.debounce( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">if</span> ( event.target.value ) {
			<span class="hljs-keyword">this</span>.model.set( <span class="hljs-string">'search'</span>, event.target.value );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.model.unset(<span class="hljs-string">'search'</span>);
		}
	}, <span class="hljs-number">300</span> )
});

<span class="hljs-built_in">module</span>.exports = Search;

},{}],<span class="hljs-number">58</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Selection
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> l10n = wp.media.view.l10n,
	Selection;

Selection = wp.media.View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'div'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'media-selection'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'media-selection'</span>),

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'click .edit-selection'</span>:  <span class="hljs-string">'edit'</span>,
		<span class="hljs-string">'click .clear-selection'</span>: <span class="hljs-string">'clear'</span>
	},

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">editable</span>:  <span class="hljs-literal">false</span>,
			<span class="hljs-attr">clearable</span>: <span class="hljs-literal">true</span>
		});

		<span class="hljs-comment">/**
		 * @member {wp.media.view.Attachments.Selection}
		 */</span>
		<span class="hljs-keyword">this</span>.attachments = <span class="hljs-keyword">new</span> wp.media.view.Attachments.Selection({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
			<span class="hljs-attr">collection</span>: <span class="hljs-keyword">this</span>.collection,
			<span class="hljs-attr">selection</span>:  <span class="hljs-keyword">this</span>.collection,
			<span class="hljs-attr">model</span>:      <span class="hljs-keyword">new</span> Backbone.Model()
		});

		<span class="hljs-keyword">this</span>.views.set( <span class="hljs-string">'.selection-view'</span>, <span class="hljs-keyword">this</span>.attachments );
		<span class="hljs-keyword">this</span>.collection.on( <span class="hljs-string">'add remove reset'</span>, <span class="hljs-keyword">this</span>.refresh, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.controller.on( <span class="hljs-string">'content:activate'</span>, <span class="hljs-keyword">this</span>.refresh, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.refresh();
	},

	<span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-206">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-206">&#182;</a>
              </div>
              <p>If the selection hasn’t been rendered, bail.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.$el.children().length ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">var</span> collection = <span class="hljs-keyword">this</span>.collection,
			editing = <span class="hljs-string">'edit-selection'</span> === <span class="hljs-keyword">this</span>.controller.content.mode();</pre></div></div>
            
        </li>
        
        
        <li id="section-207">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-207">&#182;</a>
              </div>
              <p>If nothing is selected, display nothing.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.$el.toggleClass( <span class="hljs-string">'empty'</span>, ! collection.length );
		<span class="hljs-keyword">this</span>.$el.toggleClass( <span class="hljs-string">'one'</span>, <span class="hljs-number">1</span> === collection.length );
		<span class="hljs-keyword">this</span>.$el.toggleClass( <span class="hljs-string">'editing'</span>, editing );

		<span class="hljs-keyword">this</span>.$(<span class="hljs-string">'.count'</span>).text( l10n.selected.replace(<span class="hljs-string">'%d'</span>, collection.length) );
	},

	<span class="hljs-attr">edit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		event.preventDefault();
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.editable ) {
			<span class="hljs-keyword">this</span>.options.editable.call( <span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.collection );
		}
	},

	<span class="hljs-attr">clear</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		event.preventDefault();
		<span class="hljs-keyword">this</span>.collection.reset();</pre></div></div>
            
        </li>
        
        
        <li id="section-208">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-208">&#182;</a>
              </div>
              <p>Keep focus inside media modal
after clear link is selected</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.controller.modal.focusManager.focus();
	}
});

<span class="hljs-built_in">module</span>.exports = Selection;

},{}],<span class="hljs-number">59</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Settings
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	$ = Backbone.$,
	Settings;

Settings = View.extend({
	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'click button'</span>:    <span class="hljs-string">'updateHandler'</span>,
		<span class="hljs-string">'change input'</span>:    <span class="hljs-string">'updateHandler'</span>,
		<span class="hljs-string">'change select'</span>:   <span class="hljs-string">'updateHandler'</span>,
		<span class="hljs-string">'change textarea'</span>: <span class="hljs-string">'updateHandler'</span>
	},

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.model = <span class="hljs-keyword">this</span>.model || <span class="hljs-keyword">new</span> Backbone.Model();
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>.updateChanges );
	},

	<span class="hljs-attr">prepare</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> _.defaults({
			<span class="hljs-attr">model</span>: <span class="hljs-keyword">this</span>.model.toJSON()
		}, <span class="hljs-keyword">this</span>.options );
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.Settings} Returns itself to allow chaining
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		View.prototype.render.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-209">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-209">&#182;</a>
              </div>
              <p>Select the correct values.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_( <span class="hljs-keyword">this</span>.model.attributes ).chain().keys().each( <span class="hljs-keyword">this</span>.update, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * @param {string} key
	 */</span>
	update: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> key </span>) </span>{
		<span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>.model.get( key ),
			$setting = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'[data-setting="'</span> + key + <span class="hljs-string">'"]'</span>),
			$buttons, $value;</pre></div></div>
            
        </li>
        
        
        <li id="section-210">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-210">&#182;</a>
              </div>
              <p>Bail if we didn’t find a matching setting.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! $setting.length ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-211">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-211">&#182;</a>
              </div>
              <p>Attempt to determine how the setting is rendered and update
the selected value.</p>

            </div>
            
        </li>
        
        
        <li id="section-212">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-212">&#182;</a>
              </div>
              <p>Handle dropdowns.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $setting.is(<span class="hljs-string">'select'</span>) ) {
			$value = $setting.find(<span class="hljs-string">'[value="'</span> + value + <span class="hljs-string">'"]'</span>);

			<span class="hljs-keyword">if</span> ( $value.length ) {
				$setting.find(<span class="hljs-string">'option'</span>).prop( <span class="hljs-string">'selected'</span>, <span class="hljs-literal">false</span> );
				$value.prop( <span class="hljs-string">'selected'</span>, <span class="hljs-literal">true</span> );
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-213">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-213">&#182;</a>
              </div>
              <p>If we can’t find the desired value, record what <em>is</em> selected.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.model.set( key, $setting.find(<span class="hljs-string">':selected'</span>).val() );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-214">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-214">&#182;</a>
              </div>
              <p>Handle button groups.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( $setting.hasClass(<span class="hljs-string">'button-group'</span>) ) {
			$buttons = $setting.find(<span class="hljs-string">'button'</span>).removeClass(<span class="hljs-string">'active'</span>);
			$buttons.filter( <span class="hljs-string">'[value="'</span> + value + <span class="hljs-string">'"]'</span> ).addClass(<span class="hljs-string">'active'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-215">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-215">&#182;</a>
              </div>
              <p>Handle text inputs and textareas.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( $setting.is(<span class="hljs-string">'input[type="text"], textarea'</span>) ) {
			<span class="hljs-keyword">if</span> ( ! $setting.is(<span class="hljs-string">':focus'</span>) ) {
				$setting.val( value );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-216">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-216">&#182;</a>
              </div>
              <p>Handle checkboxes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( $setting.is(<span class="hljs-string">'input[type="checkbox"]'</span>) ) {
			$setting.prop( <span class="hljs-string">'checked'</span>, !! value &amp;&amp; <span class="hljs-string">'false'</span> !== value );
		}
	},
	<span class="hljs-comment">/**
	 * @param {Object} event
	 */</span>
	updateHandler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> $setting = $( event.target ).closest(<span class="hljs-string">'[data-setting]'</span>),
			value = event.target.value,
			userSetting;

		event.preventDefault();

		<span class="hljs-keyword">if</span> ( ! $setting.length ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-217">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-217">&#182;</a>
              </div>
              <p>Use the correct value for checkboxes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $setting.is(<span class="hljs-string">'input[type="checkbox"]'</span>) ) {
			value = $setting[<span class="hljs-number">0</span>].checked;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-218">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-218">&#182;</a>
              </div>
              <p>Update the corresponding setting.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.model.set( $setting.data(<span class="hljs-string">'setting'</span>), value );</pre></div></div>
            
        </li>
        
        
        <li id="section-219">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-219">&#182;</a>
              </div>
              <p>If the setting has a corresponding user setting,
update that as well.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( userSetting = $setting.data(<span class="hljs-string">'userSetting'</span>) ) {
			<span class="hljs-built_in">window</span>.setUserSetting( userSetting, value );
		}
	},

	<span class="hljs-attr">updateChanges</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model </span>) </span>{
		<span class="hljs-keyword">if</span> ( model.hasChanged() ) {
			_( model.changed ).chain().keys().each( <span class="hljs-keyword">this</span>.update, <span class="hljs-keyword">this</span> );
		}
	}
});

<span class="hljs-built_in">module</span>.exports = Settings;

},{}],<span class="hljs-number">60</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Settings.AttachmentDisplay
 *
 * @class
 * @augments wp.media.view.Settings
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Settings = wp.media.view.Settings,
	AttachmentDisplay;

AttachmentDisplay = Settings.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'attachment-display-settings'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'attachment-display-settings'</span>),

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> attachment = <span class="hljs-keyword">this</span>.options.attachment;

		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">userSettings</span>: <span class="hljs-literal">false</span>
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-220">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-220">&#182;</a>
              </div>
              <p>Call ‘initialize’ directly on the parent class.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		Settings.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.model, <span class="hljs-string">'change:link'</span>, <span class="hljs-keyword">this</span>.updateLinkTo );

		<span class="hljs-keyword">if</span> ( attachment ) {
			attachment.on( <span class="hljs-string">'change:uploading'</span>, <span class="hljs-keyword">this</span>.render, <span class="hljs-keyword">this</span> );
		}
	},

	<span class="hljs-attr">dispose</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> attachment = <span class="hljs-keyword">this</span>.options.attachment;
		<span class="hljs-keyword">if</span> ( attachment ) {
			attachment.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
		}
		<span class="hljs-comment">/**
		 * call 'dispose' directly on the parent class
		 */</span>
		Settings.prototype.dispose.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.AttachmentDisplay} Returns itself to allow chaining
	 */</span>
	render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> attachment = <span class="hljs-keyword">this</span>.options.attachment;
		<span class="hljs-keyword">if</span> ( attachment ) {
			_.extend( <span class="hljs-keyword">this</span>.options, {
				<span class="hljs-attr">sizes</span>: attachment.get(<span class="hljs-string">'sizes'</span>),
				<span class="hljs-attr">type</span>:  attachment.get(<span class="hljs-string">'type'</span>)
			});
		}
		<span class="hljs-comment">/**
		 * call 'render' directly on the parent class
		 */</span>
		Settings.prototype.render.call( <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.updateLinkTo();
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">updateLinkTo</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> linkTo = <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'link'</span>),
			$input = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'.link-to-custom'</span>),
			attachment = <span class="hljs-keyword">this</span>.options.attachment;

		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'none'</span> === linkTo || <span class="hljs-string">'embed'</span> === linkTo || ( ! attachment &amp;&amp; <span class="hljs-string">'custom'</span> !== linkTo ) ) {
			$input.addClass( <span class="hljs-string">'hidden'</span> );
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( attachment ) {
			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'post'</span> === linkTo ) {
				$input.val( attachment.get(<span class="hljs-string">'link'</span>) );
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'file'</span> === linkTo ) {
				$input.val( attachment.get(<span class="hljs-string">'url'</span>) );
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'linkUrl'</span>) ) {
				$input.val(<span class="hljs-string">'http://'</span>);
			}

			$input.prop( <span class="hljs-string">'readonly'</span>, <span class="hljs-string">'custom'</span> !== linkTo );
		}

		$input.removeClass( <span class="hljs-string">'hidden'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-221">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-221">&#182;</a>
              </div>
              <p>If the input is visible, focus and select its contents.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! wp.media.isTouchDevice &amp;&amp; $input.is(<span class="hljs-string">':visible'</span>) ) {
			$input.focus()[<span class="hljs-number">0</span>].select();
		}
	}
});

<span class="hljs-built_in">module</span>.exports = AttachmentDisplay;

},{}],<span class="hljs-number">61</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Settings.Gallery
 *
 * @class
 * @augments wp.media.view.Settings
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Gallery = wp.media.view.Settings.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'collection-settings gallery-settings'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'gallery-settings'</span>)
});

<span class="hljs-built_in">module</span>.exports = Gallery;

},{}],<span class="hljs-number">62</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Settings.Playlist
 *
 * @class
 * @augments wp.media.view.Settings
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Playlist = wp.media.view.Settings.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'collection-settings playlist-settings'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'playlist-settings'</span>)
});

<span class="hljs-built_in">module</span>.exports = Playlist;

},{}],<span class="hljs-number">63</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Sidebar
 *
 * @class
 * @augments wp.media.view.PriorityList
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Sidebar = wp.media.view.PriorityList.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'media-sidebar'</span>
});

<span class="hljs-built_in">module</span>.exports = Sidebar;

},{}],<span class="hljs-number">64</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.SiteIconCropper
 *
 * Uses the imgAreaSelect plugin to allow a user to crop a Site Icon.
 *
 * Takes imgAreaSelect options from
 * wp.customize.SiteIconControl.calculateImageSelectOptions.
 *
 * @class
 * @augments wp.media.view.Cropper
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.view,
	SiteIconCropper;

SiteIconCropper = View.Cropper.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'crop-content site-icon'</span>,

	<span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
		View.Cropper.prototype.ready.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );

		<span class="hljs-keyword">this</span>.$( <span class="hljs-string">'.crop-image'</span> ).on( <span class="hljs-string">'load'</span>, _.bind( <span class="hljs-keyword">this</span>.addSidebar, <span class="hljs-keyword">this</span> ) );
	},

	<span class="hljs-attr">addSidebar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.sidebar = <span class="hljs-keyword">new</span> wp.media.view.Sidebar({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller
		});

		<span class="hljs-keyword">this</span>.sidebar.set( <span class="hljs-string">'preview'</span>, <span class="hljs-keyword">new</span> wp.media.view.SiteIconPreview({
			<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
			<span class="hljs-attr">attachment</span>: <span class="hljs-keyword">this</span>.options.attachment
		}) );

		<span class="hljs-keyword">this</span>.controller.cropperView.views.add( <span class="hljs-keyword">this</span>.sidebar );
	}
});

<span class="hljs-built_in">module</span>.exports = SiteIconCropper;

},{}],<span class="hljs-number">65</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.SiteIconPreview
 *
 * Shows a preview of the Site Icon as a favicon and app icon while cropping.
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	$ = jQuery,
	SiteIconPreview;

SiteIconPreview = View.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'site-icon-preview'</span>,
	<span class="hljs-attr">template</span>: wp.template( <span class="hljs-string">'site-icon-preview'</span> ),

	<span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.controller.imgSelect.setOptions({
			<span class="hljs-attr">onInit</span>: <span class="hljs-keyword">this</span>.updatePreview,
			<span class="hljs-attr">onSelectChange</span>: <span class="hljs-keyword">this</span>.updatePreview
		});
	},

	<span class="hljs-attr">prepare</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> {
			<span class="hljs-attr">url</span>: <span class="hljs-keyword">this</span>.options.attachment.get( <span class="hljs-string">'url'</span> )
		};
	},

	<span class="hljs-attr">updatePreview</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> img, coords </span>) </span>{
		<span class="hljs-keyword">var</span> rx = <span class="hljs-number">64</span> / coords.width,
			ry = <span class="hljs-number">64</span> / coords.height,
			preview_rx = <span class="hljs-number">16</span> / coords.width,
			preview_ry = <span class="hljs-number">16</span> / coords.height;

		$( <span class="hljs-string">'#preview-app-icon'</span> ).css({
			<span class="hljs-attr">width</span>: <span class="hljs-built_in">Math</span>.round(rx * <span class="hljs-keyword">this</span>.imageWidth ) + <span class="hljs-string">'px'</span>,
			<span class="hljs-attr">height</span>: <span class="hljs-built_in">Math</span>.round(ry * <span class="hljs-keyword">this</span>.imageHeight ) + <span class="hljs-string">'px'</span>,
			<span class="hljs-attr">marginLeft</span>: <span class="hljs-string">'-'</span> + <span class="hljs-built_in">Math</span>.round(rx * coords.x1) + <span class="hljs-string">'px'</span>,
			<span class="hljs-attr">marginTop</span>: <span class="hljs-string">'-'</span> + <span class="hljs-built_in">Math</span>.round(ry * coords.y1) + <span class="hljs-string">'px'</span>
		});

		$( <span class="hljs-string">'#preview-favicon'</span> ).css({
			<span class="hljs-attr">width</span>: <span class="hljs-built_in">Math</span>.round( preview_rx * <span class="hljs-keyword">this</span>.imageWidth ) + <span class="hljs-string">'px'</span>,
			<span class="hljs-attr">height</span>: <span class="hljs-built_in">Math</span>.round( preview_ry * <span class="hljs-keyword">this</span>.imageHeight ) + <span class="hljs-string">'px'</span>,
			<span class="hljs-attr">marginLeft</span>: <span class="hljs-string">'-'</span> + <span class="hljs-built_in">Math</span>.round( preview_rx * coords.x1 ) + <span class="hljs-string">'px'</span>,
			<span class="hljs-attr">marginTop</span>: <span class="hljs-string">'-'</span> + <span class="hljs-built_in">Math</span>.floor( preview_ry* coords.y1 ) + <span class="hljs-string">'px'</span>
		});
	}
});

<span class="hljs-built_in">module</span>.exports = SiteIconPreview;

},{}],<span class="hljs-number">66</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Spinner
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Spinner = wp.media.View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'span'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'spinner'</span>,
	<span class="hljs-attr">spinnerTimeout</span>: <span class="hljs-literal">false</span>,
	<span class="hljs-attr">delay</span>: <span class="hljs-number">400</span>,

	<span class="hljs-attr">show</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.spinnerTimeout ) {
			<span class="hljs-keyword">this</span>.spinnerTimeout = _.delay(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> $el </span>) </span>{
				$el.addClass( <span class="hljs-string">'is-active'</span> );
			}, <span class="hljs-keyword">this</span>.delay, <span class="hljs-keyword">this</span>.$el );
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">hide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$el.removeClass( <span class="hljs-string">'is-active'</span> );
		<span class="hljs-keyword">this</span>.spinnerTimeout = clearTimeout( <span class="hljs-keyword">this</span>.spinnerTimeout );

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	}
});

<span class="hljs-built_in">module</span>.exports = Spinner;

},{}],<span class="hljs-number">67</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Toolbar
 *
 * A toolbar which consists of a primary and a secondary section. Each sections
 * can be filled with views.
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	Toolbar;

Toolbar = View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'div'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'media-toolbar'</span>,

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> state = <span class="hljs-keyword">this</span>.controller.state(),
			selection = <span class="hljs-keyword">this</span>.selection = state.get(<span class="hljs-string">'selection'</span>),
			library = <span class="hljs-keyword">this</span>.library = state.get(<span class="hljs-string">'library'</span>);

		<span class="hljs-keyword">this</span>._views = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-222">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-222">&#182;</a>
              </div>
              <p>The toolbar is composed of two <code>PriorityList</code> views.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.primary   = <span class="hljs-keyword">new</span> wp.media.view.PriorityList();
		<span class="hljs-keyword">this</span>.secondary = <span class="hljs-keyword">new</span> wp.media.view.PriorityList();
		<span class="hljs-keyword">this</span>.primary.$el.addClass(<span class="hljs-string">'media-toolbar-primary search-form'</span>);
		<span class="hljs-keyword">this</span>.secondary.$el.addClass(<span class="hljs-string">'media-toolbar-secondary'</span>);

		<span class="hljs-keyword">this</span>.views.set([ <span class="hljs-keyword">this</span>.secondary, <span class="hljs-keyword">this</span>.primary ]);

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.items ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-keyword">this</span>.options.items, { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> });
		}

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.options.silent ) {
			<span class="hljs-keyword">this</span>.render();
		}

		<span class="hljs-keyword">if</span> ( selection ) {
			selection.on( <span class="hljs-string">'add remove reset'</span>, <span class="hljs-keyword">this</span>.refresh, <span class="hljs-keyword">this</span> );
		}

		<span class="hljs-keyword">if</span> ( library ) {
			library.on( <span class="hljs-string">'add remove reset'</span>, <span class="hljs-keyword">this</span>.refresh, <span class="hljs-keyword">this</span> );
		}
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.Toolbar} Returns itsef to allow chaining
	 */</span>
	dispose: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.selection ) {
			<span class="hljs-keyword">this</span>.selection.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.library ) {
			<span class="hljs-keyword">this</span>.library.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
		}
		<span class="hljs-comment">/**
		 * call 'dispose' directly on the parent class
		 */</span>
		<span class="hljs-keyword">return</span> View.prototype.dispose.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.refresh();
	},

	<span class="hljs-comment">/**
	 * @param {string} id
	 * @param {Backbone.View|Object} view
	 * @param {Object} [options={}]
	 * @returns {wp.media.view.Toolbar} Returns itself to allow chaining
	 */</span>
	set: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id, view, options </span>) </span>{
		<span class="hljs-keyword">var</span> list;
		options = options || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-223">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-223">&#182;</a>
              </div>
              <p>Accept an object with an <code>id</code> : <code>view</code> mapping.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( _.isObject( id ) ) {
			_.each( id, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view, id </span>) </span>{
				<span class="hljs-keyword">this</span>.set( id, view, { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> });
			}, <span class="hljs-keyword">this</span> );

		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">if</span> ( ! ( view <span class="hljs-keyword">instanceof</span> Backbone.View ) ) {
				view.classes = [ <span class="hljs-string">'media-button-'</span> + id ].concat( view.classes || [] );
				view = <span class="hljs-keyword">new</span> wp.media.view.Button( view ).render();
			}

			view.controller = view.controller || <span class="hljs-keyword">this</span>.controller;

			<span class="hljs-keyword">this</span>._views[ id ] = view;

			list = view.options.priority &lt; <span class="hljs-number">0</span> ? <span class="hljs-string">'secondary'</span> : <span class="hljs-string">'primary'</span>;
			<span class="hljs-keyword">this</span>[ list ].set( id, view, options );
		}

		<span class="hljs-keyword">if</span> ( ! options.silent ) {
			<span class="hljs-keyword">this</span>.refresh();
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * @param {string} id
	 * @returns {wp.media.view.Button}
	 */</span>
	get: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._views[ id ];
	},
	<span class="hljs-comment">/**
	 * @param {string} id
	 * @param {Object} options
	 * @returns {wp.media.view.Toolbar} Returns itself to allow chaining
	 */</span>
	unset: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id, options </span>) </span>{
		<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._views[ id ];
		<span class="hljs-keyword">this</span>.primary.unset( id, options );
		<span class="hljs-keyword">this</span>.secondary.unset( id, options );

		<span class="hljs-keyword">if</span> ( ! options || ! options.silent ) {
			<span class="hljs-keyword">this</span>.refresh();
		}
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> state = <span class="hljs-keyword">this</span>.controller.state(),
			library = state.get(<span class="hljs-string">'library'</span>),
			selection = state.get(<span class="hljs-string">'selection'</span>);

		_.each( <span class="hljs-keyword">this</span>._views, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> button </span>) </span>{
			<span class="hljs-keyword">if</span> ( ! button.model || ! button.options || ! button.options.requires ) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">var</span> requires = button.options.requires,
				disabled = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-224">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-224">&#182;</a>
              </div>
              <p>Prevent insertion of attachments if any of them are still uploading</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( selection &amp;&amp; selection.models ) {
				disabled = _.some( selection.models, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
					<span class="hljs-keyword">return</span> attachment.get(<span class="hljs-string">'uploading'</span>) === <span class="hljs-literal">true</span>;
				});
			}

			<span class="hljs-keyword">if</span> ( requires.selection &amp;&amp; selection &amp;&amp; ! selection.length ) {
				disabled = <span class="hljs-literal">true</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( requires.library &amp;&amp; library &amp;&amp; ! library.length ) {
				disabled = <span class="hljs-literal">true</span>;
			}
			button.model.set( <span class="hljs-string">'disabled'</span>, disabled );
		});
	}
});

<span class="hljs-built_in">module</span>.exports = Toolbar;

},{}],<span class="hljs-number">68</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Toolbar.Embed
 *
 * @class
 * @augments wp.media.view.Toolbar.Select
 * @augments wp.media.view.Toolbar
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Select = wp.media.view.Toolbar.Select,
	l10n = wp.media.view.l10n,
	Embed;

Embed = Select.extend({
	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">text</span>: l10n.insertIntoPost,
			<span class="hljs-attr">requires</span>: <span class="hljs-literal">false</span>
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-225">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-225">&#182;</a>
              </div>
              <p>Call ‘initialize’ directly on the parent class.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		Select.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> url = <span class="hljs-keyword">this</span>.controller.state().props.get(<span class="hljs-string">'url'</span>);
		<span class="hljs-keyword">this</span>.get(<span class="hljs-string">'select'</span>).model.set( <span class="hljs-string">'disabled'</span>, ! url || url === <span class="hljs-string">'http://'</span> );
		<span class="hljs-comment">/**
		 * call 'refresh' directly on the parent class
		 */</span>
		Select.prototype.refresh.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	}
});

<span class="hljs-built_in">module</span>.exports = Embed;

},{}],<span class="hljs-number">69</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.Toolbar.Select
 *
 * @class
 * @augments wp.media.view.Toolbar
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> Toolbar = wp.media.view.Toolbar,
	l10n = wp.media.view.l10n,
	Select;

Select = Toolbar.extend({
	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options;

		_.bindAll( <span class="hljs-keyword">this</span>, <span class="hljs-string">'clickSelect'</span> );

		_.defaults( options, {
			<span class="hljs-attr">event</span>: <span class="hljs-string">'select'</span>,
			<span class="hljs-attr">state</span>: <span class="hljs-literal">false</span>,
			<span class="hljs-attr">reset</span>: <span class="hljs-literal">true</span>,
			<span class="hljs-attr">close</span>: <span class="hljs-literal">true</span>,
			<span class="hljs-attr">text</span>:  l10n.select,</pre></div></div>
            
        </li>
        
        
        <li id="section-226">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-226">&#182;</a>
              </div>
              <p>Does the button rely on the selection?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			requires: {
				<span class="hljs-attr">selection</span>: <span class="hljs-literal">true</span>
			}
		});

		options.items = _.defaults( options.items || {}, {
			<span class="hljs-attr">select</span>: {
				<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
				<span class="hljs-attr">text</span>:     options.text,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,
				<span class="hljs-attr">click</span>:    <span class="hljs-keyword">this</span>.clickSelect,
				<span class="hljs-attr">requires</span>: options.requires
			}
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-227">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-227">&#182;</a>
              </div>
              <p>Call ‘initialize’ directly on the parent class.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		Toolbar.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},

	<span class="hljs-attr">clickSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
			controller = <span class="hljs-keyword">this</span>.controller;

		<span class="hljs-keyword">if</span> ( options.close ) {
			controller.close();
		}

		<span class="hljs-keyword">if</span> ( options.event ) {
			controller.state().trigger( options.event );
		}

		<span class="hljs-keyword">if</span> ( options.state ) {
			controller.setState( options.state );
		}

		<span class="hljs-keyword">if</span> ( options.reset ) {
			controller.reset();
		}
	}
});

<span class="hljs-built_in">module</span>.exports = Select;

},{}],<span class="hljs-number">70</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * Creates a dropzone on WP editor instances (elements with .wp-editor-wrap)
 * and relays drag'n'dropped files to a media workflow.
 *
 * wp.media.view.EditorUploader
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	l10n = wp.media.view.l10n,
	$ = jQuery,
	EditorUploader;

EditorUploader = View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'div'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'uploader-editor'</span>,
	<span class="hljs-attr">template</span>:  wp.template( <span class="hljs-string">'uploader-editor'</span> ),

	<span class="hljs-attr">localDrag</span>: <span class="hljs-literal">false</span>,
	<span class="hljs-attr">overContainer</span>: <span class="hljs-literal">false</span>,
	<span class="hljs-attr">overDropzone</span>: <span class="hljs-literal">false</span>,
	<span class="hljs-attr">draggingFile</span>: <span class="hljs-literal">null</span>,

	<span class="hljs-comment">/**
	 * Bind drag'n'drop events to callbacks.
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.initialized = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-228">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-228">&#182;</a>
              </div>
              <p>Bail if not enabled or UA does not support drag’n’drop or File API.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-built_in">window</span>.tinyMCEPreInit || ! <span class="hljs-built_in">window</span>.tinyMCEPreInit.dragDropUpload || ! <span class="hljs-keyword">this</span>.browserSupport() ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}

		<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">document</span> = $(<span class="hljs-built_in">document</span>);
		<span class="hljs-keyword">this</span>.dropzones = [];
		<span class="hljs-keyword">this</span>.files = [];

		<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">document</span>.on( <span class="hljs-string">'drop'</span>, <span class="hljs-string">'.uploader-editor'</span>, _.bind( <span class="hljs-keyword">this</span>.drop, <span class="hljs-keyword">this</span> ) );
		<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">document</span>.on( <span class="hljs-string">'dragover'</span>, <span class="hljs-string">'.uploader-editor'</span>, _.bind( <span class="hljs-keyword">this</span>.dropzoneDragover, <span class="hljs-keyword">this</span> ) );
		<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">document</span>.on( <span class="hljs-string">'dragleave'</span>, <span class="hljs-string">'.uploader-editor'</span>, _.bind( <span class="hljs-keyword">this</span>.dropzoneDragleave, <span class="hljs-keyword">this</span> ) );
		<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">document</span>.on( <span class="hljs-string">'click'</span>, <span class="hljs-string">'.uploader-editor'</span>, _.bind( <span class="hljs-keyword">this</span>.click, <span class="hljs-keyword">this</span> ) );

		<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">document</span>.on( <span class="hljs-string">'dragover'</span>, _.bind( <span class="hljs-keyword">this</span>.containerDragover, <span class="hljs-keyword">this</span> ) );
		<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">document</span>.on( <span class="hljs-string">'dragleave'</span>, _.bind( <span class="hljs-keyword">this</span>.containerDragleave, <span class="hljs-keyword">this</span> ) );

		<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">document</span>.on( <span class="hljs-string">'dragstart dragend drop'</span>, _.bind( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
			<span class="hljs-keyword">this</span>.localDrag = event.type === <span class="hljs-string">'dragstart'</span>;

			<span class="hljs-keyword">if</span> ( event.type === <span class="hljs-string">'drop'</span> ) {
				<span class="hljs-keyword">this</span>.containerDragleave();
			}
		}, <span class="hljs-keyword">this</span> ) );

		<span class="hljs-keyword">this</span>.initialized = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-comment">/**
	 * Check browser support for drag'n'drop.
	 *
	 * @return Boolean
	 */</span>
	browserSupport: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> supports = <span class="hljs-literal">false</span>, div = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);

		supports = ( <span class="hljs-string">'draggable'</span> <span class="hljs-keyword">in</span> div ) || ( <span class="hljs-string">'ondragstart'</span> <span class="hljs-keyword">in</span> div &amp;&amp; <span class="hljs-string">'ondrop'</span> <span class="hljs-keyword">in</span> div );
		supports = supports &amp;&amp; !! ( <span class="hljs-built_in">window</span>.File &amp;&amp; <span class="hljs-built_in">window</span>.FileList &amp;&amp; <span class="hljs-built_in">window</span>.FileReader );
		<span class="hljs-keyword">return</span> supports;
	},

	<span class="hljs-attr">isDraggingFile</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.draggingFile !== <span class="hljs-literal">null</span> ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.draggingFile;
		}

		<span class="hljs-keyword">if</span> ( _.isUndefined( event.originalEvent ) || _.isUndefined( event.originalEvent.dataTransfer ) ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}

		<span class="hljs-keyword">this</span>.draggingFile = _.indexOf( event.originalEvent.dataTransfer.types, <span class="hljs-string">'Files'</span> ) &gt; <span class="hljs-number">-1</span> &amp;&amp;
			_.indexOf( event.originalEvent.dataTransfer.types, <span class="hljs-string">'text/plain'</span> ) === <span class="hljs-number">-1</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.draggingFile;
	},

	<span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> e </span>) </span>{
		<span class="hljs-keyword">var</span> dropzone_id;
		<span class="hljs-keyword">for</span> ( dropzone_id <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.dropzones ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-229">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-229">&#182;</a>
              </div>
              <p>Hide the dropzones only if dragging has left the screen.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.dropzones[ dropzone_id ].toggle( <span class="hljs-keyword">this</span>.overContainer || <span class="hljs-keyword">this</span>.overDropzone );
		}

		<span class="hljs-keyword">if</span> ( ! _.isUndefined( e ) ) {
			$( e.target ).closest( <span class="hljs-string">'.uploader-editor'</span> ).toggleClass( <span class="hljs-string">'droppable'</span>, <span class="hljs-keyword">this</span>.overDropzone );
		}

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.overContainer &amp;&amp; ! <span class="hljs-keyword">this</span>.overDropzone ) {
			<span class="hljs-keyword">this</span>.draggingFile = <span class="hljs-literal">null</span>;
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.initialized ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}

		View.prototype.render.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		$( <span class="hljs-string">'.wp-editor-wrap'</span> ).each( _.bind( <span class="hljs-keyword">this</span>.attach, <span class="hljs-keyword">this</span> ) );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">attach</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> index, editor </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-230">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-230">&#182;</a>
              </div>
              <p>Attach a dropzone to an editor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> dropzone = <span class="hljs-keyword">this</span>.$el.clone();
		<span class="hljs-keyword">this</span>.dropzones.push( dropzone );
		$( editor ).append( dropzone );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-comment">/**
	 * When a file is dropped on the editor uploader, open up an editor media workflow
	 * and upload the file immediately.
	 *
	 * @param  {jQuery.Event} event The 'drop' event.
	 */</span>
	drop: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> $wrap, uploadView;

		<span class="hljs-keyword">this</span>.containerDragleave( event );
		<span class="hljs-keyword">this</span>.dropzoneDragleave( event );

		<span class="hljs-keyword">this</span>.files = event.originalEvent.dataTransfer.files;
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.files.length &lt; <span class="hljs-number">1</span> ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-231">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-231">&#182;</a>
              </div>
              <p>Set the active editor to the drop target.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$wrap = $( event.target ).parents( <span class="hljs-string">'.wp-editor-wrap'</span> );
		<span class="hljs-keyword">if</span> ( $wrap.length &gt; <span class="hljs-number">0</span> &amp;&amp; $wrap[<span class="hljs-number">0</span>].id ) {
			<span class="hljs-built_in">window</span>.wpActiveEditor = $wrap[<span class="hljs-number">0</span>].id.slice( <span class="hljs-number">3</span>, <span class="hljs-number">-5</span> );
		}

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.workflow ) {
			<span class="hljs-keyword">this</span>.workflow = wp.media.editor.open( <span class="hljs-built_in">window</span>.wpActiveEditor, {
				<span class="hljs-attr">frame</span>:    <span class="hljs-string">'post'</span>,
				<span class="hljs-attr">state</span>:    <span class="hljs-string">'insert'</span>,
				<span class="hljs-attr">title</span>:    l10n.addMedia,
				<span class="hljs-attr">multiple</span>: <span class="hljs-literal">true</span>
			});

			uploadView = <span class="hljs-keyword">this</span>.workflow.uploader;

			<span class="hljs-keyword">if</span> ( uploadView.uploader &amp;&amp; uploadView.uploader.ready ) {
				<span class="hljs-keyword">this</span>.addFiles.apply( <span class="hljs-keyword">this</span> );
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.workflow.on( <span class="hljs-string">'uploader:ready'</span>, <span class="hljs-keyword">this</span>.addFiles, <span class="hljs-keyword">this</span> );
			}
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.workflow.state().reset();
			<span class="hljs-keyword">this</span>.addFiles.apply( <span class="hljs-keyword">this</span> );
			<span class="hljs-keyword">this</span>.workflow.open();
		}

		<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
	},

	<span class="hljs-comment">/**
	 * Add the files to the uploader.
	 */</span>
	addFiles: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.files.length ) {
			<span class="hljs-keyword">this</span>.workflow.uploader.uploader.uploader.addFile( _.toArray( <span class="hljs-keyword">this</span>.files ) );
			<span class="hljs-keyword">this</span>.files = [];
		}
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">containerDragover</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.localDrag || ! <span class="hljs-keyword">this</span>.isDraggingFile( event ) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.overContainer = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">this</span>.refresh();
	},

	<span class="hljs-attr">containerDragleave</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.overContainer = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-232">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-232">&#182;</a>
              </div>
              <p>Throttle dragleave because it’s called when bouncing from some elements to others.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_.delay( _.bind( <span class="hljs-keyword">this</span>.refresh, <span class="hljs-keyword">this</span> ), <span class="hljs-number">50</span> );
	},

	<span class="hljs-attr">dropzoneDragover</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.localDrag || ! <span class="hljs-keyword">this</span>.isDraggingFile( event ) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.overDropzone = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">this</span>.refresh( event );
		<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
	},

	<span class="hljs-attr">dropzoneDragleave</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> e </span>) </span>{
		<span class="hljs-keyword">this</span>.overDropzone = <span class="hljs-literal">false</span>;
		_.delay( _.bind( <span class="hljs-keyword">this</span>.refresh, <span class="hljs-keyword">this</span>, e ), <span class="hljs-number">50</span> );
	},

	<span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> e </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-233">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-233">&#182;</a>
              </div>
              <p>In the rare case where the dropzone gets stuck, hide it on click.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.containerDragleave( e );
		<span class="hljs-keyword">this</span>.dropzoneDragleave( e );
		<span class="hljs-keyword">this</span>.localDrag = <span class="hljs-literal">false</span>;
	}
});

<span class="hljs-built_in">module</span>.exports = EditorUploader;

},{}],<span class="hljs-number">71</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.UploaderInline
 *
 * The inline uploader that shows up in the 'Upload Files' tab.
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	UploaderInline;

UploaderInline = View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'div'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'uploader-inline'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'uploader-inline'</span>),

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'click .close'</span>: <span class="hljs-string">'hide'</span>
	},

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		_.defaults( <span class="hljs-keyword">this</span>.options, {
			<span class="hljs-attr">message</span>: <span class="hljs-string">''</span>,
			<span class="hljs-attr">status</span>:  <span class="hljs-literal">true</span>,
			<span class="hljs-attr">canClose</span>: <span class="hljs-literal">false</span>
		});

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.options.$browser &amp;&amp; <span class="hljs-keyword">this</span>.controller.uploader ) {
			<span class="hljs-keyword">this</span>.options.$browser = <span class="hljs-keyword">this</span>.controller.uploader.$browser;
		}

		<span class="hljs-keyword">if</span> ( _.isUndefined( <span class="hljs-keyword">this</span>.options.postId ) ) {
			<span class="hljs-keyword">this</span>.options.postId = wp.media.view.settings.post.id;
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.status ) {
			<span class="hljs-keyword">this</span>.views.set( <span class="hljs-string">'.upload-inline-status'</span>, <span class="hljs-keyword">new</span> wp.media.view.UploaderStatus({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller
			}) );
		}
	},

	<span class="hljs-attr">prepare</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> suggestedWidth = <span class="hljs-keyword">this</span>.controller.state().get(<span class="hljs-string">'suggestedWidth'</span>),
			suggestedHeight = <span class="hljs-keyword">this</span>.controller.state().get(<span class="hljs-string">'suggestedHeight'</span>),
			data = {};

		data.message = <span class="hljs-keyword">this</span>.options.message;
		data.canClose = <span class="hljs-keyword">this</span>.options.canClose;

		<span class="hljs-keyword">if</span> ( suggestedWidth &amp;&amp; suggestedHeight ) {
			data.suggestedWidth = suggestedWidth;
			data.suggestedHeight = suggestedHeight;
		}

		<span class="hljs-keyword">return</span> data;
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.UploaderInline} Returns itself to allow chaining
	 */</span>
	dispose: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.disposing ) {
			<span class="hljs-comment">/**
			 * call 'dispose' directly on the parent class
			 */</span>
			<span class="hljs-keyword">return</span> View.prototype.dispose.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-234">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-234">&#182;</a>
              </div>
              <p>Run remove on <code>dispose</code>, so we can be sure to refresh the
uploader with a view-less DOM. Track whether we’re disposing
so we don’t trigger an infinite loop.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.disposing = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.remove();
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.UploaderInline} Returns itself to allow chaining
	 */</span>
	remove: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-comment">/**
		 * call 'remove' directly on the parent class
		 */</span>
		<span class="hljs-keyword">var</span> result = View.prototype.remove.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );

		_.defer( _.bind( <span class="hljs-keyword">this</span>.refresh, <span class="hljs-keyword">this</span> ) );
		<span class="hljs-keyword">return</span> result;
	},

	<span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> uploader = <span class="hljs-keyword">this</span>.controller.uploader;

		<span class="hljs-keyword">if</span> ( uploader ) {
			uploader.refresh();
		}
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.view.UploaderInline}
	 */</span>
	ready: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> $browser = <span class="hljs-keyword">this</span>.options.$browser,
			$placeholder;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.uploader ) {
			$placeholder = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'.browser'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-235">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-235">&#182;</a>
              </div>
              <p>Check if we’ve already replaced the placeholder.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $placeholder[<span class="hljs-number">0</span>] === $browser[<span class="hljs-number">0</span>] ) {
				<span class="hljs-keyword">return</span>;
			}

			$browser.detach().text( $placeholder.text() );
			$browser[<span class="hljs-number">0</span>].className = $placeholder[<span class="hljs-number">0</span>].className;
			$placeholder.replaceWith( $browser.show() );
		}

		<span class="hljs-keyword">this</span>.refresh();
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-attr">show</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$el.removeClass( <span class="hljs-string">'hidden'</span> );
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.$uploaderToggler.length ) {
			<span class="hljs-keyword">this</span>.controller.$uploaderToggler.attr( <span class="hljs-string">'aria-expanded'</span>, <span class="hljs-string">'true'</span> );
		}
	},
	<span class="hljs-attr">hide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$el.addClass( <span class="hljs-string">'hidden'</span> );
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller.$uploaderToggler.length ) {
			<span class="hljs-keyword">this</span>.controller.$uploaderToggler
				.attr( <span class="hljs-string">'aria-expanded'</span>, <span class="hljs-string">'false'</span> )</pre></div></div>
            
        </li>
        
        
        <li id="section-236">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-236">&#182;</a>
              </div>
              <p>Move focus back to the toggle button when closing the uploader.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				.focus();
		}
	}

});

<span class="hljs-built_in">module</span>.exports = UploaderInline;

},{}],<span class="hljs-number">72</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.UploaderStatusError
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> UploaderStatusError = wp.media.View.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'upload-error'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'uploader-status-error'</span>)
});

<span class="hljs-built_in">module</span>.exports = UploaderStatusError;

},{}],<span class="hljs-number">73</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.UploaderStatus
 *
 * An uploader status for on-going uploads.
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.media.View,
	UploaderStatus;

UploaderStatus = View.extend({
	<span class="hljs-attr">className</span>: <span class="hljs-string">'media-uploader-status'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'uploader-status'</span>),

	<span class="hljs-attr">events</span>: {
		<span class="hljs-string">'click .upload-dismiss-errors'</span>: <span class="hljs-string">'dismiss'</span>
	},

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.queue = wp.Uploader.queue;
		<span class="hljs-keyword">this</span>.queue.on( <span class="hljs-string">'add remove reset'</span>, <span class="hljs-keyword">this</span>.visibility, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.queue.on( <span class="hljs-string">'add remove reset change:percent'</span>, <span class="hljs-keyword">this</span>.progress, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.queue.on( <span class="hljs-string">'add remove reset change:uploading'</span>, <span class="hljs-keyword">this</span>.info, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.errors = wp.Uploader.errors;
		<span class="hljs-keyword">this</span>.errors.reset();
		<span class="hljs-keyword">this</span>.errors.on( <span class="hljs-string">'add remove reset'</span>, <span class="hljs-keyword">this</span>.visibility, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.errors.on( <span class="hljs-string">'add'</span>, <span class="hljs-keyword">this</span>.error, <span class="hljs-keyword">this</span> );
	},
	<span class="hljs-comment">/**
	 * @global wp.Uploader
	 * @returns {wp.media.view.UploaderStatus}
	 */</span>
	dispose: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		wp.Uploader.queue.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
		<span class="hljs-comment">/**
		 * call 'dispose' directly on the parent class
		 */</span>
		View.prototype.dispose.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-attr">visibility</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.$el.toggleClass( <span class="hljs-string">'uploading'</span>, !! <span class="hljs-keyword">this</span>.queue.length );
		<span class="hljs-keyword">this</span>.$el.toggleClass( <span class="hljs-string">'errors'</span>, !! <span class="hljs-keyword">this</span>.errors.length );
		<span class="hljs-keyword">this</span>.$el.toggle( !! <span class="hljs-keyword">this</span>.queue.length || !! <span class="hljs-keyword">this</span>.errors.length );
	},

	<span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		_.each({
			<span class="hljs-string">'$bar'</span>:      <span class="hljs-string">'.media-progress-bar div'</span>,
			<span class="hljs-string">'$index'</span>:    <span class="hljs-string">'.upload-index'</span>,
			<span class="hljs-string">'$total'</span>:    <span class="hljs-string">'.upload-total'</span>,
			<span class="hljs-string">'$filename'</span>: <span class="hljs-string">'.upload-filename'</span>
		}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> selector, key </span>) </span>{
			<span class="hljs-keyword">this</span>[ key ] = <span class="hljs-keyword">this</span>.$( selector );
		}, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.visibility();
		<span class="hljs-keyword">this</span>.progress();
		<span class="hljs-keyword">this</span>.info();
	},

	<span class="hljs-attr">progress</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> queue = <span class="hljs-keyword">this</span>.queue,
			$bar = <span class="hljs-keyword">this</span>.$bar;

		<span class="hljs-keyword">if</span> ( ! $bar || ! queue.length ) {
			<span class="hljs-keyword">return</span>;
		}

		$bar.width( ( queue.reduce( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> memo, attachment </span>) </span>{
			<span class="hljs-keyword">if</span> ( ! attachment.get(<span class="hljs-string">'uploading'</span>) ) {
				<span class="hljs-keyword">return</span> memo + <span class="hljs-number">100</span>;
			}

			<span class="hljs-keyword">var</span> percent = attachment.get(<span class="hljs-string">'percent'</span>);
			<span class="hljs-keyword">return</span> memo + ( _.isNumber( percent ) ? percent : <span class="hljs-number">100</span> );
		}, <span class="hljs-number">0</span> ) / queue.length ) + <span class="hljs-string">'%'</span> );
	},

	<span class="hljs-attr">info</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> queue = <span class="hljs-keyword">this</span>.queue,
			index = <span class="hljs-number">0</span>, active;

		<span class="hljs-keyword">if</span> ( ! queue.length ) {
			<span class="hljs-keyword">return</span>;
		}

		active = <span class="hljs-keyword">this</span>.queue.find( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment, i </span>) </span>{
			index = i;
			<span class="hljs-keyword">return</span> attachment.get(<span class="hljs-string">'uploading'</span>);
		});

		<span class="hljs-keyword">this</span>.$index.text( index + <span class="hljs-number">1</span> );
		<span class="hljs-keyword">this</span>.$total.text( queue.length );
		<span class="hljs-keyword">this</span>.$filename.html( active ? <span class="hljs-keyword">this</span>.filename( active.get(<span class="hljs-string">'filename'</span>) ) : <span class="hljs-string">''</span> );
	},
	<span class="hljs-comment">/**
	 * @param {string} filename
	 * @returns {string}
	 */</span>
	filename: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> filename </span>) </span>{
		<span class="hljs-keyword">return</span> _.escape( filename );
	},
	<span class="hljs-comment">/**
	 * @param {Backbone.Model} error
	 */</span>
	error: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> error </span>) </span>{
		<span class="hljs-keyword">this</span>.views.add( <span class="hljs-string">'.upload-errors'</span>, <span class="hljs-keyword">new</span> wp.media.view.UploaderStatusError({
			<span class="hljs-attr">filename</span>: <span class="hljs-keyword">this</span>.filename( error.get(<span class="hljs-string">'file'</span>).name ),
			<span class="hljs-attr">message</span>:  error.get(<span class="hljs-string">'message'</span>)
		}), { <span class="hljs-attr">at</span>: <span class="hljs-number">0</span> });
	},

	<span class="hljs-comment">/**
	 * @global wp.Uploader
	 *
	 * @param {Object} event
	 */</span>
	dismiss: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
		<span class="hljs-keyword">var</span> errors = <span class="hljs-keyword">this</span>.views.get(<span class="hljs-string">'.upload-errors'</span>);

		event.preventDefault();

		<span class="hljs-keyword">if</span> ( errors ) {
			_.invoke( errors, <span class="hljs-string">'remove'</span> );
		}
		wp.Uploader.errors.reset();
	}
});

<span class="hljs-built_in">module</span>.exports = UploaderStatus;

},{}],<span class="hljs-number">74</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.view.UploaderWindow
 *
 * An uploader window that allows for dragging and dropping media.
 *
 * @class
 * @augments wp.media.View
 * @augments wp.Backbone.View
 * @augments Backbone.View
 *
 * @param {object} [options]                   Options hash passed to the view.
 * @param {object} [options.uploader]          Uploader properties.
 * @param {jQuery} [options.uploader.browser]
 * @param {jQuery} [options.uploader.dropzone] jQuery collection of the dropzone.
 * @param {object} [options.uploader.params]
 */</span>
<span class="hljs-keyword">var</span> $ = jQuery,
	UploaderWindow;

UploaderWindow = wp.media.View.extend({
	<span class="hljs-attr">tagName</span>:   <span class="hljs-string">'div'</span>,
	<span class="hljs-attr">className</span>: <span class="hljs-string">'uploader-window'</span>,
	<span class="hljs-attr">template</span>:  wp.template(<span class="hljs-string">'uploader-window'</span>),

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> uploader;

		<span class="hljs-keyword">this</span>.$browser = $( <span class="hljs-string">'&lt;button type="button" class="browser" /&gt;'</span> ).hide().appendTo( <span class="hljs-string">'body'</span> );

		uploader = <span class="hljs-keyword">this</span>.options.uploader = _.defaults( <span class="hljs-keyword">this</span>.options.uploader || {}, {
			<span class="hljs-attr">dropzone</span>:  <span class="hljs-keyword">this</span>.$el,
			<span class="hljs-attr">browser</span>:   <span class="hljs-keyword">this</span>.$browser,
			<span class="hljs-attr">params</span>:    {}
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-237">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-237">&#182;</a>
              </div>
              <p>Ensure the dropzone is a jQuery collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( uploader.dropzone &amp;&amp; ! (uploader.dropzone <span class="hljs-keyword">instanceof</span> $) ) {
			uploader.dropzone = $( uploader.dropzone );
		}

		<span class="hljs-keyword">this</span>.controller.on( <span class="hljs-string">'activate'</span>, <span class="hljs-keyword">this</span>.refresh, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.controller.on( <span class="hljs-string">'detach'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">this</span>.$browser.remove();
		}, <span class="hljs-keyword">this</span> );
	},

	<span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.uploader ) {
			<span class="hljs-keyword">this</span>.uploader.refresh();
		}
	},

	<span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> postId = wp.media.view.settings.post.id,
			dropzone;</pre></div></div>
            
        </li>
        
        
        <li id="section-238">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-238">&#182;</a>
              </div>
              <p>If the uploader already exists, bail.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.uploader ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( postId ) {
			<span class="hljs-keyword">this</span>.options.uploader.params.post_id = postId;
		}
		<span class="hljs-keyword">this</span>.uploader = <span class="hljs-keyword">new</span> wp.Uploader( <span class="hljs-keyword">this</span>.options.uploader );

		dropzone = <span class="hljs-keyword">this</span>.uploader.dropzone;
		dropzone.on( <span class="hljs-string">'dropzone:enter'</span>, _.bind( <span class="hljs-keyword">this</span>.show, <span class="hljs-keyword">this</span> ) );
		dropzone.on( <span class="hljs-string">'dropzone:leave'</span>, _.bind( <span class="hljs-keyword">this</span>.hide, <span class="hljs-keyword">this</span> ) );

		$( <span class="hljs-keyword">this</span>.uploader ).on( <span class="hljs-string">'uploader:ready'</span>, _.bind( <span class="hljs-keyword">this</span>._ready, <span class="hljs-keyword">this</span> ) );
	},

	<span class="hljs-attr">_ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.controller.trigger( <span class="hljs-string">'uploader:ready'</span> );
	},

	<span class="hljs-attr">show</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> $el = <span class="hljs-keyword">this</span>.$el.show();</pre></div></div>
            
        </li>
        
        
        <li id="section-239">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-239">&#182;</a>
              </div>
              <p>Ensure that the animation is triggered by waiting until
the transparent element is painted into the DOM.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_.defer( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			$el.css({ <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span> });
		});
	},

	<span class="hljs-attr">hide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> $el = <span class="hljs-keyword">this</span>.$el.css({ <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span> });

		wp.media.transition( $el ).done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-240">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-240">&#182;</a>
              </div>
              <p>Transition end events are subject to race conditions.
Make sure that the value is set as intended.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'0'</span> === $el.css(<span class="hljs-string">'opacity'</span>) ) {
				$el.hide();
			}
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-241">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-241">&#182;</a>
              </div>
              <p><a href="https://core.trac.wordpress.org/ticket/27341">https://core.trac.wordpress.org/ticket/27341</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_.delay( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'0'</span> === $el.css(<span class="hljs-string">'opacity'</span>) &amp;&amp; $el.is(<span class="hljs-string">':visible'</span>) ) {
				$el.hide();
			}
		}, <span class="hljs-number">500</span> );
	}
});

<span class="hljs-built_in">module</span>.exports = UploaderWindow;

},{}],<span class="hljs-number">75</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.View
 *
 * The base view class for media.
 *
 * Undelegating events, removing events from the model, and
 * removing events from the controller mirror the code for
 * `Backbone.View.dispose` in Backbone 0.9.8 development.
 *
 * This behavior has since been removed, and should not be used
 * outside of the media manager.
 *
 * @class
 * @augments wp.Backbone.View
 * @augments Backbone.View
 */</span>
<span class="hljs-keyword">var</span> View = wp.Backbone.View.extend({
	<span class="hljs-attr">constructor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">if</span> ( options &amp;&amp; options.controller ) {
			<span class="hljs-keyword">this</span>.controller = options.controller;
		}
		wp.Backbone.View.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	},
	<span class="hljs-comment">/**
	 * @todo The internal comment mentions this might have been a stop-gap
	 *       before Backbone 0.9.8 came out. Figure out if Backbone core takes
	 *       care of this in Backbone.View now.
	 *
	 * @returns {wp.media.View} Returns itself to allow chaining
	 */</span>
	dispose: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-242">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-242">&#182;</a>
              </div>
              <p>Undelegating events, removing events from the model, and
removing events from the controller mirror the code for
<code>Backbone.View.dispose</code> in Backbone 0.9.8 development.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.undelegateEvents();

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.model &amp;&amp; <span class="hljs-keyword">this</span>.model.off ) {
			<span class="hljs-keyword">this</span>.model.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.collection &amp;&amp; <span class="hljs-keyword">this</span>.collection.off ) {
			<span class="hljs-keyword">this</span>.collection.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-243">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-243">&#182;</a>
              </div>
              <p>Unbind controller events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.controller &amp;&amp; <span class="hljs-keyword">this</span>.controller.off ) {
			<span class="hljs-keyword">this</span>.controller.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * @returns {wp.media.View} Returns itself to allow chaining
	 */</span>
	remove: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.dispose();
		<span class="hljs-comment">/**
		 * call 'remove' directly on the parent class
		 */</span>
		<span class="hljs-keyword">return</span> wp.Backbone.View.prototype.remove.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	}
});

<span class="hljs-built_in">module</span>.exports = View;

},{}]},{},[<span class="hljs-number">19</span>]);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
