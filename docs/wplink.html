<!DOCTYPE html>

<html>
<head>
  <title>wplink.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="bookmarklet.html">
                  bookmarklet.js
                </a>
              
                
                <a class="source" href="bookmarklet.min.html">
                  bookmarklet.min.js
                </a>
              
                
                <a class="source" href="color-picker.html">
                  color-picker.js
                </a>
              
                
                <a class="source" href="comment.html">
                  comment.js
                </a>
              
                
                <a class="source" href="common.html">
                  common.js
                </a>
              
                
                <a class="source" href="custom-background.html">
                  custom-background.js
                </a>
              
                
                <a class="source" href="custom-header.html">
                  custom-header.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-nav-menus.html">
                  customize-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-widgets.html">
                  customize-widgets.js
                </a>
              
                
                <a class="source" href="dashboard.html">
                  dashboard.js
                </a>
              
                
                <a class="source" href="edit-comments.html">
                  edit-comments.js
                </a>
              
                
                <a class="source" href="editor-expand.html">
                  editor-expand.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="farbtastic.html">
                  farbtastic.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="image-edit.html">
                  image-edit.js
                </a>
              
                
                <a class="source" href="inline-edit-post.html">
                  inline-edit-post.js
                </a>
              
                
                <a class="source" href="inline-edit-tax.html">
                  inline-edit-tax.js
                </a>
              
                
                <a class="source" href="iris.min.html">
                  iris.min.js
                </a>
              
                
                <a class="source" href="language-chooser.html">
                  language-chooser.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="media-gallery.html">
                  media-gallery.js
                </a>
              
                
                <a class="source" href="media-upload.html">
                  media-upload.js
                </a>
              
                
                <a class="source" href="media.html">
                  media.js
                </a>
              
                
                <a class="source" href="nav-menu.html">
                  nav-menu.js
                </a>
              
                
                <a class="source" href="password-strength-meter.html">
                  password-strength-meter.js
                </a>
              
                
                <a class="source" href="plugin-install.html">
                  plugin-install.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="postbox.html">
                  postbox.js
                </a>
              
                
                <a class="source" href="press-this.html">
                  press-this.js
                </a>
              
                
                <a class="source" href="revisions.html">
                  revisions.js
                </a>
              
                
                <a class="source" href="set-post-thumbnail.html">
                  set-post-thumbnail.js
                </a>
              
                
                <a class="source" href="svg-painter.html">
                  svg-painter.js
                </a>
              
                
                <a class="source" href="tags-box.html">
                  tags-box.js
                </a>
              
                
                <a class="source" href="tags-suggest.html">
                  tags-suggest.js
                </a>
              
                
                <a class="source" href="tags.html">
                  tags.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="updates.html">
                  updates.js
                </a>
              
                
                <a class="source" href="user-profile.html">
                  user-profile.js
                </a>
              
                
                <a class="source" href="user-suggest.html">
                  user-suggest.js
                </a>
              
                
                <a class="source" href="widgets.html">
                  widgets.js
                </a>
              
                
                <a class="source" href="media-audio-widget.html">
                  media-audio-widget.js
                </a>
              
                
                <a class="source" href="media-image-widget.html">
                  media-image-widget.js
                </a>
              
                
                <a class="source" href="media-video-widget.html">
                  media-video-widget.js
                </a>
              
                
                <a class="source" href="media-widgets.html">
                  media-widgets.js
                </a>
              
                
                <a class="source" href="text-widgets.html">
                  text-widgets.js
                </a>
              
                
                <a class="source" href="word-count.html">
                  word-count.js
                </a>
              
                
                <a class="source" href="wp-fullscreen-stub.html">
                  wp-fullscreen-stub.js
                </a>
              
                
                <a class="source" href="xfn.html">
                  xfn.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="theme-options.html">
                  theme-options.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="showcase.html">
                  showcase.js
                </a>
              
                
                <a class="source" href="color-scheme-control.html">
                  color-scheme-control.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="customizer.html">
                  customizer.js
                </a>
              
                
                <a class="source" href="featured-content-admin.html">
                  featured-content-admin.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="global.html">
                  global.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="jquery.scrollTo.html">
                  jquery.scrollTo.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="admin-bar.html">
                  admin-bar.js
                </a>
              
                
                <a class="source" href="autosave.html">
                  autosave.js
                </a>
              
                
                <a class="source" href="backbone.html">
                  backbone.js
                </a>
              
                
                <a class="source" href="backbone.min.html">
                  backbone.min.js
                </a>
              
                
                <a class="source" href="colorpicker.html">
                  colorpicker.js
                </a>
              
                
                <a class="source" href="comment-reply.html">
                  comment-reply.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-base.html">
                  customize-base.js
                </a>
              
                
                <a class="source" href="customize-loader.html">
                  customize-loader.js
                </a>
              
                
                <a class="source" href="customize-models.html">
                  customize-models.js
                </a>
              
                
                <a class="source" href="customize-preview-nav-menus.html">
                  customize-preview-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-preview-widgets.html">
                  customize-preview-widgets.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="customize-selective-refresh.html">
                  customize-selective-refresh.js
                </a>
              
                
                <a class="source" href="customize-views.html">
                  customize-views.js
                </a>
              
                
                <a class="source" href="heartbeat.html">
                  heartbeat.js
                </a>
              
                
                <a class="source" href="hoverIntent.html">
                  hoverIntent.js
                </a>
              
                
                <a class="source" href="imagesloaded.min.html">
                  imagesloaded.min.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.html">
                  jquery.imgareaselect.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.min.html">
                  jquery.imgareaselect.min.js
                </a>
              
                
                <a class="source" href="jquery.Jcrop.min.html">
                  jquery.Jcrop.min.js
                </a>
              
                
                <a class="source" href="jquery-migrate.html">
                  jquery-migrate.js
                </a>
              
                
                <a class="source" href="jquery-migrate.min.html">
                  jquery-migrate.min.js
                </a>
              
                
                <a class="source" href="jquery.color.min.html">
                  jquery.color.min.js
                </a>
              
                
                <a class="source" href="jquery.form.html">
                  jquery.form.js
                </a>
              
                
                <a class="source" href="jquery.form.min.html">
                  jquery.form.min.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.html">
                  jquery.hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.min.html">
                  jquery.hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.html">
                  jquery.js
                </a>
              
                
                <a class="source" href="jquery.masonry.html">
                  jquery.masonry.js
                </a>
              
                
                <a class="source" href="jquery.masonry.min.html">
                  jquery.masonry.min.js
                </a>
              
                
                <a class="source" href="jquery.query.html">
                  jquery.query.js
                </a>
              
                
                <a class="source" href="jquery.schedule.html">
                  jquery.schedule.js
                </a>
              
                
                <a class="source" href="jquery.serialize-object.html">
                  jquery.serialize-object.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.html">
                  jquery.table-hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.min.html">
                  jquery.table-hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.ui.touch-punch.html">
                  jquery.ui.touch-punch.js
                </a>
              
                
                <a class="source" href="suggest.html">
                  suggest.js
                </a>
              
                
                <a class="source" href="suggest.min.html">
                  suggest.min.js
                </a>
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="autocomplete.html">
                  autocomplete.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="core.html">
                  core.js
                </a>
              
                
                <a class="source" href="datepicker.html">
                  datepicker.js
                </a>
              
                
                <a class="source" href="dialog.html">
                  dialog.js
                </a>
              
                
                <a class="source" href="draggable.html">
                  draggable.js
                </a>
              
                
                <a class="source" href="droppable.html">
                  droppable.js
                </a>
              
                
                <a class="source" href="effect-blind.html">
                  effect-blind.js
                </a>
              
                
                <a class="source" href="effect-bounce.html">
                  effect-bounce.js
                </a>
              
                
                <a class="source" href="effect-clip.html">
                  effect-clip.js
                </a>
              
                
                <a class="source" href="effect-drop.html">
                  effect-drop.js
                </a>
              
                
                <a class="source" href="effect-explode.html">
                  effect-explode.js
                </a>
              
                
                <a class="source" href="effect-fade.html">
                  effect-fade.js
                </a>
              
                
                <a class="source" href="effect-fold.html">
                  effect-fold.js
                </a>
              
                
                <a class="source" href="effect-highlight.html">
                  effect-highlight.js
                </a>
              
                
                <a class="source" href="effect-puff.html">
                  effect-puff.js
                </a>
              
                
                <a class="source" href="effect-pulsate.html">
                  effect-pulsate.js
                </a>
              
                
                <a class="source" href="effect-scale.html">
                  effect-scale.js
                </a>
              
                
                <a class="source" href="effect-shake.html">
                  effect-shake.js
                </a>
              
                
                <a class="source" href="effect-size.html">
                  effect-size.js
                </a>
              
                
                <a class="source" href="effect-slide.html">
                  effect-slide.js
                </a>
              
                
                <a class="source" href="effect-transfer.html">
                  effect-transfer.js
                </a>
              
                
                <a class="source" href="effect.html">
                  effect.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="mouse.html">
                  mouse.js
                </a>
              
                
                <a class="source" href="position.html">
                  position.js
                </a>
              
                
                <a class="source" href="progressbar.html">
                  progressbar.js
                </a>
              
                
                <a class="source" href="resizable.html">
                  resizable.js
                </a>
              
                
                <a class="source" href="selectable.html">
                  selectable.js
                </a>
              
                
                <a class="source" href="selectmenu.html">
                  selectmenu.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="sortable.html">
                  sortable.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="tabs.html">
                  tabs.js
                </a>
              
                
                <a class="source" href="tooltip.html">
                  tooltip.js
                </a>
              
                
                <a class="source" href="widget.html">
                  widget.js
                </a>
              
                
                <a class="source" href="json2.html">
                  json2.js
                </a>
              
                
                <a class="source" href="masonry.min.html">
                  masonry.min.js
                </a>
              
                
                <a class="source" href="mce-view.html">
                  mce-view.js
                </a>
              
                
                <a class="source" href="media-audiovideo.html">
                  media-audiovideo.js
                </a>
              
                
                <a class="source" href="media-editor.html">
                  media-editor.js
                </a>
              
                
                <a class="source" href="media-grid.html">
                  media-grid.js
                </a>
              
                
                <a class="source" href="media-models.html">
                  media-models.js
                </a>
              
                
                <a class="source" href="media-views.html">
                  media-views.js
                </a>
              
                
                <a class="source" href="audiovideo.manifest.html">
                  audiovideo.manifest.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="collection-add.html">
                  collection-add.js
                </a>
              
                
                <a class="source" href="collection-edit.html">
                  collection-edit.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-image-cropper.html">
                  customize-image-cropper.js
                </a>
              
                
                <a class="source" href="edit-attachment-metadata.html">
                  edit-attachment-metadata.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="featured-image.html">
                  featured-image.js
                </a>
              
                
                <a class="source" href="gallery-add.html">
                  gallery-add.js
                </a>
              
                
                <a class="source" href="gallery-edit.html">
                  gallery-edit.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="media-library.html">
                  media-library.js
                </a>
              
                
                <a class="source" href="region.html">
                  region.js
                </a>
              
                
                <a class="source" href="replace-image.html">
                  replace-image.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="state-machine.html">
                  state-machine.js
                </a>
              
                
                <a class="source" href="state.html">
                  state.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="grid.manifest.html">
                  grid.manifest.js
                </a>
              
                
                <a class="source" href="models.manifest.html">
                  models.manifest.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="post-image.html">
                  post-image.js
                </a>
              
                
                <a class="source" href="post-media.html">
                  post-media.js
                </a>
              
                
                <a class="source" href="query.html">
                  query.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="selection-sync.html">
                  selection-sync.js
                </a>
              
                
                <a class="source" href="views.manifest.html">
                  views.manifest.js
                </a>
              
                
                <a class="source" href="attachment-compat.html">
                  attachment-compat.js
                </a>
              
                
                <a class="source" href="attachment-filters.html">
                  attachment-filters.js
                </a>
              
                
                <a class="source" href="all.html">
                  all.js
                </a>
              
                
                <a class="source" href="date.html">
                  date.js
                </a>
              
                
                <a class="source" href="uploaded.html">
                  uploaded.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="details-two-column.html">
                  details-two-column.js
                </a>
              
                
                <a class="source" href="details.html">
                  details.js
                </a>
              
                
                <a class="source" href="edit-library.html">
                  edit-library.js
                </a>
              
                
                <a class="source" href="edit-selection.html">
                  edit-selection.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="browser.html">
                  browser.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="button-group.html">
                  button-group.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="delete-selected-permanently.html">
                  delete-selected-permanently.js
                </a>
              
                
                <a class="source" href="delete-selected.html">
                  delete-selected.js
                </a>
              
                
                <a class="source" href="select-mode-toggle.html">
                  select-mode-toggle.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="edit-image-details.html">
                  edit-image-details.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="image.html">
                  image.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="url.html">
                  url.js
                </a>
              
                
                <a class="source" href="focus-manager.html">
                  focus-manager.js
                </a>
              
                
                <a class="source" href="frame.html">
                  frame.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="edit-attachments.html">
                  edit-attachments.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="iframe.html">
                  iframe.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="label.html">
                  label.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="media-frame.html">
                  media-frame.js
                </a>
              
                
                <a class="source" href="menu-item.html">
                  menu-item.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="modal.html">
                  modal.js
                </a>
              
                
                <a class="source" href="priority-list.html">
                  priority-list.js
                </a>
              
                
                <a class="source" href="router-item.html">
                  router-item.js
                </a>
              
                
                <a class="source" href="router.html">
                  router.js
                </a>
              
                
                <a class="source" href="search.html">
                  search.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="settings.html">
                  settings.js
                </a>
              
                
                <a class="source" href="attachment-display.html">
                  attachment-display.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="playlist.html">
                  playlist.js
                </a>
              
                
                <a class="source" href="sidebar.html">
                  sidebar.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="site-icon-preview.html">
                  site-icon-preview.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="toolbar.html">
                  toolbar.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="inline.html">
                  inline.js
                </a>
              
                
                <a class="source" href="status-error.html">
                  status-error.js
                </a>
              
                
                <a class="source" href="status.html">
                  status.js
                </a>
              
                
                <a class="source" href="window.html">
                  window.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="view.html">
                  view.js
                </a>
              
                
                <a class="source" href="froogaloop.min.html">
                  froogaloop.min.js
                </a>
              
                
                <a class="source" href="mediaelement-and-player.min.html">
                  mediaelement-and-player.min.js
                </a>
              
                
                <a class="source" href="wp-mediaelement.html">
                  wp-mediaelement.js
                </a>
              
                
                <a class="source" href="wp-playlist.html">
                  wp-playlist.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="plupload.full.min.html">
                  plupload.full.min.js
                </a>
              
                
                <a class="source" href="wp-plupload.html">
                  wp-plupload.js
                </a>
              
                
                <a class="source" href="quicktags.html">
                  quicktags.js
                </a>
              
                
                <a class="source" href="shortcode.html">
                  shortcode.js
                </a>
              
                
                <a class="source" href="swfobject.html">
                  swfobject.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="handlers.min.html">
                  handlers.min.js
                </a>
              
                
                <a class="source" href="swfupload.cookies.html">
                  swfupload.cookies.js
                </a>
              
                
                <a class="source" href="swfupload.queue.html">
                  swfupload.queue.js
                </a>
              
                
                <a class="source" href="swfupload.speed.html">
                  swfupload.speed.js
                </a>
              
                
                <a class="source" href="swfupload.swfobject.html">
                  swfupload.swfobject.js
                </a>
              
                
                <a class="source" href="swfupload.html">
                  swfupload.js
                </a>
              
                
                <a class="source" href="thickbox.html">
                  thickbox.js
                </a>
              
                
                <a class="source" href="wp-langs-en.html">
                  wp-langs-en.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="tiny_mce_popup.html">
                  tiny_mce_popup.js
                </a>
              
                
                <a class="source" href="tinymce.html">
                  tinymce.js
                </a>
              
                
                <a class="source" href="tinymce.min.html">
                  tinymce.min.js
                </a>
              
                
                <a class="source" href="editable_selects.html">
                  editable_selects.js
                </a>
              
                
                <a class="source" href="form_utils.html">
                  form_utils.js
                </a>
              
                
                <a class="source" href="mctabs.html">
                  mctabs.js
                </a>
              
                
                <a class="source" href="validate.html">
                  validate.js
                </a>
              
                
                <a class="source" href="tw-sack.html">
                  tw-sack.js
                </a>
              
                
                <a class="source" href="twemoji.html">
                  twemoji.js
                </a>
              
                
                <a class="source" href="underscore.html">
                  underscore.js
                </a>
              
                
                <a class="source" href="underscore.min.html">
                  underscore.min.js
                </a>
              
                
                <a class="source" href="utils.html">
                  utils.js
                </a>
              
                
                <a class="source" href="wp-a11y.html">
                  wp-a11y.js
                </a>
              
                
                <a class="source" href="wp-ajax-response.html">
                  wp-ajax-response.js
                </a>
              
                
                <a class="source" href="wp-api.html">
                  wp-api.js
                </a>
              
                
                <a class="source" href="wp-auth-check.html">
                  wp-auth-check.js
                </a>
              
                
                <a class="source" href="wp-backbone.html">
                  wp-backbone.js
                </a>
              
                
                <a class="source" href="wp-custom-header.html">
                  wp-custom-header.js
                </a>
              
                
                <a class="source" href="wp-embed-template.html">
                  wp-embed-template.js
                </a>
              
                
                <a class="source" href="wp-embed.html">
                  wp-embed.js
                </a>
              
                
                <a class="source" href="wp-emoji-loader.html">
                  wp-emoji-loader.js
                </a>
              
                
                <a class="source" href="wp-emoji.html">
                  wp-emoji.js
                </a>
              
                
                <a class="source" href="wp-list-revisions.html">
                  wp-list-revisions.js
                </a>
              
                
                <a class="source" href="wp-lists.html">
                  wp-lists.js
                </a>
              
                
                <a class="source" href="wp-pointer.html">
                  wp-pointer.js
                </a>
              
                
                <a class="source" href="wp-util.html">
                  wp-util.js
                </a>
              
                
                <a class="source" href="wpdialog.html">
                  wpdialog.js
                </a>
              
                
                <a class="source" href="wplink.html">
                  wplink.js
                </a>
              
                
                <a class="source" href="zxcvbn-async.html">
                  zxcvbn-async.js
                </a>
              
                
                <a class="source" href="zxcvbn.min.html">
                  zxcvbn.min.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>wplink.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> wpLink;

( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> $, wpLinkL10n, wp </span>) </span>{
	<span class="hljs-keyword">var</span> editor, searchTimer, River, Query, correctedURL, linkNode,
		emailRegexp = <span class="hljs-regexp">/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,63}$/i</span>,
		urlRegexp = <span class="hljs-regexp">/^(https?|ftp):\/\/[A-Z0-9.-]+\.[A-Z]{2,63}[^ "]*$/i</span>,
		inputs = {},
		rivers = {},
		isTouch = ( <span class="hljs-string">'ontouchend'</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">document</span> );

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getLink</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> linkNode || editor.dom.getParent( editor.selection.getNode(), <span class="hljs-string">'a[href]'</span> );
	}

	wpLink = {
		<span class="hljs-attr">timeToTriggerRiver</span>: <span class="hljs-number">150</span>,
		<span class="hljs-attr">minRiverAJAXDuration</span>: <span class="hljs-number">200</span>,
		<span class="hljs-attr">riverBottomThreshold</span>: <span class="hljs-number">5</span>,
		<span class="hljs-attr">keySensitivity</span>: <span class="hljs-number">100</span>,
		<span class="hljs-attr">lastSearch</span>: <span class="hljs-string">''</span>,
		<span class="hljs-attr">textarea</span>: <span class="hljs-string">''</span>,
		<span class="hljs-attr">modalOpen</span>: <span class="hljs-literal">false</span>,

		<span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			inputs.wrap = $(<span class="hljs-string">'#wp-link-wrap'</span>);
			inputs.dialog = $( <span class="hljs-string">'#wp-link'</span> );
			inputs.backdrop = $( <span class="hljs-string">'#wp-link-backdrop'</span> );
			inputs.submit = $( <span class="hljs-string">'#wp-link-submit'</span> );
			inputs.close = $( <span class="hljs-string">'#wp-link-close'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Input</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			inputs.text = $( <span class="hljs-string">'#wp-link-text'</span> );
			inputs.url = $( <span class="hljs-string">'#wp-link-url'</span> );
			inputs.nonce = $( <span class="hljs-string">'#_ajax_linking_nonce'</span> );
			inputs.openInNewTab = $( <span class="hljs-string">'#wp-link-target'</span> );
			inputs.search = $( <span class="hljs-string">'#wp-link-search'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Build Rivers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			rivers.search = <span class="hljs-keyword">new</span> River( $( <span class="hljs-string">'#search-results'</span> ) );
			rivers.recent = <span class="hljs-keyword">new</span> River( $( <span class="hljs-string">'#most-recent-results'</span> ) );
			rivers.elements = inputs.dialog.find( <span class="hljs-string">'.query-results'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Get search notice text</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			inputs.queryNotice = $( <span class="hljs-string">'#query-notice-message'</span> );
			inputs.queryNoticeTextDefault = inputs.queryNotice.find( <span class="hljs-string">'.query-notice-default'</span> );
			inputs.queryNoticeTextHint = inputs.queryNotice.find( <span class="hljs-string">'.query-notice-hint'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Bind event handlers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			inputs.dialog.keydown( wpLink.keydown );
			inputs.dialog.keyup( wpLink.keyup );
			inputs.submit.click( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
				event.preventDefault();
				wpLink.update();
			});

			inputs.close.add( inputs.backdrop ).add( <span class="hljs-string">'#wp-link-cancel button'</span> ).click( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
				event.preventDefault();
				wpLink.close();
			});

			rivers.elements.on( <span class="hljs-string">'river-select'</span>, wpLink.updateFields );</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Display ‘hint’ message when search field or ‘query-results’ box are focused</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			inputs.search.on( <span class="hljs-string">'focus.wplink'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				inputs.queryNoticeTextDefault.hide();
				inputs.queryNoticeTextHint.removeClass( <span class="hljs-string">'screen-reader-text'</span> ).show();
			} ).on( <span class="hljs-string">'blur.wplink'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				inputs.queryNoticeTextDefault.show();
				inputs.queryNoticeTextHint.addClass( <span class="hljs-string">'screen-reader-text'</span> ).hide();
			} );

			inputs.search.on( <span class="hljs-string">'keyup input'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-built_in">window</span>.clearTimeout( searchTimer );
				searchTimer = <span class="hljs-built_in">window</span>.setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					wpLink.searchInternalLinks();
				}, <span class="hljs-number">500</span> );
			});

			inputs.url.on( <span class="hljs-string">'paste'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				setTimeout( wpLink.correctURL, <span class="hljs-number">0</span> );
			} );

			inputs.url.on( <span class="hljs-string">'blur'</span>, wpLink.correctURL );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>If URL wasn’t corrected last time and doesn’t start with http:, https:, ? # or /, prepend http://</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		correctURL: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> url = $.trim( inputs.url.val() );

			<span class="hljs-keyword">if</span> ( url &amp;&amp; correctedURL !== url &amp;&amp; ! <span class="hljs-regexp">/^(?:[a-z]+:|#|\?|\.|\/)/</span>.test( url ) ) {
				inputs.url.val( <span class="hljs-string">'http://'</span> + url );
				correctedURL = url;
			}
		},

		<span class="hljs-attr">open</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editorId, url, text, node </span>) </span>{
			<span class="hljs-keyword">var</span> ed,
				$body = $( <span class="hljs-built_in">document</span>.body );

			$body.addClass( <span class="hljs-string">'modal-open'</span> );
			wpLink.modalOpen = <span class="hljs-literal">true</span>;
			linkNode = node;

			wpLink.range = <span class="hljs-literal">null</span>;

			<span class="hljs-keyword">if</span> ( editorId ) {
				<span class="hljs-built_in">window</span>.wpActiveEditor = editorId;
			}

			<span class="hljs-keyword">if</span> ( ! <span class="hljs-built_in">window</span>.wpActiveEditor ) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">this</span>.textarea = $( <span class="hljs-string">'#'</span> + <span class="hljs-built_in">window</span>.wpActiveEditor ).get( <span class="hljs-number">0</span> );

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.tinymce !== <span class="hljs-string">'undefined'</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Make sure the link wrapper is the last element in the body,
or the inline editor toolbar may show above the backdrop.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				$body.append( inputs.backdrop, inputs.wrap );

				ed = <span class="hljs-built_in">window</span>.tinymce.get( <span class="hljs-built_in">window</span>.wpActiveEditor );

				<span class="hljs-keyword">if</span> ( ed &amp;&amp; ! ed.isHidden() ) {
					editor = ed;
				} <span class="hljs-keyword">else</span> {
					editor = <span class="hljs-literal">null</span>;
				}
			}

			<span class="hljs-keyword">if</span> ( ! wpLink.isMCE() &amp;&amp; <span class="hljs-built_in">document</span>.selection ) {
				<span class="hljs-keyword">this</span>.textarea.focus();
				<span class="hljs-keyword">this</span>.range = <span class="hljs-built_in">document</span>.selection.createRange();
			}

			inputs.wrap.show();
			inputs.backdrop.show();

			wpLink.refresh( url, text );

			$( <span class="hljs-built_in">document</span> ).trigger( <span class="hljs-string">'wplink-open'</span>, inputs.wrap );
		},

		<span class="hljs-attr">isMCE</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> editor &amp;&amp; ! editor.isHidden();
		},

		<span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> url, text </span>) </span>{
			<span class="hljs-keyword">var</span> linkText = <span class="hljs-string">''</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Refresh rivers (clear links, check visibility)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			rivers.search.refresh();
			rivers.recent.refresh();

			<span class="hljs-keyword">if</span> ( wpLink.isMCE() ) {
				wpLink.mceRefresh( url, text );
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>For the Text editor the “Link text” field is always shown</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( ! inputs.wrap.hasClass( <span class="hljs-string">'has-text-field'</span> ) ) {
					inputs.wrap.addClass( <span class="hljs-string">'has-text-field'</span> );
				}

				<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">document</span>.selection ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Old IE</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					linkText = <span class="hljs-built_in">document</span>.selection.createRange().text || text || <span class="hljs-string">''</span>;
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.textarea.selectionStart !== <span class="hljs-string">'undefined'</span> &amp;&amp;
					( <span class="hljs-keyword">this</span>.textarea.selectionStart !== <span class="hljs-keyword">this</span>.textarea.selectionEnd ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>W3C</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					text = <span class="hljs-keyword">this</span>.textarea.value.substring( <span class="hljs-keyword">this</span>.textarea.selectionStart, <span class="hljs-keyword">this</span>.textarea.selectionEnd ) || text || <span class="hljs-string">''</span>;
				}

				inputs.text.val( text );
				wpLink.setDefaultValues();
			}

			<span class="hljs-keyword">if</span> ( isTouch ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Close the onscreen keyboard</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				inputs.url.focus().blur();
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Focus the URL field and highlight its contents.
If this is moved above the selection changes,
IE will show a flashing cursor over the dialog.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-built_in">window</span>.setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					inputs.url[<span class="hljs-number">0</span>].select();
					inputs.url.focus();
				} );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Load the most recent results if this is the first time opening the panel.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! rivers.recent.ul.children().length ) {
				rivers.recent.ajax();
			}

			correctedURL = inputs.url.val().replace( <span class="hljs-regexp">/^http:\/\//</span>, <span class="hljs-string">''</span> );
		},

		<span class="hljs-attr">hasSelectedText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> linkNode </span>) </span>{
			<span class="hljs-keyword">var</span> node, nodes, i, html = editor.selection.getContent();</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Partial html and not a fully selected anchor element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-regexp">/&lt;/</span>.test( html ) &amp;&amp; ( ! <span class="hljs-regexp">/^&lt;a [^&gt;]+&gt;[^&lt;]+&lt;\/a&gt;$/</span>.test( html ) || html.indexOf(<span class="hljs-string">'href='</span>) === <span class="hljs-number">-1</span> ) ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}

			<span class="hljs-keyword">if</span> ( linkNode ) {
				nodes = linkNode.childNodes;

				<span class="hljs-keyword">if</span> ( nodes.length === <span class="hljs-number">0</span> ) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}

				<span class="hljs-keyword">for</span> ( i = nodes.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i-- ) {
					node = nodes[i];

					<span class="hljs-keyword">if</span> ( node.nodeType != <span class="hljs-number">3</span> &amp;&amp; ! <span class="hljs-built_in">window</span>.tinymce.dom.BookmarkManager.isBookmarkNode( node ) ) {
						<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
					}
				}
			}

			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		},

		<span class="hljs-attr">mceRefresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> searchStr, text </span>) </span>{
			<span class="hljs-keyword">var</span> linkText, href,
				linkNode = getLink(),
				onlyText = <span class="hljs-keyword">this</span>.hasSelectedText( linkNode );

			<span class="hljs-keyword">if</span> ( linkNode ) {
				linkText = linkNode.textContent || linkNode.innerText;
				href = editor.dom.getAttrib( linkNode, <span class="hljs-string">'href'</span> );

				<span class="hljs-keyword">if</span> ( ! $.trim( linkText ) ) {
					linkText = text || <span class="hljs-string">''</span>;
				}

				<span class="hljs-keyword">if</span> ( searchStr &amp;&amp; ( urlRegexp.test( searchStr ) || emailRegexp.test( searchStr ) ) ) {
					href = searchStr;
				}

				<span class="hljs-keyword">if</span> ( href !== <span class="hljs-string">'_wp_link_placeholder'</span> ) {
					inputs.url.val( href );
					inputs.openInNewTab.prop( <span class="hljs-string">'checked'</span>, <span class="hljs-string">'_blank'</span> === editor.dom.getAttrib( linkNode, <span class="hljs-string">'target'</span> ) );
					inputs.submit.val( wpLinkL10n.update );
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">this</span>.setDefaultValues( linkText );
				}

				<span class="hljs-keyword">if</span> ( searchStr &amp;&amp; searchStr !== href ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>The user has typed something in the inline dialog. Trigger a search with it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					inputs.search.val( searchStr );
				} <span class="hljs-keyword">else</span> {
					inputs.search.val( <span class="hljs-string">''</span> );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Always reset the search</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-built_in">window</span>.setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					wpLink.searchInternalLinks();
				} );
			} <span class="hljs-keyword">else</span> {
				linkText = editor.selection.getContent({ <span class="hljs-attr">format</span>: <span class="hljs-string">'text'</span> }) || text || <span class="hljs-string">''</span>;
				<span class="hljs-keyword">this</span>.setDefaultValues( linkText );
			}

			<span class="hljs-keyword">if</span> ( onlyText ) {
				inputs.text.val( linkText );
				inputs.wrap.addClass( <span class="hljs-string">'has-text-field'</span> );
			} <span class="hljs-keyword">else</span> {
				inputs.text.val( <span class="hljs-string">''</span> );
				inputs.wrap.removeClass( <span class="hljs-string">'has-text-field'</span> );
			}
		},

		<span class="hljs-attr">close</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> reset </span>) </span>{
			$( <span class="hljs-built_in">document</span>.body ).removeClass( <span class="hljs-string">'modal-open'</span> );
			wpLink.modalOpen = <span class="hljs-literal">false</span>;

			<span class="hljs-keyword">if</span> ( reset !== <span class="hljs-string">'noReset'</span> ) {
				<span class="hljs-keyword">if</span> ( ! wpLink.isMCE() ) {
					wpLink.textarea.focus();

					<span class="hljs-keyword">if</span> ( wpLink.range ) {
						wpLink.range.moveToBookmark( wpLink.range.getBookmark() );
						wpLink.range.select();
					}
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">if</span> ( editor.plugins.wplink ) {
						editor.plugins.wplink.close();
					}

					editor.focus();
				}
			}

			inputs.backdrop.hide();
			inputs.wrap.hide();

			correctedURL = <span class="hljs-literal">false</span>;

			$( <span class="hljs-built_in">document</span> ).trigger( <span class="hljs-string">'wplink-close'</span>, inputs.wrap );
		},

		<span class="hljs-attr">getAttrs</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			wpLink.correctURL();

			<span class="hljs-keyword">return</span> {
				<span class="hljs-attr">href</span>: $.trim( inputs.url.val() ),
				<span class="hljs-attr">target</span>: inputs.openInNewTab.prop( <span class="hljs-string">'checked'</span> ) ? <span class="hljs-string">'_blank'</span> : <span class="hljs-literal">null</span>
			};
		},

		<span class="hljs-attr">buildHtml</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attrs</span>) </span>{
			<span class="hljs-keyword">var</span> html = <span class="hljs-string">'&lt;a href="'</span> + attrs.href + <span class="hljs-string">'"'</span>;

			<span class="hljs-keyword">if</span> ( attrs.target ) {
				html += <span class="hljs-string">' target="'</span> + attrs.target + <span class="hljs-string">'"'</span>;
			}

			<span class="hljs-keyword">return</span> html + <span class="hljs-string">'&gt;'</span>;
		},

		<span class="hljs-attr">update</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">if</span> ( wpLink.isMCE() ) {
				wpLink.mceUpdate();
			} <span class="hljs-keyword">else</span> {
				wpLink.htmlUpdate();
			}
		},

		<span class="hljs-attr">htmlUpdate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> attrs, text, html, begin, end, cursor, selection,
				textarea = wpLink.textarea;

			<span class="hljs-keyword">if</span> ( ! textarea ) {
				<span class="hljs-keyword">return</span>;
			}

			attrs = wpLink.getAttrs();
			text = inputs.text.val();</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>If there’s no href, return.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! attrs.href ) {
				<span class="hljs-keyword">return</span>;
			}

			html = wpLink.buildHtml(attrs);</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Insert HTML</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">document</span>.selection &amp;&amp; wpLink.range ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>IE
Note: If no text is selected, IE will not place the cursor
      inside the closing tag.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				textarea.focus();
				wpLink.range.text = html + ( text || wpLink.range.text ) + <span class="hljs-string">'&lt;/a&gt;'</span>;
				wpLink.range.moveToBookmark( wpLink.range.getBookmark() );
				wpLink.range.select();

				wpLink.range = <span class="hljs-literal">null</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> textarea.selectionStart !== <span class="hljs-string">'undefined'</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>W3C</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				begin = textarea.selectionStart;
				end = textarea.selectionEnd;
				selection = text || textarea.value.substring( begin, end );
				html = html + selection + <span class="hljs-string">'&lt;/a&gt;'</span>;
				cursor = begin + html.length;</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>If no text is selected, place the cursor inside the closing tag.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( begin === end &amp;&amp; ! selection ) {
					cursor -= <span class="hljs-number">4</span>;
				}

				textarea.value = (
					textarea.value.substring( <span class="hljs-number">0</span>, begin ) +
					html +
					textarea.value.substring( end, textarea.value.length )
				);</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Update cursor position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				textarea.selectionStart = textarea.selectionEnd = cursor;
			}

			wpLink.close();
			textarea.focus();
			$( textarea ).trigger( <span class="hljs-string">'change'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Audible confirmation message when a link has been inserted in the Editor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			wp.a11y.speak( wpLinkL10n.linkInserted );
		},

		<span class="hljs-attr">mceUpdate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> attrs = wpLink.getAttrs(),
				$link, text, hasText, $mceCaret;

			<span class="hljs-keyword">if</span> ( ! attrs.href ) {
				editor.execCommand( <span class="hljs-string">'unlink'</span> );
				wpLink.close();
				<span class="hljs-keyword">return</span>;
			}

			$link = editor.$( getLink() );

			editor.undoManager.transact( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">if</span> ( ! $link.length ) {
					editor.execCommand( <span class="hljs-string">'mceInsertLink'</span>, <span class="hljs-literal">false</span>, { <span class="hljs-attr">href</span>: <span class="hljs-string">'_wp_link_placeholder'</span>, <span class="hljs-string">'data-wp-temp-link'</span>: <span class="hljs-number">1</span> } );
					$link = editor.$( <span class="hljs-string">'a[data-wp-temp-link="1"]'</span> ).removeAttr( <span class="hljs-string">'data-wp-temp-link'</span> );
					hasText = $.trim( $link.text() );
				}

				<span class="hljs-keyword">if</span> ( ! $link.length ) {
					editor.execCommand( <span class="hljs-string">'unlink'</span> );
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">if</span> ( inputs.wrap.hasClass( <span class="hljs-string">'has-text-field'</span> ) ) {
						text = inputs.text.val();

						<span class="hljs-keyword">if</span> ( text ) {
							$link.text( text );
						} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( ! hasText ) {
							$link.text( attrs.href );
						}
					}

					attrs[<span class="hljs-string">'data-wplink-edit'</span>] = <span class="hljs-literal">null</span>;
					attrs[<span class="hljs-string">'data-mce-href'</span>] = <span class="hljs-literal">null</span>; <span class="hljs-comment">// attrs.href</span>
					$link.attr( attrs );
				}
			} );

			wpLink.close( <span class="hljs-string">'noReset'</span> );
			editor.focus();

			<span class="hljs-keyword">if</span> ( $link.length ) {
				$mceCaret = $link.parent( <span class="hljs-string">'#_mce_caret'</span> );

				<span class="hljs-keyword">if</span> ( $mceCaret.length ) {
					$mceCaret.before( $link.removeAttr( <span class="hljs-string">'data-mce-bogus'</span> ) );
				}

				editor.selection.select( $link[<span class="hljs-number">0</span>] );
				editor.selection.collapse();

				<span class="hljs-keyword">if</span> ( editor.plugins.wplink ) {
					editor.plugins.wplink.checkLink( $link[<span class="hljs-number">0</span>] );
				}
			}

			editor.nodeChanged();</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Audible confirmation message when a link has been inserted in the Editor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			wp.a11y.speak( wpLinkL10n.linkInserted );
		},

		<span class="hljs-attr">updateFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> e, li </span>) </span>{
			inputs.url.val( li.children( <span class="hljs-string">'.item-permalink'</span> ).val() );
		},

		<span class="hljs-attr">getUrlFromSelection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> selection </span>) </span>{
			<span class="hljs-keyword">if</span> ( ! selection ) {
				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isMCE() ) {
					selection = editor.selection.getContent({ <span class="hljs-attr">format</span>: <span class="hljs-string">'text'</span> });
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">document</span>.selection &amp;&amp; wpLink.range ) {
					selection = wpLink.range.text;
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.textarea.selectionStart !== <span class="hljs-string">'undefined'</span> ) {
					selection = <span class="hljs-keyword">this</span>.textarea.value.substring( <span class="hljs-keyword">this</span>.textarea.selectionStart, <span class="hljs-keyword">this</span>.textarea.selectionEnd );
				}
			}

			selection = $.trim( selection );

			<span class="hljs-keyword">if</span> ( selection &amp;&amp; emailRegexp.test( selection ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Selection is email address</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span> <span class="hljs-string">'mailto:'</span> + selection;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( selection &amp;&amp; urlRegexp.test( selection ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Selection is URL</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span> selection.replace( <span class="hljs-regexp">/&amp;amp;|&amp;#0?38;/gi</span>, <span class="hljs-string">'&amp;'</span> );
			}

			<span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
		},

		<span class="hljs-attr">setDefaultValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> selection </span>) </span>{
			inputs.url.val( <span class="hljs-keyword">this</span>.getUrlFromSelection( selection ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Empty the search field and swap the “rivers”.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			inputs.search.val(<span class="hljs-string">''</span>);
			wpLink.searchInternalLinks();</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Update save prompt.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			inputs.submit.val( wpLinkL10n.save );
		},

		<span class="hljs-attr">searchInternalLinks</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> waiting,
				search = inputs.search.val() || <span class="hljs-string">''</span>;

			<span class="hljs-keyword">if</span> ( search.length &gt; <span class="hljs-number">2</span> ) {
				rivers.recent.hide();
				rivers.search.show();</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Don’t search if the keypress didn’t change the title.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( wpLink.lastSearch == search )
					<span class="hljs-keyword">return</span>;

				wpLink.lastSearch = search;
				waiting = inputs.search.parent().find( <span class="hljs-string">'.spinner'</span> ).addClass( <span class="hljs-string">'is-active'</span> );

				rivers.search.change( search );
				rivers.search.ajax( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					waiting.removeClass( <span class="hljs-string">'is-active'</span> );
				});
			} <span class="hljs-keyword">else</span> {
				rivers.search.hide();
				rivers.recent.show();
			}
		},

		<span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			rivers.search.next();
			rivers.recent.next();
		},

		<span class="hljs-attr">prev</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			rivers.search.prev();
			rivers.recent.prev();
		},

		<span class="hljs-attr">keydown</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
			<span class="hljs-keyword">var</span> fn, id;</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Escape key.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-number">27</span> === event.keyCode ) {
				wpLink.close();
				event.stopImmediatePropagation();</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Tab key.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-number">9</span> === event.keyCode ) {
				id = event.target.id;</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>wp-link-submit must always be the last focusable element in the dialog.
following focusable elements will be skipped on keyboard navigation.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( id === <span class="hljs-string">'wp-link-submit'</span> &amp;&amp; ! event.shiftKey ) {
					inputs.close.focus();
					event.preventDefault();
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( id === <span class="hljs-string">'wp-link-close'</span> &amp;&amp; event.shiftKey ) {
					inputs.submit.focus();
					event.preventDefault();
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Up Arrow and Down Arrow keys.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-number">38</span> !== event.keyCode &amp;&amp; <span class="hljs-number">40</span> !== event.keyCode ) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">document</span>.activeElement &amp;&amp;
				( <span class="hljs-built_in">document</span>.activeElement.id === <span class="hljs-string">'link-title-field'</span> || <span class="hljs-built_in">document</span>.activeElement.id === <span class="hljs-string">'url-field'</span> ) ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Up Arrow key.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			fn = <span class="hljs-number">38</span> === event.keyCode ? <span class="hljs-string">'prev'</span> : <span class="hljs-string">'next'</span>;
			clearInterval( wpLink.keyInterval );
			wpLink[ fn ]();
			wpLink.keyInterval = setInterval( wpLink[ fn ], wpLink.keySensitivity );
			event.preventDefault();
		},

		<span class="hljs-attr">keyup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Up Arrow and Down Arrow keys.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-number">38</span> === event.keyCode || <span class="hljs-number">40</span> === event.keyCode ) {
				clearInterval( wpLink.keyInterval );
				event.preventDefault();
			}
		},

		<span class="hljs-attr">delayedCallback</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> func, delay </span>) </span>{
			<span class="hljs-keyword">var</span> timeoutTriggered, funcTriggered, funcArgs, funcContext;

			<span class="hljs-keyword">if</span> ( ! delay )
				<span class="hljs-keyword">return</span> func;

			setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">if</span> ( funcTriggered )
					<span class="hljs-keyword">return</span> func.apply( funcContext, funcArgs );</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Otherwise, wait.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				timeoutTriggered = <span class="hljs-literal">true</span>;
			}, delay );

			<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">if</span> ( timeoutTriggered )
					<span class="hljs-keyword">return</span> func.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Otherwise, wait.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				funcArgs = <span class="hljs-built_in">arguments</span>;
				funcContext = <span class="hljs-keyword">this</span>;
				funcTriggered = <span class="hljs-literal">true</span>;
			};
		}
	};

	River = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> element, search </span>) </span>{
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
		<span class="hljs-keyword">this</span>.element = element;
		<span class="hljs-keyword">this</span>.ul = element.children( <span class="hljs-string">'ul'</span> );
		<span class="hljs-keyword">this</span>.contentHeight = element.children( <span class="hljs-string">'#link-selector-height'</span> );
		<span class="hljs-keyword">this</span>.waiting = element.find(<span class="hljs-string">'.river-waiting'</span>);

		<span class="hljs-keyword">this</span>.change( search );
		<span class="hljs-keyword">this</span>.refresh();

		$( <span class="hljs-string">'#wp-link .query-results, #wp-link #link-selector'</span> ).scroll( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			self.maybeLoad();
		});
		element.on( <span class="hljs-string">'click'</span>, <span class="hljs-string">'li'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
			self.select( $( <span class="hljs-keyword">this</span> ), event );
		});
	};

	$.extend( River.prototype, {
		<span class="hljs-attr">refresh</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">this</span>.deselect();
			<span class="hljs-keyword">this</span>.visible = <span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">':visible'</span> );
		},
		<span class="hljs-attr">show</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.visible ) {
				<span class="hljs-keyword">this</span>.deselect();
				<span class="hljs-keyword">this</span>.element.show();
				<span class="hljs-keyword">this</span>.visible = <span class="hljs-literal">true</span>;
			}
		},
		<span class="hljs-attr">hide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">this</span>.element.hide();
			<span class="hljs-keyword">this</span>.visible = <span class="hljs-literal">false</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Selects a list item and triggers the river-select event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		select: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> li, event </span>) </span>{
			<span class="hljs-keyword">var</span> liHeight, elHeight, liTop, elTop;

			<span class="hljs-keyword">if</span> ( li.hasClass( <span class="hljs-string">'unselectable'</span> ) || li == <span class="hljs-keyword">this</span>.selected )
				<span class="hljs-keyword">return</span>;

			<span class="hljs-keyword">this</span>.deselect();
			<span class="hljs-keyword">this</span>.selected = li.addClass( <span class="hljs-string">'selected'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Make sure the element is visible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			liHeight = li.outerHeight();
			elHeight = <span class="hljs-keyword">this</span>.element.height();
			liTop = li.position().top;
			elTop = <span class="hljs-keyword">this</span>.element.scrollTop();

			<span class="hljs-keyword">if</span> ( liTop &lt; <span class="hljs-number">0</span> ) <span class="hljs-comment">// Make first visible element</span>
				<span class="hljs-keyword">this</span>.element.scrollTop( elTop + liTop );
			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( liTop + liHeight &gt; elHeight ) <span class="hljs-comment">// Make last visible element</span>
				<span class="hljs-keyword">this</span>.element.scrollTop( elTop + liTop - elHeight + liHeight );</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Trigger the river-select event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.element.trigger( <span class="hljs-string">'river-select'</span>, [ li, event, <span class="hljs-keyword">this</span> ] );
		},
		<span class="hljs-attr">deselect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.selected )
				<span class="hljs-keyword">this</span>.selected.removeClass( <span class="hljs-string">'selected'</span> );
			<span class="hljs-keyword">this</span>.selected = <span class="hljs-literal">false</span>;
		},
		<span class="hljs-attr">prev</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.visible )
				<span class="hljs-keyword">return</span>;

			<span class="hljs-keyword">var</span> to;
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.selected ) {
				to = <span class="hljs-keyword">this</span>.selected.prev( <span class="hljs-string">'li'</span> );
				<span class="hljs-keyword">if</span> ( to.length )
					<span class="hljs-keyword">this</span>.select( to );
			}
		},
		<span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.visible )
				<span class="hljs-keyword">return</span>;

			<span class="hljs-keyword">var</span> to = <span class="hljs-keyword">this</span>.selected ? <span class="hljs-keyword">this</span>.selected.next( <span class="hljs-string">'li'</span> ) : $( <span class="hljs-string">'li:not(.unselectable):first'</span>, <span class="hljs-keyword">this</span>.element );
			<span class="hljs-keyword">if</span> ( to.length )
				<span class="hljs-keyword">this</span>.select( to );
		},
		<span class="hljs-attr">ajax</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> callback </span>) </span>{
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
				delay = <span class="hljs-keyword">this</span>.query.page == <span class="hljs-number">1</span> ? <span class="hljs-number">0</span> : wpLink.minRiverAJAXDuration,
				response = wpLink.delayedCallback( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> results, params </span>) </span>{
					self.process( results, params );
					<span class="hljs-keyword">if</span> ( callback )
						callback( results, params );
				}, delay );

			<span class="hljs-keyword">this</span>.query.ajax( response );
		},
		<span class="hljs-attr">change</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> search </span>) </span>{
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.query &amp;&amp; <span class="hljs-keyword">this</span>._search == search )
				<span class="hljs-keyword">return</span>;

			<span class="hljs-keyword">this</span>._search = search;
			<span class="hljs-keyword">this</span>.query = <span class="hljs-keyword">new</span> Query( search );
			<span class="hljs-keyword">this</span>.element.scrollTop( <span class="hljs-number">0</span> );
		},
		<span class="hljs-attr">process</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> results, params </span>) </span>{
			<span class="hljs-keyword">var</span> list = <span class="hljs-string">''</span>, alt = <span class="hljs-literal">true</span>, classes = <span class="hljs-string">''</span>,
				firstPage = params.page == <span class="hljs-number">1</span>;

			<span class="hljs-keyword">if</span> ( ! results ) {
				<span class="hljs-keyword">if</span> ( firstPage ) {
					list += <span class="hljs-string">'&lt;li class="unselectable no-matches-found"&gt;&lt;span class="item-title"&gt;&lt;em&gt;'</span> +
						wpLinkL10n.noMatchesFound + <span class="hljs-string">'&lt;/em&gt;&lt;/span&gt;&lt;/li&gt;'</span>;
				}
			} <span class="hljs-keyword">else</span> {
				$.each( results, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					classes = alt ? <span class="hljs-string">'alternate'</span> : <span class="hljs-string">''</span>;
					classes += <span class="hljs-keyword">this</span>.title ? <span class="hljs-string">''</span> : <span class="hljs-string">' no-title'</span>;
					list += classes ? <span class="hljs-string">'&lt;li class="'</span> + classes + <span class="hljs-string">'"&gt;'</span> : <span class="hljs-string">'&lt;li&gt;'</span>;
					list += <span class="hljs-string">'&lt;input type="hidden" class="item-permalink" value="'</span> + <span class="hljs-keyword">this</span>.permalink + <span class="hljs-string">'" /&gt;'</span>;
					list += <span class="hljs-string">'&lt;span class="item-title"&gt;'</span>;
					list += <span class="hljs-keyword">this</span>.title ? <span class="hljs-keyword">this</span>.title : wpLinkL10n.noTitle;
					list += <span class="hljs-string">'&lt;/span&gt;&lt;span class="item-info"&gt;'</span> + <span class="hljs-keyword">this</span>.info + <span class="hljs-string">'&lt;/span&gt;&lt;/li&gt;'</span>;
					alt = ! alt;
				});
			}

			<span class="hljs-keyword">this</span>.ul[ firstPage ? <span class="hljs-string">'html'</span> : <span class="hljs-string">'append'</span> ]( list );
		},
		<span class="hljs-attr">maybeLoad</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
				el = <span class="hljs-keyword">this</span>.element,
				bottom = el.scrollTop() + el.height();

			<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.query.ready() || bottom &lt; <span class="hljs-keyword">this</span>.contentHeight.height() - wpLink.riverBottomThreshold )
				<span class="hljs-keyword">return</span>;

			setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">var</span> newTop = el.scrollTop(),
					newBottom = newTop + el.height();

				<span class="hljs-keyword">if</span> ( ! self.query.ready() || newBottom &lt; self.contentHeight.height() - wpLink.riverBottomThreshold )
					<span class="hljs-keyword">return</span>;

				self.waiting.addClass( <span class="hljs-string">'is-active'</span> );
				el.scrollTop( newTop + self.waiting.outerHeight() );

				self.ajax( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					self.waiting.removeClass( <span class="hljs-string">'is-active'</span> );
				});
			}, wpLink.timeToTriggerRiver );
		}
	});

	Query = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> search </span>) </span>{
		<span class="hljs-keyword">this</span>.page = <span class="hljs-number">1</span>;
		<span class="hljs-keyword">this</span>.allLoaded = <span class="hljs-literal">false</span>;
		<span class="hljs-keyword">this</span>.querying = <span class="hljs-literal">false</span>;
		<span class="hljs-keyword">this</span>.search = search;
	};

	$.extend( Query.prototype, {
		<span class="hljs-attr">ready</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> ! ( <span class="hljs-keyword">this</span>.querying || <span class="hljs-keyword">this</span>.allLoaded );
		},
		<span class="hljs-attr">ajax</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> callback </span>) </span>{
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
				query = {
					<span class="hljs-attr">action</span> : <span class="hljs-string">'wp-link-ajax'</span>,
					<span class="hljs-attr">page</span> : <span class="hljs-keyword">this</span>.page,
					<span class="hljs-string">'_ajax_linking_nonce'</span> : inputs.nonce.val()
				};

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.search )
				query.search = <span class="hljs-keyword">this</span>.search;

			<span class="hljs-keyword">this</span>.querying = <span class="hljs-literal">true</span>;

			$.post( <span class="hljs-built_in">window</span>.ajaxurl, query, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> r </span>) </span>{
				self.page++;
				self.querying = <span class="hljs-literal">false</span>;
				self.allLoaded = ! r;
				callback( r, query );
			}, <span class="hljs-string">'json'</span> );
		}
	});

	$( <span class="hljs-built_in">document</span> ).ready( wpLink.init );
})( jQuery, <span class="hljs-built_in">window</span>.wpLinkL10n, <span class="hljs-built_in">window</span>.wp );</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
