<!DOCTYPE html>

<html>
<head>
  <title>media-models.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="bookmarklet.html">
                  bookmarklet.js
                </a>
              
                
                <a class="source" href="bookmarklet.min.html">
                  bookmarklet.min.js
                </a>
              
                
                <a class="source" href="color-picker.html">
                  color-picker.js
                </a>
              
                
                <a class="source" href="comment.html">
                  comment.js
                </a>
              
                
                <a class="source" href="common.html">
                  common.js
                </a>
              
                
                <a class="source" href="custom-background.html">
                  custom-background.js
                </a>
              
                
                <a class="source" href="custom-header.html">
                  custom-header.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-nav-menus.html">
                  customize-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-widgets.html">
                  customize-widgets.js
                </a>
              
                
                <a class="source" href="dashboard.html">
                  dashboard.js
                </a>
              
                
                <a class="source" href="edit-comments.html">
                  edit-comments.js
                </a>
              
                
                <a class="source" href="editor-expand.html">
                  editor-expand.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="farbtastic.html">
                  farbtastic.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="image-edit.html">
                  image-edit.js
                </a>
              
                
                <a class="source" href="inline-edit-post.html">
                  inline-edit-post.js
                </a>
              
                
                <a class="source" href="inline-edit-tax.html">
                  inline-edit-tax.js
                </a>
              
                
                <a class="source" href="iris.min.html">
                  iris.min.js
                </a>
              
                
                <a class="source" href="language-chooser.html">
                  language-chooser.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="media-gallery.html">
                  media-gallery.js
                </a>
              
                
                <a class="source" href="media-upload.html">
                  media-upload.js
                </a>
              
                
                <a class="source" href="media.html">
                  media.js
                </a>
              
                
                <a class="source" href="nav-menu.html">
                  nav-menu.js
                </a>
              
                
                <a class="source" href="password-strength-meter.html">
                  password-strength-meter.js
                </a>
              
                
                <a class="source" href="plugin-install.html">
                  plugin-install.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="postbox.html">
                  postbox.js
                </a>
              
                
                <a class="source" href="press-this.html">
                  press-this.js
                </a>
              
                
                <a class="source" href="revisions.html">
                  revisions.js
                </a>
              
                
                <a class="source" href="set-post-thumbnail.html">
                  set-post-thumbnail.js
                </a>
              
                
                <a class="source" href="svg-painter.html">
                  svg-painter.js
                </a>
              
                
                <a class="source" href="tags-box.html">
                  tags-box.js
                </a>
              
                
                <a class="source" href="tags-suggest.html">
                  tags-suggest.js
                </a>
              
                
                <a class="source" href="tags.html">
                  tags.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="updates.html">
                  updates.js
                </a>
              
                
                <a class="source" href="user-profile.html">
                  user-profile.js
                </a>
              
                
                <a class="source" href="user-suggest.html">
                  user-suggest.js
                </a>
              
                
                <a class="source" href="widgets.html">
                  widgets.js
                </a>
              
                
                <a class="source" href="media-audio-widget.html">
                  media-audio-widget.js
                </a>
              
                
                <a class="source" href="media-image-widget.html">
                  media-image-widget.js
                </a>
              
                
                <a class="source" href="media-video-widget.html">
                  media-video-widget.js
                </a>
              
                
                <a class="source" href="media-widgets.html">
                  media-widgets.js
                </a>
              
                
                <a class="source" href="text-widgets.html">
                  text-widgets.js
                </a>
              
                
                <a class="source" href="word-count.html">
                  word-count.js
                </a>
              
                
                <a class="source" href="wp-fullscreen-stub.html">
                  wp-fullscreen-stub.js
                </a>
              
                
                <a class="source" href="xfn.html">
                  xfn.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="theme-options.html">
                  theme-options.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="showcase.html">
                  showcase.js
                </a>
              
                
                <a class="source" href="color-scheme-control.html">
                  color-scheme-control.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="customizer.html">
                  customizer.js
                </a>
              
                
                <a class="source" href="featured-content-admin.html">
                  featured-content-admin.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="global.html">
                  global.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="jquery.scrollTo.html">
                  jquery.scrollTo.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="admin-bar.html">
                  admin-bar.js
                </a>
              
                
                <a class="source" href="autosave.html">
                  autosave.js
                </a>
              
                
                <a class="source" href="backbone.html">
                  backbone.js
                </a>
              
                
                <a class="source" href="backbone.min.html">
                  backbone.min.js
                </a>
              
                
                <a class="source" href="colorpicker.html">
                  colorpicker.js
                </a>
              
                
                <a class="source" href="comment-reply.html">
                  comment-reply.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-base.html">
                  customize-base.js
                </a>
              
                
                <a class="source" href="customize-loader.html">
                  customize-loader.js
                </a>
              
                
                <a class="source" href="customize-models.html">
                  customize-models.js
                </a>
              
                
                <a class="source" href="customize-preview-nav-menus.html">
                  customize-preview-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-preview-widgets.html">
                  customize-preview-widgets.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="customize-selective-refresh.html">
                  customize-selective-refresh.js
                </a>
              
                
                <a class="source" href="customize-views.html">
                  customize-views.js
                </a>
              
                
                <a class="source" href="heartbeat.html">
                  heartbeat.js
                </a>
              
                
                <a class="source" href="hoverIntent.html">
                  hoverIntent.js
                </a>
              
                
                <a class="source" href="imagesloaded.min.html">
                  imagesloaded.min.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.html">
                  jquery.imgareaselect.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.min.html">
                  jquery.imgareaselect.min.js
                </a>
              
                
                <a class="source" href="jquery.Jcrop.min.html">
                  jquery.Jcrop.min.js
                </a>
              
                
                <a class="source" href="jquery-migrate.html">
                  jquery-migrate.js
                </a>
              
                
                <a class="source" href="jquery-migrate.min.html">
                  jquery-migrate.min.js
                </a>
              
                
                <a class="source" href="jquery.color.min.html">
                  jquery.color.min.js
                </a>
              
                
                <a class="source" href="jquery.form.html">
                  jquery.form.js
                </a>
              
                
                <a class="source" href="jquery.form.min.html">
                  jquery.form.min.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.html">
                  jquery.hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.min.html">
                  jquery.hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.html">
                  jquery.js
                </a>
              
                
                <a class="source" href="jquery.masonry.html">
                  jquery.masonry.js
                </a>
              
                
                <a class="source" href="jquery.masonry.min.html">
                  jquery.masonry.min.js
                </a>
              
                
                <a class="source" href="jquery.query.html">
                  jquery.query.js
                </a>
              
                
                <a class="source" href="jquery.schedule.html">
                  jquery.schedule.js
                </a>
              
                
                <a class="source" href="jquery.serialize-object.html">
                  jquery.serialize-object.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.html">
                  jquery.table-hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.min.html">
                  jquery.table-hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.ui.touch-punch.html">
                  jquery.ui.touch-punch.js
                </a>
              
                
                <a class="source" href="suggest.html">
                  suggest.js
                </a>
              
                
                <a class="source" href="suggest.min.html">
                  suggest.min.js
                </a>
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="autocomplete.html">
                  autocomplete.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="core.html">
                  core.js
                </a>
              
                
                <a class="source" href="datepicker.html">
                  datepicker.js
                </a>
              
                
                <a class="source" href="dialog.html">
                  dialog.js
                </a>
              
                
                <a class="source" href="draggable.html">
                  draggable.js
                </a>
              
                
                <a class="source" href="droppable.html">
                  droppable.js
                </a>
              
                
                <a class="source" href="effect-blind.html">
                  effect-blind.js
                </a>
              
                
                <a class="source" href="effect-bounce.html">
                  effect-bounce.js
                </a>
              
                
                <a class="source" href="effect-clip.html">
                  effect-clip.js
                </a>
              
                
                <a class="source" href="effect-drop.html">
                  effect-drop.js
                </a>
              
                
                <a class="source" href="effect-explode.html">
                  effect-explode.js
                </a>
              
                
                <a class="source" href="effect-fade.html">
                  effect-fade.js
                </a>
              
                
                <a class="source" href="effect-fold.html">
                  effect-fold.js
                </a>
              
                
                <a class="source" href="effect-highlight.html">
                  effect-highlight.js
                </a>
              
                
                <a class="source" href="effect-puff.html">
                  effect-puff.js
                </a>
              
                
                <a class="source" href="effect-pulsate.html">
                  effect-pulsate.js
                </a>
              
                
                <a class="source" href="effect-scale.html">
                  effect-scale.js
                </a>
              
                
                <a class="source" href="effect-shake.html">
                  effect-shake.js
                </a>
              
                
                <a class="source" href="effect-size.html">
                  effect-size.js
                </a>
              
                
                <a class="source" href="effect-slide.html">
                  effect-slide.js
                </a>
              
                
                <a class="source" href="effect-transfer.html">
                  effect-transfer.js
                </a>
              
                
                <a class="source" href="effect.html">
                  effect.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="mouse.html">
                  mouse.js
                </a>
              
                
                <a class="source" href="position.html">
                  position.js
                </a>
              
                
                <a class="source" href="progressbar.html">
                  progressbar.js
                </a>
              
                
                <a class="source" href="resizable.html">
                  resizable.js
                </a>
              
                
                <a class="source" href="selectable.html">
                  selectable.js
                </a>
              
                
                <a class="source" href="selectmenu.html">
                  selectmenu.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="sortable.html">
                  sortable.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="tabs.html">
                  tabs.js
                </a>
              
                
                <a class="source" href="tooltip.html">
                  tooltip.js
                </a>
              
                
                <a class="source" href="widget.html">
                  widget.js
                </a>
              
                
                <a class="source" href="json2.html">
                  json2.js
                </a>
              
                
                <a class="source" href="masonry.min.html">
                  masonry.min.js
                </a>
              
                
                <a class="source" href="mce-view.html">
                  mce-view.js
                </a>
              
                
                <a class="source" href="media-audiovideo.html">
                  media-audiovideo.js
                </a>
              
                
                <a class="source" href="media-editor.html">
                  media-editor.js
                </a>
              
                
                <a class="source" href="media-grid.html">
                  media-grid.js
                </a>
              
                
                <a class="source" href="media-models.html">
                  media-models.js
                </a>
              
                
                <a class="source" href="media-views.html">
                  media-views.js
                </a>
              
                
                <a class="source" href="audiovideo.manifest.html">
                  audiovideo.manifest.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="collection-add.html">
                  collection-add.js
                </a>
              
                
                <a class="source" href="collection-edit.html">
                  collection-edit.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-image-cropper.html">
                  customize-image-cropper.js
                </a>
              
                
                <a class="source" href="edit-attachment-metadata.html">
                  edit-attachment-metadata.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="featured-image.html">
                  featured-image.js
                </a>
              
                
                <a class="source" href="gallery-add.html">
                  gallery-add.js
                </a>
              
                
                <a class="source" href="gallery-edit.html">
                  gallery-edit.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="media-library.html">
                  media-library.js
                </a>
              
                
                <a class="source" href="region.html">
                  region.js
                </a>
              
                
                <a class="source" href="replace-image.html">
                  replace-image.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="state-machine.html">
                  state-machine.js
                </a>
              
                
                <a class="source" href="state.html">
                  state.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="grid.manifest.html">
                  grid.manifest.js
                </a>
              
                
                <a class="source" href="models.manifest.html">
                  models.manifest.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="post-image.html">
                  post-image.js
                </a>
              
                
                <a class="source" href="post-media.html">
                  post-media.js
                </a>
              
                
                <a class="source" href="query.html">
                  query.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="selection-sync.html">
                  selection-sync.js
                </a>
              
                
                <a class="source" href="views.manifest.html">
                  views.manifest.js
                </a>
              
                
                <a class="source" href="attachment-compat.html">
                  attachment-compat.js
                </a>
              
                
                <a class="source" href="attachment-filters.html">
                  attachment-filters.js
                </a>
              
                
                <a class="source" href="all.html">
                  all.js
                </a>
              
                
                <a class="source" href="date.html">
                  date.js
                </a>
              
                
                <a class="source" href="uploaded.html">
                  uploaded.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="details-two-column.html">
                  details-two-column.js
                </a>
              
                
                <a class="source" href="details.html">
                  details.js
                </a>
              
                
                <a class="source" href="edit-library.html">
                  edit-library.js
                </a>
              
                
                <a class="source" href="edit-selection.html">
                  edit-selection.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="browser.html">
                  browser.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="button-group.html">
                  button-group.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="delete-selected-permanently.html">
                  delete-selected-permanently.js
                </a>
              
                
                <a class="source" href="delete-selected.html">
                  delete-selected.js
                </a>
              
                
                <a class="source" href="select-mode-toggle.html">
                  select-mode-toggle.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="edit-image-details.html">
                  edit-image-details.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="image.html">
                  image.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="url.html">
                  url.js
                </a>
              
                
                <a class="source" href="focus-manager.html">
                  focus-manager.js
                </a>
              
                
                <a class="source" href="frame.html">
                  frame.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="edit-attachments.html">
                  edit-attachments.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="iframe.html">
                  iframe.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="label.html">
                  label.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="media-frame.html">
                  media-frame.js
                </a>
              
                
                <a class="source" href="menu-item.html">
                  menu-item.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="modal.html">
                  modal.js
                </a>
              
                
                <a class="source" href="priority-list.html">
                  priority-list.js
                </a>
              
                
                <a class="source" href="router-item.html">
                  router-item.js
                </a>
              
                
                <a class="source" href="router.html">
                  router.js
                </a>
              
                
                <a class="source" href="search.html">
                  search.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="settings.html">
                  settings.js
                </a>
              
                
                <a class="source" href="attachment-display.html">
                  attachment-display.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="playlist.html">
                  playlist.js
                </a>
              
                
                <a class="source" href="sidebar.html">
                  sidebar.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="site-icon-preview.html">
                  site-icon-preview.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="toolbar.html">
                  toolbar.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="inline.html">
                  inline.js
                </a>
              
                
                <a class="source" href="status-error.html">
                  status-error.js
                </a>
              
                
                <a class="source" href="status.html">
                  status.js
                </a>
              
                
                <a class="source" href="window.html">
                  window.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="view.html">
                  view.js
                </a>
              
                
                <a class="source" href="froogaloop.min.html">
                  froogaloop.min.js
                </a>
              
                
                <a class="source" href="mediaelement-and-player.min.html">
                  mediaelement-and-player.min.js
                </a>
              
                
                <a class="source" href="wp-mediaelement.html">
                  wp-mediaelement.js
                </a>
              
                
                <a class="source" href="wp-playlist.html">
                  wp-playlist.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="plupload.full.min.html">
                  plupload.full.min.js
                </a>
              
                
                <a class="source" href="wp-plupload.html">
                  wp-plupload.js
                </a>
              
                
                <a class="source" href="quicktags.html">
                  quicktags.js
                </a>
              
                
                <a class="source" href="shortcode.html">
                  shortcode.js
                </a>
              
                
                <a class="source" href="swfobject.html">
                  swfobject.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="handlers.min.html">
                  handlers.min.js
                </a>
              
                
                <a class="source" href="swfupload.cookies.html">
                  swfupload.cookies.js
                </a>
              
                
                <a class="source" href="swfupload.queue.html">
                  swfupload.queue.js
                </a>
              
                
                <a class="source" href="swfupload.speed.html">
                  swfupload.speed.js
                </a>
              
                
                <a class="source" href="swfupload.swfobject.html">
                  swfupload.swfobject.js
                </a>
              
                
                <a class="source" href="swfupload.html">
                  swfupload.js
                </a>
              
                
                <a class="source" href="thickbox.html">
                  thickbox.js
                </a>
              
                
                <a class="source" href="wp-langs-en.html">
                  wp-langs-en.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="tiny_mce_popup.html">
                  tiny_mce_popup.js
                </a>
              
                
                <a class="source" href="tinymce.html">
                  tinymce.js
                </a>
              
                
                <a class="source" href="tinymce.min.html">
                  tinymce.min.js
                </a>
              
                
                <a class="source" href="editable_selects.html">
                  editable_selects.js
                </a>
              
                
                <a class="source" href="form_utils.html">
                  form_utils.js
                </a>
              
                
                <a class="source" href="mctabs.html">
                  mctabs.js
                </a>
              
                
                <a class="source" href="validate.html">
                  validate.js
                </a>
              
                
                <a class="source" href="tw-sack.html">
                  tw-sack.js
                </a>
              
                
                <a class="source" href="twemoji.html">
                  twemoji.js
                </a>
              
                
                <a class="source" href="underscore.html">
                  underscore.js
                </a>
              
                
                <a class="source" href="underscore.min.html">
                  underscore.min.js
                </a>
              
                
                <a class="source" href="utils.html">
                  utils.js
                </a>
              
                
                <a class="source" href="wp-a11y.html">
                  wp-a11y.js
                </a>
              
                
                <a class="source" href="wp-ajax-response.html">
                  wp-ajax-response.js
                </a>
              
                
                <a class="source" href="wp-api.html">
                  wp-api.js
                </a>
              
                
                <a class="source" href="wp-auth-check.html">
                  wp-auth-check.js
                </a>
              
                
                <a class="source" href="wp-backbone.html">
                  wp-backbone.js
                </a>
              
                
                <a class="source" href="wp-custom-header.html">
                  wp-custom-header.js
                </a>
              
                
                <a class="source" href="wp-embed-template.html">
                  wp-embed-template.js
                </a>
              
                
                <a class="source" href="wp-embed.html">
                  wp-embed.js
                </a>
              
                
                <a class="source" href="wp-emoji-loader.html">
                  wp-emoji-loader.js
                </a>
              
                
                <a class="source" href="wp-emoji.html">
                  wp-emoji.js
                </a>
              
                
                <a class="source" href="wp-list-revisions.html">
                  wp-list-revisions.js
                </a>
              
                
                <a class="source" href="wp-lists.html">
                  wp-lists.js
                </a>
              
                
                <a class="source" href="wp-pointer.html">
                  wp-pointer.js
                </a>
              
                
                <a class="source" href="wp-util.html">
                  wp-util.js
                </a>
              
                
                <a class="source" href="wpdialog.html">
                  wpdialog.js
                </a>
              
                
                <a class="source" href="wplink.html">
                  wplink.js
                </a>
              
                
                <a class="source" href="zxcvbn-async.html">
                  zxcvbn-async.js
                </a>
              
                
                <a class="source" href="zxcvbn.min.html">
                  zxcvbn.min.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>media-models.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">t,n,r</span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">s</span>(<span class="hljs-params">o,u</span>)</span>{<span class="hljs-keyword">if</span>(!n[o]){<span class="hljs-keyword">if</span>(!t[o]){<span class="hljs-keyword">var</span> a=<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">require</span>==<span class="hljs-string">"function"</span>&amp;&amp;<span class="hljs-built_in">require</span>;<span class="hljs-keyword">if</span>(!u&amp;&amp;a)<span class="hljs-keyword">return</span> a(o,!<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span>(i)<span class="hljs-keyword">return</span> i(o,!<span class="hljs-number">0</span>);<span class="hljs-keyword">var</span> f=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Cannot find module '"</span>+o+<span class="hljs-string">"'"</span>);<span class="hljs-keyword">throw</span> f.code=<span class="hljs-string">"MODULE_NOT_FOUND"</span>,f}<span class="hljs-keyword">var</span> l=n[o]={<span class="hljs-attr">exports</span>:{}};t[o][<span class="hljs-number">0</span>].call(l.exports,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">var</span> n=t[o][<span class="hljs-number">1</span>][e];<span class="hljs-keyword">return</span> s(n?n:e)},l,l.exports,e,t,n,r)}<span class="hljs-keyword">return</span> n[o].exports}<span class="hljs-keyword">var</span> i=<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">require</span>==<span class="hljs-string">"function"</span>&amp;&amp;<span class="hljs-built_in">require</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> o=<span class="hljs-number">0</span>;o&lt;r.length;o++)s(r[o]);<span class="hljs-keyword">return</span> s})({<span class="hljs-number">1</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-keyword">var</span> $ = jQuery,
	Attachment, Attachments, l10n, media;

<span class="hljs-built_in">window</span>.wp = <span class="hljs-built_in">window</span>.wp || {};

<span class="hljs-comment">/**
 * Create and return a media frame.
 *
 * Handles the default media experience.
 *
 * @param  {object} attributes The properties passed to the main media controller.
 * @return {wp.media.view.MediaFrame} A media workflow.
 */</span>
media = wp.media = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attributes </span>) </span>{
	<span class="hljs-keyword">var</span> MediaFrame = media.view.MediaFrame,
		frame;

	<span class="hljs-keyword">if</span> ( ! MediaFrame ) {
		<span class="hljs-keyword">return</span>;
	}

	attributes = _.defaults( attributes || {}, {
		<span class="hljs-attr">frame</span>: <span class="hljs-string">'select'</span>
	});

	<span class="hljs-keyword">if</span> ( <span class="hljs-string">'select'</span> === attributes.frame &amp;&amp; MediaFrame.Select ) {
		frame = <span class="hljs-keyword">new</span> MediaFrame.Select( attributes );
	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'post'</span> === attributes.frame &amp;&amp; MediaFrame.Post ) {
		frame = <span class="hljs-keyword">new</span> MediaFrame.Post( attributes );
	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'manage'</span> === attributes.frame &amp;&amp; MediaFrame.Manage ) {
		frame = <span class="hljs-keyword">new</span> MediaFrame.Manage( attributes );
	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'image'</span> === attributes.frame &amp;&amp; MediaFrame.ImageDetails ) {
		frame = <span class="hljs-keyword">new</span> MediaFrame.ImageDetails( attributes );
	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'audio'</span> === attributes.frame &amp;&amp; MediaFrame.AudioDetails ) {
		frame = <span class="hljs-keyword">new</span> MediaFrame.AudioDetails( attributes );
	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'video'</span> === attributes.frame &amp;&amp; MediaFrame.VideoDetails ) {
		frame = <span class="hljs-keyword">new</span> MediaFrame.VideoDetails( attributes );
	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'edit-attachments'</span> === attributes.frame &amp;&amp; MediaFrame.EditAttachments ) {
		frame = <span class="hljs-keyword">new</span> MediaFrame.EditAttachments( attributes );
	}

	<span class="hljs-keyword">delete</span> attributes.frame;

	media.frame = frame;

	<span class="hljs-keyword">return</span> frame;
};

_.extend( media, { <span class="hljs-attr">model</span>: {}, <span class="hljs-attr">view</span>: {}, <span class="hljs-attr">controller</span>: {}, <span class="hljs-attr">frames</span>: {} });</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Link any localized strings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>l10n = media.model.l10n = <span class="hljs-built_in">window</span>._wpMediaModelsL10n || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Link any settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>media.model.settings = l10n.settings || {};
<span class="hljs-keyword">delete</span> l10n.settings;

Attachment = media.model.Attachment = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./models/attachment.js'</span> );
Attachments = media.model.Attachments = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./models/attachments.js'</span> );

media.model.Query = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./models/query.js'</span> );
media.model.PostImage = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./models/post-image.js'</span> );
media.model.Selection = <span class="hljs-built_in">require</span>( <span class="hljs-string">'./models/selection.js'</span> );

<span class="hljs-comment">/**
 * ========================================================================
 * UTILITIES
 * ========================================================================
 */</span>

<span class="hljs-comment">/**
 * A basic equality comparator for Backbone models.
 *
 * Used to order models within a collection - @see wp.media.model.Attachments.comparator().
 *
 * @param  {mixed}  a  The primary parameter to compare.
 * @param  {mixed}  b  The primary parameter to compare.
 * @param  {string} ac The fallback parameter to compare, a's cid.
 * @param  {string} bc The fallback parameter to compare, b's cid.
 * @return {number}    -1: a should come before b.
 *                      0: a and b are of the same rank.
 *                      1: b should come before a.
 */</span>
media.compare = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> a, b, ac, bc </span>) </span>{
	<span class="hljs-keyword">if</span> ( _.isEqual( a, b ) ) {
		<span class="hljs-keyword">return</span> ac === bc ? <span class="hljs-number">0</span> : (ac &gt; bc ? <span class="hljs-number">-1</span> : <span class="hljs-number">1</span>);
	} <span class="hljs-keyword">else</span> {
		<span class="hljs-keyword">return</span> a &gt; b ? <span class="hljs-number">-1</span> : <span class="hljs-number">1</span>;
	}
};

_.extend( media, {
	<span class="hljs-comment">/**
	 * media.template( id )
	 *
	 * Fetch a JavaScript template for an id, and return a templating function for it.
	 *
	 * See wp.template() in `wp-includes/js/wp-util.js`.
	 *
	 * @borrows wp.template as template
	 */</span>
	template: wp.template,

	<span class="hljs-comment">/**
	 * media.post( [action], [data] )
	 *
	 * Sends a POST request to WordPress.
	 * See wp.ajax.post() in `wp-includes/js/wp-util.js`.
	 *
	 * @borrows wp.ajax.post as post
	 */</span>
	post: wp.ajax.post,

	<span class="hljs-comment">/**
	 * media.ajax( [action], [options] )
	 *
	 * Sends an XHR request to WordPress.
	 * See wp.ajax.send() in `wp-includes/js/wp-util.js`.
	 *
	 * @borrows wp.ajax.send as ajax
	 */</span>
	ajax: wp.ajax.send,

	<span class="hljs-comment">/**
	 * Scales a set of dimensions to fit within bounding dimensions.
	 *
	 * @param {Object} dimensions
	 * @returns {Object}
	 */</span>
	fit: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> dimensions </span>) </span>{
		<span class="hljs-keyword">var</span> width     = dimensions.width,
			height    = dimensions.height,
			maxWidth  = dimensions.maxWidth,
			maxHeight = dimensions.maxHeight,
			constraint;</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Compare ratios between the two values to determine which
max to constrain by. If a max value doesn’t exist, then the
opposite side is the constraint.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! _.isUndefined( maxWidth ) &amp;&amp; ! _.isUndefined( maxHeight ) ) {
			constraint = ( width / height &gt; maxWidth / maxHeight ) ? <span class="hljs-string">'width'</span> : <span class="hljs-string">'height'</span>;
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( _.isUndefined( maxHeight ) ) {
			constraint = <span class="hljs-string">'width'</span>;
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (  _.isUndefined( maxWidth ) &amp;&amp; height &gt; maxHeight ) {
			constraint = <span class="hljs-string">'height'</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>If the value of the constrained side is larger than the max,
then scale the values. Otherwise return the originals; they fit.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'width'</span> === constraint &amp;&amp; width &gt; maxWidth ) {
			<span class="hljs-keyword">return</span> {
				<span class="hljs-attr">width</span> : maxWidth,
				<span class="hljs-attr">height</span>: <span class="hljs-built_in">Math</span>.round( maxWidth * height / width )
			};
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'height'</span> === constraint &amp;&amp; height &gt; maxHeight ) {
			<span class="hljs-keyword">return</span> {
				<span class="hljs-attr">width</span> : <span class="hljs-built_in">Math</span>.round( maxHeight * width / height ),
				<span class="hljs-attr">height</span>: maxHeight
			};
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">return</span> {
				<span class="hljs-attr">width</span> : width,
				<span class="hljs-attr">height</span>: height
			};
		}
	},
	<span class="hljs-comment">/**
	 * Truncates a string by injecting an ellipsis into the middle.
	 * Useful for filenames.
	 *
	 * @param {String} string
	 * @param {Number} [length=30]
	 * @param {String} [replacement=&amp;hellip;]
	 * @returns {String} The string, unless length is greater than string.length.
	 */</span>
	truncate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> string, length, replacement </span>) </span>{
		length = length || <span class="hljs-number">30</span>;
		replacement = replacement || <span class="hljs-string">'&amp;hellip;'</span>;

		<span class="hljs-keyword">if</span> ( string.length &lt;= length ) {
			<span class="hljs-keyword">return</span> string;
		}

		<span class="hljs-keyword">return</span> string.substr( <span class="hljs-number">0</span>, length / <span class="hljs-number">2</span> ) + replacement + string.substr( <span class="hljs-number">-1</span> * length / <span class="hljs-number">2</span> );
	}
});

<span class="hljs-comment">/**
 * ========================================================================
 * MODELS
 * ========================================================================
 */</span>
<span class="hljs-comment">/**
 * wp.media.attachment
 *
 * @static
 * @param {String} id A string used to identify a model.
 * @returns {wp.media.model.Attachment}
 */</span>
media.attachment = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
	<span class="hljs-keyword">return</span> Attachment.get( id );
};

<span class="hljs-comment">/**
 * A collection of all attachments that have been fetched from the server.
 *
 * @static
 * @member {wp.media.model.Attachments}
 */</span>
Attachments.all = <span class="hljs-keyword">new</span> Attachments();

<span class="hljs-comment">/**
 * wp.media.query
 *
 * Shorthand for creating a new Attachments Query.
 *
 * @param {object} [props]
 * @returns {wp.media.model.Attachments}
 */</span>
media.query = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> props </span>) </span>{
	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Attachments( <span class="hljs-literal">null</span>, {
		<span class="hljs-attr">props</span>: _.extend( _.defaults( props || {}, { <span class="hljs-attr">orderby</span>: <span class="hljs-string">'date'</span> } ), { <span class="hljs-attr">query</span>: <span class="hljs-literal">true</span> } )
	});
};</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Clean up. Prevents mobile browsers caching</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$(<span class="hljs-built_in">window</span>).on(<span class="hljs-string">'unload'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
	<span class="hljs-built_in">window</span>.wp = <span class="hljs-literal">null</span>;
});

},{<span class="hljs-string">"./models/attachment.js"</span>:<span class="hljs-number">2</span>,<span class="hljs-string">"./models/attachments.js"</span>:<span class="hljs-number">3</span>,<span class="hljs-string">"./models/post-image.js"</span>:<span class="hljs-number">4</span>,<span class="hljs-string">"./models/query.js"</span>:<span class="hljs-number">5</span>,<span class="hljs-string">"./models/selection.js"</span>:<span class="hljs-number">6</span>}],<span class="hljs-number">2</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.model.Attachment
 *
 * @class
 * @augments Backbone.Model
 */</span>
<span class="hljs-keyword">var</span> $ = Backbone.$,
	Attachment;

Attachment = Backbone.Model.extend({
	<span class="hljs-comment">/**
	 * Triggered when attachment details change
	 * Overrides Backbone.Model.sync
	 *
	 * @param {string} method
	 * @param {wp.media.model.Attachment} model
	 * @param {Object} [options={}]
	 *
	 * @returns {Promise}
	 */</span>
	sync: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> method, model, options </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>If the attachment does not yet have an <code>id</code>, return an instantly
rejected promise. Otherwise, all of our requests will fail.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( _.isUndefined( <span class="hljs-keyword">this</span>.id ) ) {
			<span class="hljs-keyword">return</span> $.Deferred().rejectWith( <span class="hljs-keyword">this</span> ).promise();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Overload the <code>read</code> request so Attachment.fetch() functions correctly.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'read'</span> === method ) {
			options = options || {};
			options.context = <span class="hljs-keyword">this</span>;
			options.data = _.extend( options.data || {}, {
				<span class="hljs-attr">action</span>: <span class="hljs-string">'get-attachment'</span>,
				<span class="hljs-attr">id</span>: <span class="hljs-keyword">this</span>.id
			});
			<span class="hljs-keyword">return</span> wp.media.ajax( options );</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Overload the <code>update</code> request so properties can be saved.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'update'</span> === method ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>If we do not have the necessary nonce, fail immeditately.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'nonces'</span>) || ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'nonces'</span>).update ) {
				<span class="hljs-keyword">return</span> $.Deferred().rejectWith( <span class="hljs-keyword">this</span> ).promise();
			}

			options = options || {};
			options.context = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Set the action and ID.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			options.data = _.extend( options.data || {}, {
				<span class="hljs-attr">action</span>:  <span class="hljs-string">'save-attachment'</span>,
				<span class="hljs-attr">id</span>:      <span class="hljs-keyword">this</span>.id,
				<span class="hljs-attr">nonce</span>:   <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'nonces'</span>).update,
				<span class="hljs-attr">post_id</span>: wp.media.model.settings.post.id
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Record the values of the changed attributes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( model.hasChanged() ) {
				options.data.changes = {};

				_.each( model.changed, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, key </span>) </span>{
					options.data.changes[ key ] = <span class="hljs-keyword">this</span>.get( key );
				}, <span class="hljs-keyword">this</span> );
			}

			<span class="hljs-keyword">return</span> wp.media.ajax( options );</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Overload the <code>delete</code> request so attachments can be removed.
This will permanently delete an attachment.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'delete'</span> === method ) {
			options = options || {};

			<span class="hljs-keyword">if</span> ( ! options.wait ) {
				<span class="hljs-keyword">this</span>.destroyed = <span class="hljs-literal">true</span>;
			}

			options.context = <span class="hljs-keyword">this</span>;
			options.data = _.extend( options.data || {}, {
				<span class="hljs-attr">action</span>:   <span class="hljs-string">'delete-post'</span>,
				<span class="hljs-attr">id</span>:       <span class="hljs-keyword">this</span>.id,
				<span class="hljs-attr">_wpnonce</span>: <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'nonces'</span>)[<span class="hljs-string">'delete'</span>]
			});

			<span class="hljs-keyword">return</span> wp.media.ajax( options ).done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">this</span>.destroyed = <span class="hljs-literal">true</span>;
			}).fail( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">this</span>.destroyed = <span class="hljs-literal">false</span>;
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Otherwise, fall back to <code>Backbone.sync()</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> {
			<span class="hljs-comment">/**
			 * Call `sync` directly on Backbone.Model
			 */</span>
			<span class="hljs-keyword">return</span> Backbone.Model.prototype.sync.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		}
	},
	<span class="hljs-comment">/**
	 * Convert date strings into Date objects.
	 *
	 * @param {Object} resp The raw response object, typically returned by fetch()
	 * @returns {Object} The modified response object, which is the attributes hash
	 *    to be set on the model.
	 */</span>
	parse: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> resp </span>) </span>{
		<span class="hljs-keyword">if</span> ( ! resp ) {
			<span class="hljs-keyword">return</span> resp;
		}

		resp.date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>( resp.date );
		resp.modified = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>( resp.modified );
		<span class="hljs-keyword">return</span> resp;
	},
	<span class="hljs-comment">/**
	 * @param {Object} data The properties to be saved.
	 * @param {Object} options Sync options. e.g. patch, wait, success, error.
	 *
	 * @this Backbone.Model
	 *
	 * @returns {Promise}
	 */</span>
	saveCompat: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> data, options </span>) </span>{
		<span class="hljs-keyword">var</span> model = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>If we do not have the necessary nonce, fail immeditately.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'nonces'</span>) || ! <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'nonces'</span>).update ) {
			<span class="hljs-keyword">return</span> $.Deferred().rejectWith( <span class="hljs-keyword">this</span> ).promise();
		}

		<span class="hljs-keyword">return</span> wp.media.post( <span class="hljs-string">'save-attachment-compat'</span>, _.defaults({
			<span class="hljs-attr">id</span>:      <span class="hljs-keyword">this</span>.id,
			<span class="hljs-attr">nonce</span>:   <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'nonces'</span>).update,
			<span class="hljs-attr">post_id</span>: wp.media.model.settings.post.id
		}, data ) ).done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> resp, status, xhr </span>) </span>{
			model.set( model.parse( resp, xhr ), options );
		});
	}
}, {
	<span class="hljs-comment">/**
	 * Create a new model on the static 'all' attachments collection and return it.
	 *
	 * @static
	 * @param {Object} attrs
	 * @returns {wp.media.model.Attachment}
	 */</span>
	create: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attrs </span>) </span>{
		<span class="hljs-keyword">var</span> Attachments = wp.media.model.Attachments;
		<span class="hljs-keyword">return</span> Attachments.all.push( attrs );
	},
	<span class="hljs-comment">/**
	 * Create a new model on the static 'all' attachments collection and return it.
	 *
	 * If this function has already been called for the id,
	 * it returns the specified attachment.
	 *
	 * @static
	 * @param {string} id A string used to identify a model.
	 * @param {Backbone.Model|undefined} attachment
	 * @returns {wp.media.model.Attachment}
	 */</span>
	get: _.memoize( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id, attachment </span>) </span>{
		<span class="hljs-keyword">var</span> Attachments = wp.media.model.Attachments;
		<span class="hljs-keyword">return</span> Attachments.all.push( attachment || { <span class="hljs-attr">id</span>: id } );
	})
});

<span class="hljs-built_in">module</span>.exports = Attachment;

},{}],<span class="hljs-number">3</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.model.Attachments
 *
 * A collection of attachments.
 *
 * This collection has no persistence with the server without supplying
 * 'options.props.query = true', which will mirror the collection
 * to an Attachments Query collection - @see wp.media.model.Attachments.mirror().
 *
 * @class
 * @augments Backbone.Collection
 *
 * @param {array}  [models]                Models to initialize with the collection.
 * @param {object} [options]               Options hash for the collection.
 * @param {string} [options.props]         Options hash for the initial query properties.
 * @param {string} [options.props.order]   Initial order (ASC or DESC) for the collection.
 * @param {string} [options.props.orderby] Initial attribute key to order the collection by.
 * @param {string} [options.props.query]   Whether the collection is linked to an attachments query.
 * @param {string} [options.observe]
 * @param {string} [options.filters]
 *
 */</span>
<span class="hljs-keyword">var</span> Attachments = Backbone.Collection.extend({
	<span class="hljs-comment">/**
	 * @type {wp.media.model.Attachment}
	 */</span>
	model: wp.media.model.Attachment,
	<span class="hljs-comment">/**
	 * @param {Array} [models=[]] Array of models used to populate the collection.
	 * @param {Object} [options={}]
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> models, options </span>) </span>{
		options = options || {};

		<span class="hljs-keyword">this</span>.props   = <span class="hljs-keyword">new</span> Backbone.Model();
		<span class="hljs-keyword">this</span>.filters = options.filters || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Bind default <code>change</code> events to the <code>props</code> model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.props.on( <span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>._changeFilteredProps, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.props.on( <span class="hljs-string">'change:order'</span>,   <span class="hljs-keyword">this</span>._changeOrder,   <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.props.on( <span class="hljs-string">'change:orderby'</span>, <span class="hljs-keyword">this</span>._changeOrderby, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.props.on( <span class="hljs-string">'change:query'</span>,   <span class="hljs-keyword">this</span>._changeQuery,   <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.props.set( _.defaults( options.props || {} ) );

		<span class="hljs-keyword">if</span> ( options.observe ) {
			<span class="hljs-keyword">this</span>.observe( options.observe );
		}
	},
	<span class="hljs-comment">/**
	 * Sort the collection when the order attribute changes.
	 *
	 * @access private
	 */</span>
	_changeOrder: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.comparator ) {
			<span class="hljs-keyword">this</span>.sort();
		}
	},
	<span class="hljs-comment">/**
	 * Set the default comparator only when the `orderby` property is set.
	 *
	 * @access private
	 *
	 * @param {Backbone.Model} model
	 * @param {string} orderby
	 */</span>
	_changeOrderby: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model, orderby </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>If a different comparator is defined, bail.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.comparator &amp;&amp; <span class="hljs-keyword">this</span>.comparator !== Attachments.comparator ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( orderby &amp;&amp; <span class="hljs-string">'post__in'</span> !== orderby ) {
			<span class="hljs-keyword">this</span>.comparator = Attachments.comparator;
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.comparator;
		}
	},
	<span class="hljs-comment">/**
	 * If the `query` property is set to true, query the server using
	 * the `props` values, and sync the results to this collection.
	 *
	 * @access private
	 *
	 * @param {Backbone.Model} model
	 * @param {Boolean} query
	 */</span>
	_changeQuery: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model, query </span>) </span>{
		<span class="hljs-keyword">if</span> ( query ) {
			<span class="hljs-keyword">this</span>.props.on( <span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>._requery, <span class="hljs-keyword">this</span> );
			<span class="hljs-keyword">this</span>._requery();
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.props.off( <span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>._requery, <span class="hljs-keyword">this</span> );
		}
	},
	<span class="hljs-comment">/**
	 * @access private
	 *
	 * @param {Backbone.Model} model
	 */</span>
	_changeFilteredProps: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>If this is a query, updating the collection will be handled by
<code>this._requery()</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'query'</span>) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">var</span> changed = _.chain( model.changed ).map( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> t, prop </span>) </span>{
			<span class="hljs-keyword">var</span> filter = Attachments.filters[ prop ],
				term = model.get( prop );

			<span class="hljs-keyword">if</span> ( ! filter ) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">if</span> ( term &amp;&amp; ! <span class="hljs-keyword">this</span>.filters[ prop ] ) {
				<span class="hljs-keyword">this</span>.filters[ prop ] = filter;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( ! term &amp;&amp; <span class="hljs-keyword">this</span>.filters[ prop ] === filter ) {
				<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.filters[ prop ];
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Record the change.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		}, <span class="hljs-keyword">this</span> ).any().value();

		<span class="hljs-keyword">if</span> ( ! changed ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>If no <code>Attachments</code> model is provided to source the searches
from, then automatically generate a source from the existing
models.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>._source ) {
			<span class="hljs-keyword">this</span>._source = <span class="hljs-keyword">new</span> Attachments( <span class="hljs-keyword">this</span>.models );
		}

		<span class="hljs-keyword">this</span>.reset( <span class="hljs-keyword">this</span>._source.filter( <span class="hljs-keyword">this</span>.validator, <span class="hljs-keyword">this</span> ) );
	},

	<span class="hljs-attr">validateDestroyed</span>: <span class="hljs-literal">false</span>,
	<span class="hljs-comment">/**
	 * Checks whether an attachment is valid.
	 *
	 * @param {wp.media.model.Attachment} attachment
	 * @returns {Boolean}
	 */</span>
	validator: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.validateDestroyed &amp;&amp; attachment.destroyed ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}
		<span class="hljs-keyword">return</span> _.all( <span class="hljs-keyword">this</span>.filters, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> filter </span>) </span>{
			<span class="hljs-keyword">return</span> !! filter.call( <span class="hljs-keyword">this</span>, attachment );
		}, <span class="hljs-keyword">this</span> );
	},
	<span class="hljs-comment">/**
	 * Add or remove an attachment to the collection depending on its validity.
	 *
	 * @param {wp.media.model.Attachment} attachment
	 * @param {Object} options
	 * @returns {wp.media.model.Attachments} Returns itself to allow chaining
	 */</span>
	validate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment, options </span>) </span>{
		<span class="hljs-keyword">var</span> valid = <span class="hljs-keyword">this</span>.validator( attachment ),
			hasAttachment = !! <span class="hljs-keyword">this</span>.get( attachment.cid );

		<span class="hljs-keyword">if</span> ( ! valid &amp;&amp; hasAttachment ) {
			<span class="hljs-keyword">this</span>.remove( attachment, options );
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( valid &amp;&amp; ! hasAttachment ) {
			<span class="hljs-keyword">this</span>.add( attachment, options );
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	<span class="hljs-comment">/**
	 * Add or remove all attachments from another collection depending on each one's validity.
	 *
	 * @param {wp.media.model.Attachments} attachments
	 * @param {object} [options={}]
	 *
	 * @fires wp.media.model.Attachments#reset
	 *
	 * @returns {wp.media.model.Attachments} Returns itself to allow chaining
	 */</span>
	validateAll: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachments, options </span>) </span>{
		options = options || {};

		_.each( attachments.models, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
			<span class="hljs-keyword">this</span>.validate( attachment, { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> });
		}, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">if</span> ( ! options.silent ) {
			<span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'reset'</span>, <span class="hljs-keyword">this</span>, options );
		}
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * Start observing another attachments collection change events
	 * and replicate them on this collection.
	 *
	 * @param {wp.media.model.Attachments} The attachments collection to observe.
	 * @returns {wp.media.model.Attachments} Returns itself to allow chaining.
	 */</span>
	observe: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachments </span>) </span>{
		<span class="hljs-keyword">this</span>.observers = <span class="hljs-keyword">this</span>.observers || [];
		<span class="hljs-keyword">this</span>.observers.push( attachments );

		attachments.on( <span class="hljs-string">'add change remove'</span>, <span class="hljs-keyword">this</span>._validateHandler, <span class="hljs-keyword">this</span> );
		attachments.on( <span class="hljs-string">'reset'</span>, <span class="hljs-keyword">this</span>._validateAllHandler, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.validateAll( attachments );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * Stop replicating collection change events from another attachments collection.
	 *
	 * @param {wp.media.model.Attachments} The attachments collection to stop observing.
	 * @returns {wp.media.model.Attachments} Returns itself to allow chaining
	 */</span>
	unobserve: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachments </span>) </span>{
		<span class="hljs-keyword">if</span> ( attachments ) {
			attachments.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
			<span class="hljs-keyword">this</span>.observers = _.without( <span class="hljs-keyword">this</span>.observers, attachments );

		} <span class="hljs-keyword">else</span> {
			_.each( <span class="hljs-keyword">this</span>.observers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachments </span>) </span>{
				attachments.off( <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span> );
			}, <span class="hljs-keyword">this</span> );
			<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.observers;
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * @access private
	 *
	 * @param {wp.media.model.Attachments} attachment
	 * @param {wp.media.model.Attachments} attachments
	 * @param {Object} options
	 *
	 * @returns {wp.media.model.Attachments} Returns itself to allow chaining
	 */</span>
	_validateHandler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment, attachments, options </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>If we’re not mirroring this <code>attachments</code> collection,
only retain the <code>silent</code> option.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		options = attachments === <span class="hljs-keyword">this</span>.mirroring ? options : {
			<span class="hljs-attr">silent</span>: options &amp;&amp; options.silent
		};

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.validate( attachment, options );
	},
	<span class="hljs-comment">/**
	 * @access private
	 *
	 * @param {wp.media.model.Attachments} attachments
	 * @param {Object} options
	 * @returns {wp.media.model.Attachments} Returns itself to allow chaining
	 */</span>
	_validateAllHandler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachments, options </span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.validateAll( attachments, options );
	},
	<span class="hljs-comment">/**
	 * Start mirroring another attachments collection, clearing out any models already
	 * in the collection.
	 *
	 * @param {wp.media.model.Attachments} The attachments collection to mirror.
	 * @returns {wp.media.model.Attachments} Returns itself to allow chaining
	 */</span>
	mirror: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachments </span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.mirroring &amp;&amp; <span class="hljs-keyword">this</span>.mirroring === attachments ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}

		<span class="hljs-keyword">this</span>.unmirror();
		<span class="hljs-keyword">this</span>.mirroring = attachments;</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Clear the collection silently. A <code>reset</code> event will be fired
when <code>observe()</code> calls <code>validateAll()</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.reset( [], { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> } );
		<span class="hljs-keyword">this</span>.observe( attachments );

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	<span class="hljs-comment">/**
	 * Stop mirroring another attachments collection.
	 */</span>
	unmirror: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.mirroring ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.unobserve( <span class="hljs-keyword">this</span>.mirroring );
		<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.mirroring;
	},
	<span class="hljs-comment">/**
	 * Retrieve more attachments from the server for the collection.
	 *
	 * Only works if the collection is mirroring a Query Attachments collection,
	 * and forwards to its `more` method. This collection class doesn't have
	 * server persistence by itself.
	 *
	 * @param {object} options
	 * @returns {Promise}
	 */</span>
	more: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">var</span> deferred = jQuery.Deferred(),
			mirroring = <span class="hljs-keyword">this</span>.mirroring,
			attachments = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">if</span> ( ! mirroring || ! mirroring.more ) {
			<span class="hljs-keyword">return</span> deferred.resolveWith( <span class="hljs-keyword">this</span> ).promise();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>If we’re mirroring another collection, forward <code>more</code> to
the mirrored collection. Account for a race condition by
checking if we’re still mirroring that collection when
the request resolves.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		mirroring.more( options ).done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span> === attachments.mirroring ) {
				deferred.resolveWith( <span class="hljs-keyword">this</span> );
			}
		});

		<span class="hljs-keyword">return</span> deferred.promise();
	},
	<span class="hljs-comment">/**
	 * Whether there are more attachments that haven't been sync'd from the server
	 * that match the collection's query.
	 *
	 * Only works if the collection is mirroring a Query Attachments collection,
	 * and forwards to its `hasMore` method. This collection class doesn't have
	 * server persistence by itself.
	 *
	 * @returns {boolean}
	 */</span>
	hasMore: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.mirroring ? <span class="hljs-keyword">this</span>.mirroring.hasMore() : <span class="hljs-literal">false</span>;
	},
	<span class="hljs-comment">/**
	 * A custom AJAX-response parser.
	 *
	 * See trac ticket #24753
	 *
	 * @param {Object|Array} resp The raw response Object/Array.
	 * @param {Object} xhr
	 * @returns {Array} The array of model attributes to be added to the collection
	 */</span>
	parse: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> resp, xhr </span>) </span>{
		<span class="hljs-keyword">if</span> ( ! _.isArray( resp ) ) {
			resp = [resp];
		}

		<span class="hljs-keyword">return</span> _.map( resp, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attrs </span>) </span>{
			<span class="hljs-keyword">var</span> id, attachment, newAttributes;

			<span class="hljs-keyword">if</span> ( attrs <span class="hljs-keyword">instanceof</span> Backbone.Model ) {
				id = attrs.get( <span class="hljs-string">'id'</span> );
				attrs = attrs.attributes;
			} <span class="hljs-keyword">else</span> {
				id = attrs.id;
			}

			attachment = wp.media.model.Attachment.get( id );
			newAttributes = attachment.parse( attrs, xhr );

			<span class="hljs-keyword">if</span> ( ! _.isEqual( attachment.attributes, newAttributes ) ) {
				attachment.set( newAttributes );
			}

			<span class="hljs-keyword">return</span> attachment;
		});
	},
	<span class="hljs-comment">/**
	 * If the collection is a query, create and mirror an Attachments Query collection.
	 *
	 * @access private
	 */</span>
	_requery: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> refresh </span>) </span>{
		<span class="hljs-keyword">var</span> props;
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'query'</span>) ) {
			props = <span class="hljs-keyword">this</span>.props.toJSON();
			props.cache = ( <span class="hljs-literal">true</span> !== refresh );
			<span class="hljs-keyword">this</span>.mirror( wp.media.model.Query.get( props ) );
		}
	},
	<span class="hljs-comment">/**
	 * If this collection is sorted by `menuOrder`, recalculates and saves
	 * the menu order to the database.
	 *
	 * @returns {undefined|Promise}
	 */</span>
	saveMenuOrder: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'menuOrder'</span> !== <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'orderby'</span>) ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Removes any uploading attachments, updates each attachment’s
menu order, and returns an object with an { id: menuOrder }
mapping to pass to the request.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> attachments = <span class="hljs-keyword">this</span>.chain().filter( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
			<span class="hljs-keyword">return</span> ! _.isUndefined( attachment.id );
		}).map( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment, index </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Indices start at 1.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			index = index + <span class="hljs-number">1</span>;
			attachment.set( <span class="hljs-string">'menuOrder'</span>, index );
			<span class="hljs-keyword">return</span> [ attachment.id, index ];
		}).object().value();

		<span class="hljs-keyword">if</span> ( _.isEmpty( attachments ) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">return</span> wp.media.post( <span class="hljs-string">'save-attachment-order'</span>, {
			<span class="hljs-attr">nonce</span>:       wp.media.model.settings.post.nonce,
			<span class="hljs-attr">post_id</span>:     wp.media.model.settings.post.id,
			<span class="hljs-attr">attachments</span>: attachments
		});
	}
}, {
	<span class="hljs-comment">/**
	 * A function to compare two attachment models in an attachments collection.
	 *
	 * Used as the default comparator for instances of wp.media.model.Attachments
	 * and its subclasses. @see wp.media.model.Attachments._changeOrderby().
	 *
	 * @static
	 *
	 * @param {Backbone.Model} a
	 * @param {Backbone.Model} b
	 * @param {Object} options
	 * @returns {Number} -1 if the first model should come before the second,
	 *    0 if they are of the same rank and
	 *    1 if the first model should come after.
	 */</span>
	comparator: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> a, b, options </span>) </span>{
		<span class="hljs-keyword">var</span> key   = <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'orderby'</span>),
			order = <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'order'</span>) || <span class="hljs-string">'DESC'</span>,
			ac    = a.cid,
			bc    = b.cid;

		a = a.get( key );
		b = b.get( key );

		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'date'</span> === key || <span class="hljs-string">'modified'</span> === key ) {
			a = a || <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
			b = b || <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>If <code>options.ties</code> is set, don’t enforce the <code>cid</code> tiebreaker.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( options &amp;&amp; options.ties ) {
			ac = bc = <span class="hljs-literal">null</span>;
		}

		<span class="hljs-keyword">return</span> ( <span class="hljs-string">'DESC'</span> === order ) ? wp.media.compare( a, b, ac, bc ) : wp.media.compare( b, a, bc, ac );
	},
	<span class="hljs-comment">/**
	 * @namespace
	 */</span>
	filters: {
		<span class="hljs-comment">/**
		 * @static
		 * Note that this client-side searching is *not* equivalent
		 * to our server-side searching.
		 *
		 * @param {wp.media.model.Attachment} attachment
		 *
		 * @this wp.media.model.Attachments
		 *
		 * @returns {Boolean}
		 */</span>
		search: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
			<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'search'</span>) ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}

			<span class="hljs-keyword">return</span> _.any([<span class="hljs-string">'title'</span>,<span class="hljs-string">'filename'</span>,<span class="hljs-string">'description'</span>,<span class="hljs-string">'caption'</span>,<span class="hljs-string">'name'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> key </span>) </span>{
				<span class="hljs-keyword">var</span> value = attachment.get( key );
				<span class="hljs-keyword">return</span> value &amp;&amp; <span class="hljs-number">-1</span> !== value.search( <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'search'</span>) );
			}, <span class="hljs-keyword">this</span> );
		},
		<span class="hljs-comment">/**
		 * @static
		 * @param {wp.media.model.Attachment} attachment
		 *
		 * @this wp.media.model.Attachments
		 *
		 * @returns {Boolean}
		 */</span>
		type: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
			<span class="hljs-keyword">var</span> type = <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'type'</span>), atts = attachment.toJSON(), mime, found;

			<span class="hljs-keyword">if</span> ( ! type || ( _.isArray( type ) &amp;&amp; ! type.length ) ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}

			mime = atts.mime || ( atts.file &amp;&amp; atts.file.type ) || <span class="hljs-string">''</span>;

			<span class="hljs-keyword">if</span> ( _.isArray( type ) ) {
				found = _.find( type, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) </span>{
					<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span> !== mime.indexOf( t );
				} );
			} <span class="hljs-keyword">else</span> {
				found = <span class="hljs-number">-1</span> !== mime.indexOf( type );
			}

			<span class="hljs-keyword">return</span> found;
		},
		<span class="hljs-comment">/**
		 * @static
		 * @param {wp.media.model.Attachment} attachment
		 *
		 * @this wp.media.model.Attachments
		 *
		 * @returns {Boolean}
		 */</span>
		uploadedTo: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
			<span class="hljs-keyword">var</span> uploadedTo = <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'uploadedTo'</span>);
			<span class="hljs-keyword">if</span> ( _.isUndefined( uploadedTo ) ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}

			<span class="hljs-keyword">return</span> uploadedTo === attachment.get(<span class="hljs-string">'uploadedTo'</span>);
		},
		<span class="hljs-comment">/**
		 * @static
		 * @param {wp.media.model.Attachment} attachment
		 *
		 * @this wp.media.model.Attachments
		 *
		 * @returns {Boolean}
		 */</span>
		status: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
			<span class="hljs-keyword">var</span> status = <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'status'</span>);
			<span class="hljs-keyword">if</span> ( _.isUndefined( status ) ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}

			<span class="hljs-keyword">return</span> status === attachment.get(<span class="hljs-string">'status'</span>);
		}
	}
});

<span class="hljs-built_in">module</span>.exports = Attachments;

},{}],<span class="hljs-number">4</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.model.PostImage
 *
 * An instance of an image that's been embedded into a post.
 *
 * Used in the embedded image attachment display settings modal - @see wp.media.view.MediaFrame.ImageDetails.
 *
 * @class
 * @augments Backbone.Model
 *
 * @param {int} [attributes]               Initial model attributes.
 * @param {int} [attributes.attachment_id] ID of the attachment.
 **/</span>
<span class="hljs-keyword">var</span> PostImage = Backbone.Model.extend({

	<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attributes </span>) </span>{
		<span class="hljs-keyword">var</span> Attachment = wp.media.model.Attachment;
		<span class="hljs-keyword">this</span>.attachment = <span class="hljs-literal">false</span>;

		<span class="hljs-keyword">if</span> ( attributes.attachment_id ) {
			<span class="hljs-keyword">this</span>.attachment = Attachment.get( attributes.attachment_id );
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.attachment.get( <span class="hljs-string">'url'</span> ) ) {
				<span class="hljs-keyword">this</span>.dfd = jQuery.Deferred();
				<span class="hljs-keyword">this</span>.dfd.resolve();
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.dfd = <span class="hljs-keyword">this</span>.attachment.fetch();
			}
			<span class="hljs-keyword">this</span>.bindAttachmentListeners();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>keep url in sync with changes to the type of link</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'change:link'</span>, <span class="hljs-keyword">this</span>.updateLinkUrl, <span class="hljs-keyword">this</span> );
		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'change:size'</span>, <span class="hljs-keyword">this</span>.updateSize, <span class="hljs-keyword">this</span> );

		<span class="hljs-keyword">this</span>.setLinkTypeFromUrl();
		<span class="hljs-keyword">this</span>.setAspectRatio();

		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'originalUrl'</span>, attributes.url );
	},

	<span class="hljs-attr">bindAttachmentListeners</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.attachment, <span class="hljs-string">'sync'</span>, <span class="hljs-keyword">this</span>.setLinkTypeFromUrl );
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.attachment, <span class="hljs-string">'sync'</span>, <span class="hljs-keyword">this</span>.setAspectRatio );
		<span class="hljs-keyword">this</span>.listenTo( <span class="hljs-keyword">this</span>.attachment, <span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>.updateSize );
	},

	<span class="hljs-attr">changeAttachment</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment, props </span>) </span>{
		<span class="hljs-keyword">this</span>.stopListening( <span class="hljs-keyword">this</span>.attachment );
		<span class="hljs-keyword">this</span>.attachment = attachment;
		<span class="hljs-keyword">this</span>.bindAttachmentListeners();

		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'attachment_id'</span>, <span class="hljs-keyword">this</span>.attachment.get( <span class="hljs-string">'id'</span> ) );
		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'caption'</span>, <span class="hljs-keyword">this</span>.attachment.get( <span class="hljs-string">'caption'</span> ) );
		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'alt'</span>, <span class="hljs-keyword">this</span>.attachment.get( <span class="hljs-string">'alt'</span> ) );
		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'size'</span>, props.get( <span class="hljs-string">'size'</span> ) );
		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'align'</span>, props.get( <span class="hljs-string">'align'</span> ) );
		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'link'</span>, props.get( <span class="hljs-string">'link'</span> ) );
		<span class="hljs-keyword">this</span>.updateLinkUrl();
		<span class="hljs-keyword">this</span>.updateSize();
	},

	<span class="hljs-attr">setLinkTypeFromUrl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> linkUrl = <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'linkUrl'</span> ),
			type;

		<span class="hljs-keyword">if</span> ( ! linkUrl ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'link'</span>, <span class="hljs-string">'none'</span> );
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>default to custom if there is a linkUrl</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		type = <span class="hljs-string">'custom'</span>;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.attachment ) {
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.attachment.get( <span class="hljs-string">'url'</span> ) === linkUrl ) {
				type = <span class="hljs-string">'file'</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.attachment.get( <span class="hljs-string">'link'</span> ) === linkUrl ) {
				type = <span class="hljs-string">'post'</span>;
			}
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'url'</span> ) === linkUrl ) {
				type = <span class="hljs-string">'file'</span>;
			}
		}

		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'link'</span>, type );
	},

	<span class="hljs-attr">updateLinkUrl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> link = <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'link'</span> ),
			url;

		<span class="hljs-keyword">switch</span>( link ) {
			<span class="hljs-keyword">case</span> <span class="hljs-string">'file'</span>:
				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.attachment ) {
					url = <span class="hljs-keyword">this</span>.attachment.get( <span class="hljs-string">'url'</span> );
				} <span class="hljs-keyword">else</span> {
					url = <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'url'</span> );
				}
				<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'linkUrl'</span>, url );
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> <span class="hljs-string">'post'</span>:
				<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'linkUrl'</span>, <span class="hljs-keyword">this</span>.attachment.get( <span class="hljs-string">'link'</span> ) );
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> <span class="hljs-string">'none'</span>:
				<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'linkUrl'</span>, <span class="hljs-string">''</span> );
				<span class="hljs-keyword">break</span>;
		}
	},

	<span class="hljs-attr">updateSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> size;

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.attachment ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'size'</span> ) === <span class="hljs-string">'custom'</span> ) {
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'width'</span>, <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'customWidth'</span> ) );
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'height'</span>, <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'customHeight'</span> ) );
			<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'url'</span>, <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'originalUrl'</span> ) );
			<span class="hljs-keyword">return</span>;
		}

		size = <span class="hljs-keyword">this</span>.attachment.get( <span class="hljs-string">'sizes'</span> )[ <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'size'</span> ) ];

		<span class="hljs-keyword">if</span> ( ! size ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'url'</span>, size.url );
		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'width'</span>, size.width );
		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'height'</span>, size.height );
	},

	<span class="hljs-attr">setAspectRatio</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> full;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.attachment &amp;&amp; <span class="hljs-keyword">this</span>.attachment.get( <span class="hljs-string">'sizes'</span> ) ) {
			full = <span class="hljs-keyword">this</span>.attachment.get( <span class="hljs-string">'sizes'</span> ).full;

			<span class="hljs-keyword">if</span> ( full ) {
				<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'aspectRatio'</span>, full.width / full.height );
				<span class="hljs-keyword">return</span>;
			}
		}

		<span class="hljs-keyword">this</span>.set( <span class="hljs-string">'aspectRatio'</span>, <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'customWidth'</span> ) / <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'customHeight'</span> ) );
	}
});

<span class="hljs-built_in">module</span>.exports = PostImage;

},{}],<span class="hljs-number">5</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.model.Query
 *
 * A collection of attachments that match the supplied query arguments.
 *
 * Note: Do NOT change this.args after the query has been initialized.
 *       Things will break.
 *
 * @class
 * @augments wp.media.model.Attachments
 * @augments Backbone.Collection
 *
 * @param {array}  [models]                      Models to initialize with the collection.
 * @param {object} [options]                     Options hash.
 * @param {object} [options.args]                Attachments query arguments.
 * @param {object} [options.args.posts_per_page]
 */</span>
<span class="hljs-keyword">var</span> Attachments = wp.media.model.Attachments,
	Query;

Query = Attachments.extend({
	<span class="hljs-comment">/**
	 * @global wp.Uploader
	 *
	 * @param {array}  [models=[]]  Array of initial models to populate the collection.
	 * @param {object} [options={}]
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> models, options </span>) </span>{
		<span class="hljs-keyword">var</span> allowed;

		options = options || {};
		Attachments.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );

		<span class="hljs-keyword">this</span>.args     = options.args;
		<span class="hljs-keyword">this</span>._hasMore = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">this</span>.created  = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();

		<span class="hljs-keyword">this</span>.filters.order = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
			<span class="hljs-keyword">var</span> orderby = <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'orderby'</span>),
				order = <span class="hljs-keyword">this</span>.props.get(<span class="hljs-string">'order'</span>);

			<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.comparator ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>We want any items that can be placed before the last
item in the set. If we add any items after the last
item, then we can’t guarantee the set is complete.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.length ) {
				<span class="hljs-keyword">return</span> <span class="hljs-number">1</span> !== <span class="hljs-keyword">this</span>.comparator( attachment, <span class="hljs-keyword">this</span>.last(), { <span class="hljs-attr">ties</span>: <span class="hljs-literal">true</span> });</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Handle the case where there are no items yet and
we’re sorting for recent items. In that case, we want
changes that occurred after we created the query.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'DESC'</span> === order &amp;&amp; ( <span class="hljs-string">'date'</span> === orderby || <span class="hljs-string">'modified'</span> === orderby ) ) {
				<span class="hljs-keyword">return</span> attachment.get( orderby ) &gt;= <span class="hljs-keyword">this</span>.created;</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>If we’re sorting by menu order and we have no items,
accept any items that have the default menu order (0).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'ASC'</span> === order &amp;&amp; <span class="hljs-string">'menuOrder'</span> === orderby ) {
				<span class="hljs-keyword">return</span> attachment.get( orderby ) === <span class="hljs-number">0</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Otherwise, we don’t want any items yet.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Observe the central <code>wp.Uploader.queue</code> collection to watch for
new matches for the query.</p>
<p>Only observe when a limited number of query args are set. There
are no filters for other properties, so observing will result in
false positives in those queries.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		allowed = [ <span class="hljs-string">'s'</span>, <span class="hljs-string">'order'</span>, <span class="hljs-string">'orderby'</span>, <span class="hljs-string">'posts_per_page'</span>, <span class="hljs-string">'post_mime_type'</span>, <span class="hljs-string">'post_parent'</span> ];
		<span class="hljs-keyword">if</span> ( wp.Uploader &amp;&amp; _( <span class="hljs-keyword">this</span>.args ).chain().keys().difference( allowed ).isEmpty().value() ) {
			<span class="hljs-keyword">this</span>.observe( wp.Uploader.queue );
		}
	},
	<span class="hljs-comment">/**
	 * Whether there are more attachments that haven't been sync'd from the server
	 * that match the collection's query.
	 *
	 * @returns {boolean}
	 */</span>
	hasMore: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._hasMore;
	},
	<span class="hljs-comment">/**
	 * Fetch more attachments from the server for the collection.
	 *
	 * @param   {object}  [options={}]
	 * @returns {Promise}
	 */</span>
	more: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		<span class="hljs-keyword">var</span> query = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>If there is already a request pending, return early with the Deferred object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._more &amp;&amp; <span class="hljs-string">'pending'</span> === <span class="hljs-keyword">this</span>._more.state() ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._more;
		}

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.hasMore() ) {
			<span class="hljs-keyword">return</span> jQuery.Deferred().resolveWith( <span class="hljs-keyword">this</span> ).promise();
		}

		options = options || {};
		options.remove = <span class="hljs-literal">false</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._more = <span class="hljs-keyword">this</span>.fetch( options ).done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> resp </span>) </span>{
			<span class="hljs-keyword">if</span> ( _.isEmpty( resp ) || <span class="hljs-number">-1</span> === <span class="hljs-keyword">this</span>.args.posts_per_page || resp.length &lt; <span class="hljs-keyword">this</span>.args.posts_per_page ) {
				query._hasMore = <span class="hljs-literal">false</span>;
			}
		});
	},
	<span class="hljs-comment">/**
	 * Overrides Backbone.Collection.sync
	 * Overrides wp.media.model.Attachments.sync
	 *
	 * @param {String} method
	 * @param {Backbone.Model} model
	 * @param {Object} [options={}]
	 * @returns {Promise}
	 */</span>
	sync: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> method, model, options </span>) </span>{
		<span class="hljs-keyword">var</span> args, fallback;</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Overload the read method so Attachment.fetch() functions correctly.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'read'</span> === method ) {
			options = options || {};
			options.context = <span class="hljs-keyword">this</span>;
			options.data = _.extend( options.data || {}, {
				<span class="hljs-attr">action</span>:  <span class="hljs-string">'query-attachments'</span>,
				<span class="hljs-attr">post_id</span>: wp.media.model.settings.post.id
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Clone the args so manipulation is non-destructive.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			args = _.clone( <span class="hljs-keyword">this</span>.args );</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Determine which page to query.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-number">-1</span> !== args.posts_per_page ) {
				args.paged = <span class="hljs-built_in">Math</span>.round( <span class="hljs-keyword">this</span>.length / args.posts_per_page ) + <span class="hljs-number">1</span>;
			}

			options.data.query = args;
			<span class="hljs-keyword">return</span> wp.media.ajax( options );</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Otherwise, fall back to Backbone.sync()</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> {
			<span class="hljs-comment">/**
			 * Call wp.media.model.Attachments.sync or Backbone.sync
			 */</span>
			fallback = Attachments.prototype.sync ? Attachments.prototype : Backbone;
			<span class="hljs-keyword">return</span> fallback.sync.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		}
	}
}, {
	<span class="hljs-comment">/**
	 * @readonly
	 */</span>
	defaultProps: {
		<span class="hljs-attr">orderby</span>: <span class="hljs-string">'date'</span>,
		<span class="hljs-attr">order</span>:   <span class="hljs-string">'DESC'</span>
	},
	<span class="hljs-comment">/**
	 * @readonly
	 */</span>
	defaultArgs: {
		<span class="hljs-attr">posts_per_page</span>: <span class="hljs-number">40</span>
	},
	<span class="hljs-comment">/**
	 * @readonly
	 */</span>
	orderby: {
		<span class="hljs-attr">allowed</span>:  [ <span class="hljs-string">'name'</span>, <span class="hljs-string">'author'</span>, <span class="hljs-string">'date'</span>, <span class="hljs-string">'title'</span>, <span class="hljs-string">'modified'</span>, <span class="hljs-string">'uploadedTo'</span>, <span class="hljs-string">'id'</span>, <span class="hljs-string">'post__in'</span>, <span class="hljs-string">'menuOrder'</span> ],
		<span class="hljs-comment">/**
		 * A map of JavaScript orderby values to their WP_Query equivalents.
		 * @type {Object}
		 */</span>
		valuemap: {
			<span class="hljs-string">'id'</span>:         <span class="hljs-string">'ID'</span>,
			<span class="hljs-string">'uploadedTo'</span>: <span class="hljs-string">'parent'</span>,
			<span class="hljs-string">'menuOrder'</span>:  <span class="hljs-string">'menu_order ID'</span>
		}
	},
	<span class="hljs-comment">/**
	 * A map of JavaScript query properties to their WP_Query equivalents.
	 *
	 * @readonly
	 */</span>
	propmap: {
		<span class="hljs-string">'search'</span>:    <span class="hljs-string">'s'</span>,
		<span class="hljs-string">'type'</span>:      <span class="hljs-string">'post_mime_type'</span>,
		<span class="hljs-string">'perPage'</span>:   <span class="hljs-string">'posts_per_page'</span>,
		<span class="hljs-string">'menuOrder'</span>: <span class="hljs-string">'menu_order'</span>,
		<span class="hljs-string">'uploadedTo'</span>: <span class="hljs-string">'post_parent'</span>,
		<span class="hljs-string">'status'</span>:     <span class="hljs-string">'post_status'</span>,
		<span class="hljs-string">'include'</span>:    <span class="hljs-string">'post__in'</span>,
		<span class="hljs-string">'exclude'</span>:    <span class="hljs-string">'post__not_in'</span>
	},
	<span class="hljs-comment">/**
	 * Creates and returns an Attachments Query collection given the properties.
	 *
	 * Caches query objects and reuses where possible.
	 *
	 * @static
	 * @method
	 *
	 * @param {object} [props]
	 * @param {Object} [props.cache=true]   Whether to use the query cache or not.
	 * @param {Object} [props.order]
	 * @param {Object} [props.orderby]
	 * @param {Object} [props.include]
	 * @param {Object} [props.exclude]
	 * @param {Object} [props.s]
	 * @param {Object} [props.post_mime_type]
	 * @param {Object} [props.posts_per_page]
	 * @param {Object} [props.menu_order]
	 * @param {Object} [props.post_parent]
	 * @param {Object} [props.post_status]
	 * @param {Object} [options]
	 *
	 * @returns {wp.media.model.Query} A new Attachments Query collection.
	 */</span>
	get: (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
		<span class="hljs-comment">/**
		 * @static
		 * @type Array
		 */</span>
		<span class="hljs-keyword">var</span> queries = [];

		<span class="hljs-comment">/**
		 * @returns {Query}
		 */</span>
		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> props, options </span>) </span>{
			<span class="hljs-keyword">var</span> args     = {},
				orderby  = Query.orderby,
				defaults = Query.defaultProps,
				query,
				cache    = !! props.cache || _.isUndefined( props.cache );</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Remove the <code>query</code> property. This isn’t linked to a query,
this <em>is</em> the query.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">delete</span> props.query;
			<span class="hljs-keyword">delete</span> props.cache;</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Fill default args.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			_.defaults( props, defaults );</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Normalize the order.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			props.order = props.order.toUpperCase();
			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'DESC'</span> !== props.order &amp;&amp; <span class="hljs-string">'ASC'</span> !== props.order ) {
				props.order = defaults.order.toUpperCase();
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Ensure we have a valid orderby value.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! _.contains( orderby.allowed, props.orderby ) ) {
				props.orderby = defaults.orderby;
			}

			_.each( [ <span class="hljs-string">'include'</span>, <span class="hljs-string">'exclude'</span> ], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> prop </span>) </span>{
				<span class="hljs-keyword">if</span> ( props[ prop ] &amp;&amp; ! _.isArray( props[ prop ] ) ) {
					props[ prop ] = [ props[ prop ] ];
				}
			} );</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Generate the query <code>args</code> object.
Correct any differing property names.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			_.each( props, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, prop </span>) </span>{
				<span class="hljs-keyword">if</span> ( _.isNull( value ) ) {
					<span class="hljs-keyword">return</span>;
				}

				args[ Query.propmap[ prop ] || prop ] = value;
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Fill any other default query args.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			_.defaults( args, Query.defaultArgs );</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p><code>props.orderby</code> does not always map directly to <code>args.orderby</code>.
Substitute exceptions specified in orderby.keymap.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			args.orderby = orderby.valuemap[ props.orderby ] || props.orderby;</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Search the query cache for a matching query.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( cache ) {
				query = _.find( queries, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> query </span>) </span>{
					<span class="hljs-keyword">return</span> _.isEqual( query.args, args );
				});
			} <span class="hljs-keyword">else</span> {
				queries = [];
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Otherwise, create a new query and add it to the cache.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! query ) {
				query = <span class="hljs-keyword">new</span> Query( [], _.extend( options || {}, {
					<span class="hljs-attr">props</span>: props,
					<span class="hljs-attr">args</span>:  args
				} ) );
				queries.push( query );
			}

			<span class="hljs-keyword">return</span> query;
		};
	}())
});

<span class="hljs-built_in">module</span>.exports = Query;

},{}],<span class="hljs-number">6</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-comment">/**
 * wp.media.model.Selection
 *
 * A selection of attachments.
 *
 * @class
 * @augments wp.media.model.Attachments
 * @augments Backbone.Collection
 */</span>
<span class="hljs-keyword">var</span> Attachments = wp.media.model.Attachments,
	Selection;

Selection = Attachments.extend({
	<span class="hljs-comment">/**
	 * Refresh the `single` model whenever the selection changes.
	 * Binds `single` instead of using the context argument to ensure
	 * it receives no parameters.
	 *
	 * @param {Array} [models=[]] Array of models used to populate the collection.
	 * @param {Object} [options={}]
	 */</span>
	initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> models, options </span>) </span>{
		<span class="hljs-comment">/**
		 * call 'initialize' directly on the parent class
		 */</span>
		Attachments.prototype.initialize.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">this</span>.multiple = options &amp;&amp; options.multiple;

		<span class="hljs-keyword">this</span>.on( <span class="hljs-string">'add remove reset'</span>, _.bind( <span class="hljs-keyword">this</span>.single, <span class="hljs-keyword">this</span>, <span class="hljs-literal">false</span> ) );
	},

	<span class="hljs-comment">/**
	 * If the workflow does not support multi-select, clear out the selection
	 * before adding a new attachment to it.
	 *
	 * @param {Array} models
	 * @param {Object} options
	 * @returns {wp.media.model.Attachment[]}
	 */</span>
	add: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> models, options </span>) </span>{
		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.multiple ) {
			<span class="hljs-keyword">this</span>.remove( <span class="hljs-keyword">this</span>.models );
		}
		<span class="hljs-comment">/**
		 * call 'add' directly on the parent class
		 */</span>
		<span class="hljs-keyword">return</span> Attachments.prototype.add.call( <span class="hljs-keyword">this</span>, models, options );
	},

	<span class="hljs-comment">/**
	 * Fired when toggling (clicking on) an attachment in the modal.
	 *
	 * @param {undefined|boolean|wp.media.model.Attachment} model
	 *
	 * @fires wp.media.model.Selection#selection:single
	 * @fires wp.media.model.Selection#selection:unsingle
	 *
	 * @returns {Backbone.Model}
	 */</span>
	single: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model </span>) </span>{
		<span class="hljs-keyword">var</span> previous = <span class="hljs-keyword">this</span>._single;</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>If a <code>model</code> is provided, use it as the single model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( model ) {
			<span class="hljs-keyword">this</span>._single = model;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>If the single model isn’t in the selection, remove it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._single &amp;&amp; ! <span class="hljs-keyword">this</span>.get( <span class="hljs-keyword">this</span>._single.cid ) ) {
			<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._single;
		}

		<span class="hljs-keyword">this</span>._single = <span class="hljs-keyword">this</span>._single || <span class="hljs-keyword">this</span>.last();</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>If single has changed, fire an event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._single !== previous ) {
			<span class="hljs-keyword">if</span> ( previous ) {
				previous.trigger( <span class="hljs-string">'selection:unsingle'</span>, previous, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>If the model was already removed, trigger the collection
event manually.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.get( previous.cid ) ) {
					<span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'selection:unsingle'</span>, previous, <span class="hljs-keyword">this</span> );
				}
			}
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._single ) {
				<span class="hljs-keyword">this</span>._single.trigger( <span class="hljs-string">'selection:single'</span>, <span class="hljs-keyword">this</span>._single, <span class="hljs-keyword">this</span> );
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Return the single model, or the last model as a fallback.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._single;
	}
});

<span class="hljs-built_in">module</span>.exports = Selection;

},{}]},{},[<span class="hljs-number">1</span>]);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
