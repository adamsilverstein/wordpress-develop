<!DOCTYPE html>

<html>
<head>
  <title>heartbeat.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="bookmarklet.html">
                  bookmarklet.js
                </a>
              
                
                <a class="source" href="bookmarklet.min.html">
                  bookmarklet.min.js
                </a>
              
                
                <a class="source" href="color-picker.html">
                  color-picker.js
                </a>
              
                
                <a class="source" href="comment.html">
                  comment.js
                </a>
              
                
                <a class="source" href="common.html">
                  common.js
                </a>
              
                
                <a class="source" href="custom-background.html">
                  custom-background.js
                </a>
              
                
                <a class="source" href="custom-header.html">
                  custom-header.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-nav-menus.html">
                  customize-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-widgets.html">
                  customize-widgets.js
                </a>
              
                
                <a class="source" href="dashboard.html">
                  dashboard.js
                </a>
              
                
                <a class="source" href="edit-comments.html">
                  edit-comments.js
                </a>
              
                
                <a class="source" href="editor-expand.html">
                  editor-expand.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="farbtastic.html">
                  farbtastic.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="image-edit.html">
                  image-edit.js
                </a>
              
                
                <a class="source" href="inline-edit-post.html">
                  inline-edit-post.js
                </a>
              
                
                <a class="source" href="inline-edit-tax.html">
                  inline-edit-tax.js
                </a>
              
                
                <a class="source" href="iris.min.html">
                  iris.min.js
                </a>
              
                
                <a class="source" href="language-chooser.html">
                  language-chooser.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="media-gallery.html">
                  media-gallery.js
                </a>
              
                
                <a class="source" href="media-upload.html">
                  media-upload.js
                </a>
              
                
                <a class="source" href="media.html">
                  media.js
                </a>
              
                
                <a class="source" href="nav-menu.html">
                  nav-menu.js
                </a>
              
                
                <a class="source" href="password-strength-meter.html">
                  password-strength-meter.js
                </a>
              
                
                <a class="source" href="plugin-install.html">
                  plugin-install.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="postbox.html">
                  postbox.js
                </a>
              
                
                <a class="source" href="press-this.html">
                  press-this.js
                </a>
              
                
                <a class="source" href="revisions.html">
                  revisions.js
                </a>
              
                
                <a class="source" href="set-post-thumbnail.html">
                  set-post-thumbnail.js
                </a>
              
                
                <a class="source" href="svg-painter.html">
                  svg-painter.js
                </a>
              
                
                <a class="source" href="tags-box.html">
                  tags-box.js
                </a>
              
                
                <a class="source" href="tags-suggest.html">
                  tags-suggest.js
                </a>
              
                
                <a class="source" href="tags.html">
                  tags.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="updates.html">
                  updates.js
                </a>
              
                
                <a class="source" href="user-profile.html">
                  user-profile.js
                </a>
              
                
                <a class="source" href="user-suggest.html">
                  user-suggest.js
                </a>
              
                
                <a class="source" href="widgets.html">
                  widgets.js
                </a>
              
                
                <a class="source" href="media-audio-widget.html">
                  media-audio-widget.js
                </a>
              
                
                <a class="source" href="media-image-widget.html">
                  media-image-widget.js
                </a>
              
                
                <a class="source" href="media-video-widget.html">
                  media-video-widget.js
                </a>
              
                
                <a class="source" href="media-widgets.html">
                  media-widgets.js
                </a>
              
                
                <a class="source" href="text-widgets.html">
                  text-widgets.js
                </a>
              
                
                <a class="source" href="word-count.html">
                  word-count.js
                </a>
              
                
                <a class="source" href="wp-fullscreen-stub.html">
                  wp-fullscreen-stub.js
                </a>
              
                
                <a class="source" href="xfn.html">
                  xfn.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="theme-options.html">
                  theme-options.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="showcase.html">
                  showcase.js
                </a>
              
                
                <a class="source" href="color-scheme-control.html">
                  color-scheme-control.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="customizer.html">
                  customizer.js
                </a>
              
                
                <a class="source" href="featured-content-admin.html">
                  featured-content-admin.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="global.html">
                  global.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="jquery.scrollTo.html">
                  jquery.scrollTo.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="admin-bar.html">
                  admin-bar.js
                </a>
              
                
                <a class="source" href="autosave.html">
                  autosave.js
                </a>
              
                
                <a class="source" href="backbone.html">
                  backbone.js
                </a>
              
                
                <a class="source" href="backbone.min.html">
                  backbone.min.js
                </a>
              
                
                <a class="source" href="colorpicker.html">
                  colorpicker.js
                </a>
              
                
                <a class="source" href="comment-reply.html">
                  comment-reply.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-base.html">
                  customize-base.js
                </a>
              
                
                <a class="source" href="customize-loader.html">
                  customize-loader.js
                </a>
              
                
                <a class="source" href="customize-models.html">
                  customize-models.js
                </a>
              
                
                <a class="source" href="customize-preview-nav-menus.html">
                  customize-preview-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-preview-widgets.html">
                  customize-preview-widgets.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="customize-selective-refresh.html">
                  customize-selective-refresh.js
                </a>
              
                
                <a class="source" href="customize-views.html">
                  customize-views.js
                </a>
              
                
                <a class="source" href="heartbeat.html">
                  heartbeat.js
                </a>
              
                
                <a class="source" href="hoverIntent.html">
                  hoverIntent.js
                </a>
              
                
                <a class="source" href="imagesloaded.min.html">
                  imagesloaded.min.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.html">
                  jquery.imgareaselect.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.min.html">
                  jquery.imgareaselect.min.js
                </a>
              
                
                <a class="source" href="jquery.Jcrop.min.html">
                  jquery.Jcrop.min.js
                </a>
              
                
                <a class="source" href="jquery-migrate.html">
                  jquery-migrate.js
                </a>
              
                
                <a class="source" href="jquery-migrate.min.html">
                  jquery-migrate.min.js
                </a>
              
                
                <a class="source" href="jquery.color.min.html">
                  jquery.color.min.js
                </a>
              
                
                <a class="source" href="jquery.form.html">
                  jquery.form.js
                </a>
              
                
                <a class="source" href="jquery.form.min.html">
                  jquery.form.min.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.html">
                  jquery.hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.min.html">
                  jquery.hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.html">
                  jquery.js
                </a>
              
                
                <a class="source" href="jquery.masonry.html">
                  jquery.masonry.js
                </a>
              
                
                <a class="source" href="jquery.masonry.min.html">
                  jquery.masonry.min.js
                </a>
              
                
                <a class="source" href="jquery.query.html">
                  jquery.query.js
                </a>
              
                
                <a class="source" href="jquery.schedule.html">
                  jquery.schedule.js
                </a>
              
                
                <a class="source" href="jquery.serialize-object.html">
                  jquery.serialize-object.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.html">
                  jquery.table-hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.min.html">
                  jquery.table-hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.ui.touch-punch.html">
                  jquery.ui.touch-punch.js
                </a>
              
                
                <a class="source" href="suggest.html">
                  suggest.js
                </a>
              
                
                <a class="source" href="suggest.min.html">
                  suggest.min.js
                </a>
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="autocomplete.html">
                  autocomplete.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="core.html">
                  core.js
                </a>
              
                
                <a class="source" href="datepicker.html">
                  datepicker.js
                </a>
              
                
                <a class="source" href="dialog.html">
                  dialog.js
                </a>
              
                
                <a class="source" href="draggable.html">
                  draggable.js
                </a>
              
                
                <a class="source" href="droppable.html">
                  droppable.js
                </a>
              
                
                <a class="source" href="effect-blind.html">
                  effect-blind.js
                </a>
              
                
                <a class="source" href="effect-bounce.html">
                  effect-bounce.js
                </a>
              
                
                <a class="source" href="effect-clip.html">
                  effect-clip.js
                </a>
              
                
                <a class="source" href="effect-drop.html">
                  effect-drop.js
                </a>
              
                
                <a class="source" href="effect-explode.html">
                  effect-explode.js
                </a>
              
                
                <a class="source" href="effect-fade.html">
                  effect-fade.js
                </a>
              
                
                <a class="source" href="effect-fold.html">
                  effect-fold.js
                </a>
              
                
                <a class="source" href="effect-highlight.html">
                  effect-highlight.js
                </a>
              
                
                <a class="source" href="effect-puff.html">
                  effect-puff.js
                </a>
              
                
                <a class="source" href="effect-pulsate.html">
                  effect-pulsate.js
                </a>
              
                
                <a class="source" href="effect-scale.html">
                  effect-scale.js
                </a>
              
                
                <a class="source" href="effect-shake.html">
                  effect-shake.js
                </a>
              
                
                <a class="source" href="effect-size.html">
                  effect-size.js
                </a>
              
                
                <a class="source" href="effect-slide.html">
                  effect-slide.js
                </a>
              
                
                <a class="source" href="effect-transfer.html">
                  effect-transfer.js
                </a>
              
                
                <a class="source" href="effect.html">
                  effect.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="mouse.html">
                  mouse.js
                </a>
              
                
                <a class="source" href="position.html">
                  position.js
                </a>
              
                
                <a class="source" href="progressbar.html">
                  progressbar.js
                </a>
              
                
                <a class="source" href="resizable.html">
                  resizable.js
                </a>
              
                
                <a class="source" href="selectable.html">
                  selectable.js
                </a>
              
                
                <a class="source" href="selectmenu.html">
                  selectmenu.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="sortable.html">
                  sortable.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="tabs.html">
                  tabs.js
                </a>
              
                
                <a class="source" href="tooltip.html">
                  tooltip.js
                </a>
              
                
                <a class="source" href="widget.html">
                  widget.js
                </a>
              
                
                <a class="source" href="json2.html">
                  json2.js
                </a>
              
                
                <a class="source" href="masonry.min.html">
                  masonry.min.js
                </a>
              
                
                <a class="source" href="mce-view.html">
                  mce-view.js
                </a>
              
                
                <a class="source" href="media-audiovideo.html">
                  media-audiovideo.js
                </a>
              
                
                <a class="source" href="media-editor.html">
                  media-editor.js
                </a>
              
                
                <a class="source" href="media-grid.html">
                  media-grid.js
                </a>
              
                
                <a class="source" href="media-models.html">
                  media-models.js
                </a>
              
                
                <a class="source" href="media-views.html">
                  media-views.js
                </a>
              
                
                <a class="source" href="audiovideo.manifest.html">
                  audiovideo.manifest.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="collection-add.html">
                  collection-add.js
                </a>
              
                
                <a class="source" href="collection-edit.html">
                  collection-edit.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-image-cropper.html">
                  customize-image-cropper.js
                </a>
              
                
                <a class="source" href="edit-attachment-metadata.html">
                  edit-attachment-metadata.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="featured-image.html">
                  featured-image.js
                </a>
              
                
                <a class="source" href="gallery-add.html">
                  gallery-add.js
                </a>
              
                
                <a class="source" href="gallery-edit.html">
                  gallery-edit.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="media-library.html">
                  media-library.js
                </a>
              
                
                <a class="source" href="region.html">
                  region.js
                </a>
              
                
                <a class="source" href="replace-image.html">
                  replace-image.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="state-machine.html">
                  state-machine.js
                </a>
              
                
                <a class="source" href="state.html">
                  state.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="grid.manifest.html">
                  grid.manifest.js
                </a>
              
                
                <a class="source" href="models.manifest.html">
                  models.manifest.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="post-image.html">
                  post-image.js
                </a>
              
                
                <a class="source" href="post-media.html">
                  post-media.js
                </a>
              
                
                <a class="source" href="query.html">
                  query.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="selection-sync.html">
                  selection-sync.js
                </a>
              
                
                <a class="source" href="views.manifest.html">
                  views.manifest.js
                </a>
              
                
                <a class="source" href="attachment-compat.html">
                  attachment-compat.js
                </a>
              
                
                <a class="source" href="attachment-filters.html">
                  attachment-filters.js
                </a>
              
                
                <a class="source" href="all.html">
                  all.js
                </a>
              
                
                <a class="source" href="date.html">
                  date.js
                </a>
              
                
                <a class="source" href="uploaded.html">
                  uploaded.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="details-two-column.html">
                  details-two-column.js
                </a>
              
                
                <a class="source" href="details.html">
                  details.js
                </a>
              
                
                <a class="source" href="edit-library.html">
                  edit-library.js
                </a>
              
                
                <a class="source" href="edit-selection.html">
                  edit-selection.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="browser.html">
                  browser.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="button-group.html">
                  button-group.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="delete-selected-permanently.html">
                  delete-selected-permanently.js
                </a>
              
                
                <a class="source" href="delete-selected.html">
                  delete-selected.js
                </a>
              
                
                <a class="source" href="select-mode-toggle.html">
                  select-mode-toggle.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="edit-image-details.html">
                  edit-image-details.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="image.html">
                  image.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="url.html">
                  url.js
                </a>
              
                
                <a class="source" href="focus-manager.html">
                  focus-manager.js
                </a>
              
                
                <a class="source" href="frame.html">
                  frame.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="edit-attachments.html">
                  edit-attachments.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="iframe.html">
                  iframe.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="label.html">
                  label.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="media-frame.html">
                  media-frame.js
                </a>
              
                
                <a class="source" href="menu-item.html">
                  menu-item.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="modal.html">
                  modal.js
                </a>
              
                
                <a class="source" href="priority-list.html">
                  priority-list.js
                </a>
              
                
                <a class="source" href="router-item.html">
                  router-item.js
                </a>
              
                
                <a class="source" href="router.html">
                  router.js
                </a>
              
                
                <a class="source" href="search.html">
                  search.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="settings.html">
                  settings.js
                </a>
              
                
                <a class="source" href="attachment-display.html">
                  attachment-display.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="playlist.html">
                  playlist.js
                </a>
              
                
                <a class="source" href="sidebar.html">
                  sidebar.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="site-icon-preview.html">
                  site-icon-preview.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="toolbar.html">
                  toolbar.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="inline.html">
                  inline.js
                </a>
              
                
                <a class="source" href="status-error.html">
                  status-error.js
                </a>
              
                
                <a class="source" href="status.html">
                  status.js
                </a>
              
                
                <a class="source" href="window.html">
                  window.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="view.html">
                  view.js
                </a>
              
                
                <a class="source" href="froogaloop.min.html">
                  froogaloop.min.js
                </a>
              
                
                <a class="source" href="mediaelement-and-player.min.html">
                  mediaelement-and-player.min.js
                </a>
              
                
                <a class="source" href="wp-mediaelement.html">
                  wp-mediaelement.js
                </a>
              
                
                <a class="source" href="wp-playlist.html">
                  wp-playlist.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="plupload.full.min.html">
                  plupload.full.min.js
                </a>
              
                
                <a class="source" href="wp-plupload.html">
                  wp-plupload.js
                </a>
              
                
                <a class="source" href="quicktags.html">
                  quicktags.js
                </a>
              
                
                <a class="source" href="shortcode.html">
                  shortcode.js
                </a>
              
                
                <a class="source" href="swfobject.html">
                  swfobject.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="handlers.min.html">
                  handlers.min.js
                </a>
              
                
                <a class="source" href="swfupload.cookies.html">
                  swfupload.cookies.js
                </a>
              
                
                <a class="source" href="swfupload.queue.html">
                  swfupload.queue.js
                </a>
              
                
                <a class="source" href="swfupload.speed.html">
                  swfupload.speed.js
                </a>
              
                
                <a class="source" href="swfupload.swfobject.html">
                  swfupload.swfobject.js
                </a>
              
                
                <a class="source" href="swfupload.html">
                  swfupload.js
                </a>
              
                
                <a class="source" href="thickbox.html">
                  thickbox.js
                </a>
              
                
                <a class="source" href="wp-langs-en.html">
                  wp-langs-en.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="tiny_mce_popup.html">
                  tiny_mce_popup.js
                </a>
              
                
                <a class="source" href="tinymce.html">
                  tinymce.js
                </a>
              
                
                <a class="source" href="tinymce.min.html">
                  tinymce.min.js
                </a>
              
                
                <a class="source" href="editable_selects.html">
                  editable_selects.js
                </a>
              
                
                <a class="source" href="form_utils.html">
                  form_utils.js
                </a>
              
                
                <a class="source" href="mctabs.html">
                  mctabs.js
                </a>
              
                
                <a class="source" href="validate.html">
                  validate.js
                </a>
              
                
                <a class="source" href="tw-sack.html">
                  tw-sack.js
                </a>
              
                
                <a class="source" href="twemoji.html">
                  twemoji.js
                </a>
              
                
                <a class="source" href="underscore.html">
                  underscore.js
                </a>
              
                
                <a class="source" href="underscore.min.html">
                  underscore.min.js
                </a>
              
                
                <a class="source" href="utils.html">
                  utils.js
                </a>
              
                
                <a class="source" href="wp-a11y.html">
                  wp-a11y.js
                </a>
              
                
                <a class="source" href="wp-ajax-response.html">
                  wp-ajax-response.js
                </a>
              
                
                <a class="source" href="wp-api.html">
                  wp-api.js
                </a>
              
                
                <a class="source" href="wp-auth-check.html">
                  wp-auth-check.js
                </a>
              
                
                <a class="source" href="wp-backbone.html">
                  wp-backbone.js
                </a>
              
                
                <a class="source" href="wp-custom-header.html">
                  wp-custom-header.js
                </a>
              
                
                <a class="source" href="wp-embed-template.html">
                  wp-embed-template.js
                </a>
              
                
                <a class="source" href="wp-embed.html">
                  wp-embed.js
                </a>
              
                
                <a class="source" href="wp-emoji-loader.html">
                  wp-emoji-loader.js
                </a>
              
                
                <a class="source" href="wp-emoji.html">
                  wp-emoji.js
                </a>
              
                
                <a class="source" href="wp-list-revisions.html">
                  wp-list-revisions.js
                </a>
              
                
                <a class="source" href="wp-lists.html">
                  wp-lists.js
                </a>
              
                
                <a class="source" href="wp-pointer.html">
                  wp-pointer.js
                </a>
              
                
                <a class="source" href="wp-util.html">
                  wp-util.js
                </a>
              
                
                <a class="source" href="wpdialog.html">
                  wpdialog.js
                </a>
              
                
                <a class="source" href="wplink.html">
                  wplink.js
                </a>
              
                
                <a class="source" href="zxcvbn-async.html">
                  zxcvbn-async.js
                </a>
              
                
                <a class="source" href="zxcvbn.min.html">
                  zxcvbn.min.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>heartbeat.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * Heartbeat API
 *
 * Heartbeat is a simple server polling API that sends XHR requests to
 * the server every 15 - 60 seconds and triggers events (or callbacks) upon
 * receiving data. Currently these 'ticks' handle transports for post locking,
 * login-expiration warnings, autosave, and related tasks while a user is logged in.
 *
 * Available PHP filters (in ajax-actions.php):
 * - heartbeat_received
 * - heartbeat_send
 * - heartbeat_tick
 * - heartbeat_nopriv_received
 * - heartbeat_nopriv_send
 * - heartbeat_nopriv_tick
 * @see wp_ajax_nopriv_heartbeat(), wp_ajax_heartbeat()
 *
 * Custom jQuery events:
 * - heartbeat-send
 * - heartbeat-tick
 * - heartbeat-error
 * - heartbeat-connection-lost
 * - heartbeat-connection-restored
 * - heartbeat-nonces-expired
 *
 * @since 3.6.0
 */</span>

( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> $, window, undefined </span>) </span>{
	<span class="hljs-keyword">var</span> Heartbeat = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> $<span class="hljs-built_in">document</span> = $(<span class="hljs-built_in">document</span>),
			settings = {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Suspend/resume</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				suspend: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Whether suspending is enabled</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				suspendEnabled: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Current screen id, defaults to the JS global ‘pagenow’ when present (in the admin) or ‘front’</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				screenId: <span class="hljs-string">''</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>XHR request URL, defaults to the JS global ‘ajaxurl’ when present</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				url: <span class="hljs-string">''</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Timestamp, start of the last connection request</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				lastTick: <span class="hljs-number">0</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Container for the enqueued items</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				queue: {},</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Connect interval (in seconds)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				mainInterval: <span class="hljs-number">60</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Used when the interval is set to 5 sec. temporarily</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				tempInterval: <span class="hljs-number">0</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Used when the interval is reset</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				originalInterval: <span class="hljs-number">0</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Used to limit the number of AJAX requests.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				minimalInterval: <span class="hljs-number">0</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Used together with tempInterval</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				countdown: <span class="hljs-number">0</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Whether a connection is currently in progress</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				connecting: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Whether a connection error occurred</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				connectionError: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Used to track non-critical errors</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				errorcount: <span class="hljs-number">0</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Whether at least one connection has completed successfully</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				hasConnected: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Whether the current browser window is in focus and the user is active</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				hasFocus: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Timestamp, last time the user was active. Checked every 30 sec.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				userActivity: <span class="hljs-number">0</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Flags whether events tracking user activity were set</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				userActivityEvents: <span class="hljs-literal">false</span>,

				<span class="hljs-attr">checkFocusTimer</span>: <span class="hljs-number">0</span>,
				<span class="hljs-attr">beatTimer</span>: <span class="hljs-number">0</span>
			};

		<span class="hljs-comment">/**
		 * Set local vars and events, then start
		 *
		 * @access private
		 *
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initialize</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> options, hidden, visibilityState, visibilitychange;

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.pagenow === <span class="hljs-string">'string'</span> ) {
				settings.screenId = <span class="hljs-built_in">window</span>.pagenow;
			}

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.ajaxurl === <span class="hljs-string">'string'</span> ) {
				settings.url = <span class="hljs-built_in">window</span>.ajaxurl;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Pull in options passed from PHP</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.heartbeatSettings === <span class="hljs-string">'object'</span> ) {
				options = <span class="hljs-built_in">window</span>.heartbeatSettings;</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>The XHR URL can be passed as option when window.ajaxurl is not set</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( ! settings.url &amp;&amp; options.ajaxurl ) {
					settings.url = options.ajaxurl;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>The interval can be from 15 to 120 sec. and can be set temporarily to 5 sec.
It can be set in the initial options or changed later from JS and/or from PHP.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( options.interval ) {
					settings.mainInterval = options.interval;

					<span class="hljs-keyword">if</span> ( settings.mainInterval &lt; <span class="hljs-number">15</span> ) {
						settings.mainInterval = <span class="hljs-number">15</span>;
					} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( settings.mainInterval &gt; <span class="hljs-number">120</span> ) {
						settings.mainInterval = <span class="hljs-number">120</span>;
					}
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Used to limit the number of AJAX requests. Overrides all other intervals if they are shorter.
Needed for some hosts that cannot handle frequent requests and the user may exceed the allocated server CPU time, etc.
The minimal interval can be up to 600 sec. however setting it to longer than 120 sec. will limit or disable
some of the functionality (like post locks).
Once set at initialization, minimalInterval cannot be changed/overridden.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( options.minimalInterval ) {
					options.minimalInterval = <span class="hljs-built_in">parseInt</span>( options.minimalInterval, <span class="hljs-number">10</span> );
					settings.minimalInterval = options.minimalInterval &gt; <span class="hljs-number">0</span> &amp;&amp; options.minimalInterval &lt;= <span class="hljs-number">600</span> ? options.minimalInterval * <span class="hljs-number">1000</span> : <span class="hljs-number">0</span>;
				}

				<span class="hljs-keyword">if</span> ( settings.minimalInterval &amp;&amp; settings.mainInterval &lt; settings.minimalInterval ) {
					settings.mainInterval = settings.minimalInterval;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>‘screenId’ can be added from settings on the front end where the JS global ‘pagenow’ is not set</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( ! settings.screenId ) {
					settings.screenId = options.screenId || <span class="hljs-string">'front'</span>;
				}

				<span class="hljs-keyword">if</span> ( options.suspension === <span class="hljs-string">'disable'</span> ) {
					settings.suspendEnabled = <span class="hljs-literal">false</span>;
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Convert to milliseconds</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			settings.mainInterval = settings.mainInterval * <span class="hljs-number">1000</span>;
			settings.originalInterval = settings.mainInterval;</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Switch the interval to 120 sec. by using the Page Visibility API.
If the browser doesn’t support it (Safari &lt; 7, Android &lt; 4.4, IE &lt; 10), the interval
will be increased to 120 sec. after 5 min. of mouse and keyboard inactivity.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">document</span>.hidden !== <span class="hljs-string">'undefined'</span> ) {
				hidden = <span class="hljs-string">'hidden'</span>;
				visibilitychange = <span class="hljs-string">'visibilitychange'</span>;
				visibilityState = <span class="hljs-string">'visibilityState'</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">document</span>.msHidden !== <span class="hljs-string">'undefined'</span> ) { <span class="hljs-comment">// IE10</span>
				hidden = <span class="hljs-string">'msHidden'</span>;
				visibilitychange = <span class="hljs-string">'msvisibilitychange'</span>;
				visibilityState = <span class="hljs-string">'msVisibilityState'</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">document</span>.webkitHidden !== <span class="hljs-string">'undefined'</span> ) { <span class="hljs-comment">// Android</span>
				hidden = <span class="hljs-string">'webkitHidden'</span>;
				visibilitychange = <span class="hljs-string">'webkitvisibilitychange'</span>;
				visibilityState = <span class="hljs-string">'webkitVisibilityState'</span>;
			}

			<span class="hljs-keyword">if</span> ( hidden ) {
				<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">document</span>[hidden] ) {
					settings.hasFocus = <span class="hljs-literal">false</span>;
				}

				$<span class="hljs-built_in">document</span>.on( visibilitychange + <span class="hljs-string">'.wp-heartbeat'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">document</span>[visibilityState] === <span class="hljs-string">'hidden'</span> ) {
						blurred();
						<span class="hljs-built_in">window</span>.clearInterval( settings.checkFocusTimer );
					} <span class="hljs-keyword">else</span> {
						focused();
						<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">document</span>.hasFocus ) {
							settings.checkFocusTimer = <span class="hljs-built_in">window</span>.setInterval( checkFocus, <span class="hljs-number">10000</span> );
						}
					}
				});
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Use document.hasFocus() if available.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">document</span>.hasFocus ) {
				settings.checkFocusTimer = <span class="hljs-built_in">window</span>.setInterval( checkFocus, <span class="hljs-number">10000</span> );
			}

			$(<span class="hljs-built_in">window</span>).on( <span class="hljs-string">'unload.wp-heartbeat'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Don’t connect any more</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				settings.suspend = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Abort the last request if not completed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( settings.xhr &amp;&amp; settings.xhr.readyState !== <span class="hljs-number">4</span> ) {
					settings.xhr.abort();
				}
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Check for user activity every 30 seconds.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-built_in">window</span>.setInterval( checkUserActivity, <span class="hljs-number">30000</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Start one tick after DOM ready</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$<span class="hljs-built_in">document</span>.ready( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				settings.lastTick = time();
				scheduleNextTick();
			});
		}

		<span class="hljs-comment">/**
		 * Return the current time according to the browser
		 *
		 * @access private
		 *
		 * @return int
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">time</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()).getTime();
		}

		<span class="hljs-comment">/**
		 * Check if the iframe is from the same origin
		 *
		 * @access private
		 *
		 * @return bool
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isLocalFrame</span>(<span class="hljs-params"> frame </span>) </span>{
			<span class="hljs-keyword">var</span> origin, src = frame.src;</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Need to compare strings as WebKit doesn’t throw JS errors when iframes have different origin.
It throws uncatchable exceptions.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( src &amp;&amp; <span class="hljs-regexp">/^https?:\/\//</span>.test( src ) ) {
				origin = <span class="hljs-built_in">window</span>.location.origin ? <span class="hljs-built_in">window</span>.location.origin : <span class="hljs-built_in">window</span>.location.protocol + <span class="hljs-string">'//'</span> + <span class="hljs-built_in">window</span>.location.host;

				<span class="hljs-keyword">if</span> ( src.indexOf( origin ) !== <span class="hljs-number">0</span> ) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
			}

			<span class="hljs-keyword">try</span> {
				<span class="hljs-keyword">if</span> ( frame.contentWindow.document ) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
				}
			} <span class="hljs-keyword">catch</span>(e) {}

			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}

		<span class="hljs-comment">/**
		 * Check if the document's focus has changed
		 *
		 * @access private
		 *
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkFocus</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">if</span> ( settings.hasFocus &amp;&amp; ! <span class="hljs-built_in">document</span>.hasFocus() ) {
				blurred();
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( ! settings.hasFocus &amp;&amp; <span class="hljs-built_in">document</span>.hasFocus() ) {
				focused();
			}
		}

		<span class="hljs-comment">/**
		 * Set error state and fire an event on XHR errors or timeout
		 *
		 * @access private
		 *
		 * @param string error The error type passed from the XHR
		 * @param int status The HTTP status code passed from jqXHR (200, 404, 500, etc.)
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setErrorState</span>(<span class="hljs-params"> error, status </span>) </span>{
			<span class="hljs-keyword">var</span> trigger;

			<span class="hljs-keyword">if</span> ( error ) {
				<span class="hljs-keyword">switch</span> ( error ) {
					<span class="hljs-keyword">case</span> <span class="hljs-string">'abort'</span>:</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>do nothing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						<span class="hljs-keyword">break</span>;
					<span class="hljs-keyword">case</span> <span class="hljs-string">'timeout'</span>:</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>no response for 30 sec.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						trigger = <span class="hljs-literal">true</span>;
						<span class="hljs-keyword">break</span>;
					<span class="hljs-keyword">case</span> <span class="hljs-string">'error'</span>:
						<span class="hljs-keyword">if</span> ( <span class="hljs-number">503</span> === status &amp;&amp; settings.hasConnected ) {
							trigger = <span class="hljs-literal">true</span>;
							<span class="hljs-keyword">break</span>;
						}
						<span class="hljs-comment">/* falls through */</span>
					<span class="hljs-keyword">case</span> <span class="hljs-string">'parsererror'</span>:
					<span class="hljs-keyword">case</span> <span class="hljs-string">'empty'</span>:
					<span class="hljs-keyword">case</span> <span class="hljs-string">'unknown'</span>:
						settings.errorcount++;

						<span class="hljs-keyword">if</span> ( settings.errorcount &gt; <span class="hljs-number">2</span> &amp;&amp; settings.hasConnected ) {
							trigger = <span class="hljs-literal">true</span>;
						}

						<span class="hljs-keyword">break</span>;
				}

				<span class="hljs-keyword">if</span> ( trigger &amp;&amp; ! hasConnectionError() ) {
					settings.connectionError = <span class="hljs-literal">true</span>;
					$<span class="hljs-built_in">document</span>.trigger( <span class="hljs-string">'heartbeat-connection-lost'</span>, [error, status] );
				}
			}
		}

		<span class="hljs-comment">/**
		 * Clear the error state and fire an event
		 *
		 * @access private
		 *
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearErrorState</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Has connected successfully</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			settings.hasConnected = <span class="hljs-literal">true</span>;

			<span class="hljs-keyword">if</span> ( hasConnectionError() ) {
				settings.errorcount = <span class="hljs-number">0</span>;
				settings.connectionError = <span class="hljs-literal">false</span>;
				$<span class="hljs-built_in">document</span>.trigger( <span class="hljs-string">'heartbeat-connection-restored'</span> );
			}
		}

		<span class="hljs-comment">/**
		 * Gather the data and connect to the server
		 *
		 * @access private
		 *
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">connect</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> ajaxData, heartbeatData;</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>If the connection to the server is slower than the interval,
heartbeat connects as soon as the previous connection’s response is received.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( settings.connecting || settings.suspend ) {
				<span class="hljs-keyword">return</span>;
			}

			settings.lastTick = time();

			heartbeatData = $.extend( {}, settings.queue );</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Clear the data queue, anything added after this point will be send on the next tick</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			settings.queue = {};

			$<span class="hljs-built_in">document</span>.trigger( <span class="hljs-string">'heartbeat-send'</span>, [ heartbeatData ] );

			ajaxData = {
				<span class="hljs-attr">data</span>: heartbeatData,
				<span class="hljs-attr">interval</span>: settings.tempInterval ? settings.tempInterval / <span class="hljs-number">1000</span> : settings.mainInterval / <span class="hljs-number">1000</span>,
				<span class="hljs-attr">_nonce</span>: <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.heartbeatSettings === <span class="hljs-string">'object'</span> ? <span class="hljs-built_in">window</span>.heartbeatSettings.nonce : <span class="hljs-string">''</span>,
				<span class="hljs-attr">action</span>: <span class="hljs-string">'heartbeat'</span>,
				<span class="hljs-attr">screen_id</span>: settings.screenId,
				<span class="hljs-attr">has_focus</span>: settings.hasFocus
			};

			settings.connecting = <span class="hljs-literal">true</span>;
			settings.xhr = $.ajax({
				<span class="hljs-attr">url</span>: settings.url,
				<span class="hljs-attr">type</span>: <span class="hljs-string">'post'</span>,
				<span class="hljs-attr">timeout</span>: <span class="hljs-number">30000</span>, <span class="hljs-comment">// throw an error if not completed after 30 sec.</span>
				data: ajaxData,
				<span class="hljs-attr">dataType</span>: <span class="hljs-string">'json'</span>
			}).always( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				settings.connecting = <span class="hljs-literal">false</span>;
				scheduleNextTick();
			}).done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> response, textStatus, jqXHR </span>) </span>{
				<span class="hljs-keyword">var</span> newInterval;

				<span class="hljs-keyword">if</span> ( ! response ) {
					setErrorState( <span class="hljs-string">'empty'</span> );
					<span class="hljs-keyword">return</span>;
				}

				clearErrorState();

				<span class="hljs-keyword">if</span> ( response.nonces_expired ) {
					$<span class="hljs-built_in">document</span>.trigger( <span class="hljs-string">'heartbeat-nonces-expired'</span> );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Change the interval from PHP</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( response.heartbeat_interval ) {
					newInterval = response.heartbeat_interval;
					<span class="hljs-keyword">delete</span> response.heartbeat_interval;
				}

				$<span class="hljs-built_in">document</span>.trigger( <span class="hljs-string">'heartbeat-tick'</span>, [response, textStatus, jqXHR] );</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Do this last, can trigger the next XHR if connection time &gt; 5 sec. and newInterval == ‘fast’</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( newInterval ) {
					interval( newInterval );
				}
			}).fail( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> jqXHR, textStatus, error </span>) </span>{
				setErrorState( textStatus || <span class="hljs-string">'unknown'</span>, jqXHR.status );
				$<span class="hljs-built_in">document</span>.trigger( <span class="hljs-string">'heartbeat-error'</span>, [jqXHR, textStatus, error] );
			});
		}

		<span class="hljs-comment">/**
		 * Schedule the next connection
		 *
		 * Fires immediately if the connection time is longer than the interval.
		 *
		 * @access private
		 *
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scheduleNextTick</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> delta = time() - settings.lastTick,
				interval = settings.mainInterval;

			<span class="hljs-keyword">if</span> ( settings.suspend ) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">if</span> ( ! settings.hasFocus ) {
				interval = <span class="hljs-number">120000</span>; <span class="hljs-comment">// 120 sec. Post locks expire after 150 sec.</span>
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( settings.countdown &gt; <span class="hljs-number">0</span> &amp;&amp; settings.tempInterval ) {
				interval = settings.tempInterval;
				settings.countdown--;

				<span class="hljs-keyword">if</span> ( settings.countdown &lt; <span class="hljs-number">1</span> ) {
					settings.tempInterval = <span class="hljs-number">0</span>;
				}
			}

			<span class="hljs-keyword">if</span> ( settings.minimalInterval &amp;&amp; interval &lt; settings.minimalInterval ) {
				interval = settings.minimalInterval;
			}

			<span class="hljs-built_in">window</span>.clearTimeout( settings.beatTimer );

			<span class="hljs-keyword">if</span> ( delta &lt; interval ) {
				settings.beatTimer = <span class="hljs-built_in">window</span>.setTimeout(
					<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						connect();
					},
					interval - delta
				);
			} <span class="hljs-keyword">else</span> {
				connect();
			}
		}

		<span class="hljs-comment">/**
		 * Set the internal state when the browser window becomes hidden or loses focus
		 *
		 * @access private
		 *
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blurred</span>(<span class="hljs-params"></span>) </span>{
			settings.hasFocus = <span class="hljs-literal">false</span>;
		}

		<span class="hljs-comment">/**
		 * Set the internal state when the browser window becomes visible or is in focus
		 *
		 * @access private
		 *
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">focused</span>(<span class="hljs-params"></span>) </span>{
			settings.userActivity = time();</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Resume if suspended</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			settings.suspend = <span class="hljs-literal">false</span>;

			<span class="hljs-keyword">if</span> ( ! settings.hasFocus ) {
				settings.hasFocus = <span class="hljs-literal">true</span>;
				scheduleNextTick();
			}
		}

		<span class="hljs-comment">/**
		 * Runs when the user becomes active after a period of inactivity
		 *
		 * @access private
		 *
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">userIsActive</span>(<span class="hljs-params"></span>) </span>{
			settings.userActivityEvents = <span class="hljs-literal">false</span>;
			$<span class="hljs-built_in">document</span>.off( <span class="hljs-string">'.wp-heartbeat-active'</span> );

			$(<span class="hljs-string">'iframe'</span>).each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> i, frame </span>) </span>{
				<span class="hljs-keyword">if</span> ( isLocalFrame( frame ) ) {
					$( frame.contentWindow ).off( <span class="hljs-string">'.wp-heartbeat-active'</span> );
				}
			});

			focused();
		}

		<span class="hljs-comment">/**
		 * Check for user activity
		 *
		 * Runs every 30 sec.
		 * Sets 'hasFocus = true' if user is active and the window is in the background.
		 * Set 'hasFocus = false' if the user has been inactive (no mouse or keyboard activity)
		 * for 5 min. even when the window has focus.
		 *
		 * @access private
		 *
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkUserActivity</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> lastActive = settings.userActivity ? time() - settings.userActivity : <span class="hljs-number">0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Throttle down when no mouse or keyboard activity for 5 min.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( lastActive &gt; <span class="hljs-number">300000</span> &amp;&amp; settings.hasFocus ) {
				blurred();
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Suspend after 10 min. of inactivity when suspending is enabled.
Always suspend after 60 min. of inactivity. This will release the post lock, etc.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ( settings.suspendEnabled &amp;&amp; lastActive &gt; <span class="hljs-number">600000</span> ) || lastActive &gt; <span class="hljs-number">3600000</span> ) {
				settings.suspend = <span class="hljs-literal">true</span>;
			}

			<span class="hljs-keyword">if</span> ( ! settings.userActivityEvents ) {
				$<span class="hljs-built_in">document</span>.on( <span class="hljs-string">'mouseover.wp-heartbeat-active keyup.wp-heartbeat-active touchend.wp-heartbeat-active'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					userIsActive();
				});

				$(<span class="hljs-string">'iframe'</span>).each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> i, frame </span>) </span>{
					<span class="hljs-keyword">if</span> ( isLocalFrame( frame ) ) {
						$( frame.contentWindow ).on( <span class="hljs-string">'mouseover.wp-heartbeat-active keyup.wp-heartbeat-active touchend.wp-heartbeat-active'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
							userIsActive();
						});
					}
				});

				settings.userActivityEvents = <span class="hljs-literal">true</span>;
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Public methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		<span class="hljs-comment">/**
		 * Whether the window (or any local iframe in it) has focus, or the user is active
		 *
		 * @return bool
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasFocus</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> settings.hasFocus;
		}

		<span class="hljs-comment">/**
		 * Whether there is a connection error
		 *
		 * @return bool
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasConnectionError</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> settings.connectionError;
		}

		<span class="hljs-comment">/**
		 * Connect asap regardless of 'hasFocus'
		 *
		 * Will not open two concurrent connections. If a connection is in progress,
		 * will connect again immediately after the current connection completes.
		 *
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">connectNow</span>(<span class="hljs-params"></span>) </span>{
			settings.lastTick = <span class="hljs-number">0</span>;
			scheduleNextTick();
		}

		<span class="hljs-comment">/**
		 * Disable suspending
		 *
		 * Should be used only when Heartbeat is performing critical tasks like autosave, post-locking, etc.
		 * Using this on many screens may overload the user's hosting account if several
		 * browser windows/tabs are left open for a long time.
		 *
		 * @return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disableSuspend</span>(<span class="hljs-params"></span>) </span>{
			settings.suspendEnabled = <span class="hljs-literal">false</span>;
		}

		<span class="hljs-comment">/**
		 * Get/Set the interval
		 *
		 * When setting to 'fast' or 5, by default interval is 5 sec. for the next 30 ticks (for 2 min and 30 sec).
		 * In this case the number of 'ticks' can be passed as second argument.
		 * If the window doesn't have focus, the interval slows down to 2 min.
		 *
		 * @param mixed speed Interval: 'fast' or 5, 15, 30, 60, 120
		 * @param string ticks Used with speed = 'fast' or 5, how many ticks before the interval reverts back
		 * @return int Current interval in seconds
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">interval</span>(<span class="hljs-params"> speed, ticks </span>) </span>{
			<span class="hljs-keyword">var</span> newInterval,
				oldInterval = settings.tempInterval ? settings.tempInterval : settings.mainInterval;

			<span class="hljs-keyword">if</span> ( speed ) {
				<span class="hljs-keyword">switch</span> ( speed ) {
					<span class="hljs-keyword">case</span> <span class="hljs-string">'fast'</span>:
					<span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:
						newInterval = <span class="hljs-number">5000</span>;
						<span class="hljs-keyword">break</span>;
					<span class="hljs-keyword">case</span> <span class="hljs-number">15</span>:
						newInterval = <span class="hljs-number">15000</span>;
						<span class="hljs-keyword">break</span>;
					<span class="hljs-keyword">case</span> <span class="hljs-number">30</span>:
						newInterval = <span class="hljs-number">30000</span>;
						<span class="hljs-keyword">break</span>;
					<span class="hljs-keyword">case</span> <span class="hljs-number">60</span>:
						newInterval = <span class="hljs-number">60000</span>;
						<span class="hljs-keyword">break</span>;
					<span class="hljs-keyword">case</span> <span class="hljs-number">120</span>:
						newInterval = <span class="hljs-number">120000</span>;
						<span class="hljs-keyword">break</span>;
					<span class="hljs-keyword">case</span> <span class="hljs-string">'long-polling'</span>:</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Allow long polling, (experimental)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						settings.mainInterval = <span class="hljs-number">0</span>;
						<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
					<span class="hljs-keyword">default</span>:
						newInterval = settings.originalInterval;
				}

				<span class="hljs-keyword">if</span> ( settings.minimalInterval &amp;&amp; newInterval &lt; settings.minimalInterval ) {
					newInterval = settings.minimalInterval;
				}

				<span class="hljs-keyword">if</span> ( <span class="hljs-number">5000</span> === newInterval ) {
					ticks = <span class="hljs-built_in">parseInt</span>( ticks, <span class="hljs-number">10</span> ) || <span class="hljs-number">30</span>;
					ticks = ticks &lt; <span class="hljs-number">1</span> || ticks &gt; <span class="hljs-number">30</span> ? <span class="hljs-number">30</span> : ticks;

					settings.countdown = ticks;
					settings.tempInterval = newInterval;
				} <span class="hljs-keyword">else</span> {
					settings.countdown = <span class="hljs-number">0</span>;
					settings.tempInterval = <span class="hljs-number">0</span>;
					settings.mainInterval = newInterval;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Change the next connection time if new interval has been set.
Will connect immediately if the time since the last connection
is greater than the new interval.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( newInterval !== oldInterval ) {
					scheduleNextTick();
				}
			}

			<span class="hljs-keyword">return</span> settings.tempInterval ? settings.tempInterval / <span class="hljs-number">1000</span> : settings.mainInterval / <span class="hljs-number">1000</span>;
		}

		<span class="hljs-comment">/**
		 * Enqueue data to send with the next XHR
		 *
		 * As the data is send asynchronously, this function doesn't return the XHR response.
		 * To see the response, use the custom jQuery event 'heartbeat-tick' on the document, example:
		 *		$(document).on( 'heartbeat-tick.myname', function( event, data, textStatus, jqXHR ) {
		 *			// code
		 *		});
		 * If the same 'handle' is used more than once, the data is not overwritten when the third argument is 'true'.
		 * Use wp.heartbeat.isQueued('handle') to see if any data is already queued for that handle.
		 *
		 * $param string handle Unique handle for the data. The handle is used in PHP to receive the data.
		 * $param mixed data The data to send.
		 * $param bool noOverwrite Whether to overwrite existing data in the queue.
		 * $return bool Whether the data was queued or not.
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enqueue</span>(<span class="hljs-params"> handle, data, noOverwrite </span>) </span>{
			<span class="hljs-keyword">if</span> ( handle ) {
				<span class="hljs-keyword">if</span> ( noOverwrite &amp;&amp; <span class="hljs-keyword">this</span>.isQueued( handle ) ) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}

				settings.queue[handle] = data;
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}

		<span class="hljs-comment">/**
		 * Check if data with a particular handle is queued
		 *
		 * $param string handle The handle for the data
		 * $return bool Whether some data is queued with this handle
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isQueued</span>(<span class="hljs-params"> handle </span>) </span>{
			<span class="hljs-keyword">if</span> ( handle ) {
				<span class="hljs-keyword">return</span> settings.queue.hasOwnProperty( handle );
			}
		}

		<span class="hljs-comment">/**
		 * Remove data with a particular handle from the queue
		 *
		 * $param string handle The handle for the data
		 * $return void
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dequeue</span>(<span class="hljs-params"> handle </span>) </span>{
			<span class="hljs-keyword">if</span> ( handle ) {
				<span class="hljs-keyword">delete</span> settings.queue[handle];
			}
		}

		<span class="hljs-comment">/**
		 * Get data that was enqueued with a particular handle
		 *
		 * $param string handle The handle for the data
		 * $return mixed The data or undefined
		 */</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getQueuedItem</span>(<span class="hljs-params"> handle </span>) </span>{
			<span class="hljs-keyword">if</span> ( handle ) {
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.isQueued( handle ) ? settings.queue[handle] : <span class="hljs-literal">undefined</span>;
			}
		}

		initialize();</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Expose public methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">return</span> {
			<span class="hljs-attr">hasFocus</span>: hasFocus,
			<span class="hljs-attr">connectNow</span>: connectNow,
			<span class="hljs-attr">disableSuspend</span>: disableSuspend,
			<span class="hljs-attr">interval</span>: interval,
			<span class="hljs-attr">hasConnectionError</span>: hasConnectionError,
			<span class="hljs-attr">enqueue</span>: enqueue,
			<span class="hljs-attr">dequeue</span>: dequeue,
			<span class="hljs-attr">isQueued</span>: isQueued,
			<span class="hljs-attr">getQueuedItem</span>: getQueuedItem
		};
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Ensure the global <code>wp</code> object exists.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-built_in">window</span>.wp = <span class="hljs-built_in">window</span>.wp || {};
	<span class="hljs-built_in">window</span>.wp.heartbeat = <span class="hljs-keyword">new</span> Heartbeat();

}( jQuery, <span class="hljs-built_in">window</span> ));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
