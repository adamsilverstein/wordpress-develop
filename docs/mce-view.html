<!DOCTYPE html>

<html>
<head>
  <title>mce-view.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="bookmarklet.html">
                  bookmarklet.js
                </a>
              
                
                <a class="source" href="bookmarklet.min.html">
                  bookmarklet.min.js
                </a>
              
                
                <a class="source" href="color-picker.html">
                  color-picker.js
                </a>
              
                
                <a class="source" href="comment.html">
                  comment.js
                </a>
              
                
                <a class="source" href="common.html">
                  common.js
                </a>
              
                
                <a class="source" href="custom-background.html">
                  custom-background.js
                </a>
              
                
                <a class="source" href="custom-header.html">
                  custom-header.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-nav-menus.html">
                  customize-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-widgets.html">
                  customize-widgets.js
                </a>
              
                
                <a class="source" href="dashboard.html">
                  dashboard.js
                </a>
              
                
                <a class="source" href="edit-comments.html">
                  edit-comments.js
                </a>
              
                
                <a class="source" href="editor-expand.html">
                  editor-expand.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="farbtastic.html">
                  farbtastic.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="image-edit.html">
                  image-edit.js
                </a>
              
                
                <a class="source" href="inline-edit-post.html">
                  inline-edit-post.js
                </a>
              
                
                <a class="source" href="inline-edit-tax.html">
                  inline-edit-tax.js
                </a>
              
                
                <a class="source" href="iris.min.html">
                  iris.min.js
                </a>
              
                
                <a class="source" href="language-chooser.html">
                  language-chooser.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="media-gallery.html">
                  media-gallery.js
                </a>
              
                
                <a class="source" href="media-upload.html">
                  media-upload.js
                </a>
              
                
                <a class="source" href="media.html">
                  media.js
                </a>
              
                
                <a class="source" href="nav-menu.html">
                  nav-menu.js
                </a>
              
                
                <a class="source" href="password-strength-meter.html">
                  password-strength-meter.js
                </a>
              
                
                <a class="source" href="plugin-install.html">
                  plugin-install.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="postbox.html">
                  postbox.js
                </a>
              
                
                <a class="source" href="press-this.html">
                  press-this.js
                </a>
              
                
                <a class="source" href="revisions.html">
                  revisions.js
                </a>
              
                
                <a class="source" href="set-post-thumbnail.html">
                  set-post-thumbnail.js
                </a>
              
                
                <a class="source" href="svg-painter.html">
                  svg-painter.js
                </a>
              
                
                <a class="source" href="tags-box.html">
                  tags-box.js
                </a>
              
                
                <a class="source" href="tags-suggest.html">
                  tags-suggest.js
                </a>
              
                
                <a class="source" href="tags.html">
                  tags.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="updates.html">
                  updates.js
                </a>
              
                
                <a class="source" href="user-profile.html">
                  user-profile.js
                </a>
              
                
                <a class="source" href="user-suggest.html">
                  user-suggest.js
                </a>
              
                
                <a class="source" href="widgets.html">
                  widgets.js
                </a>
              
                
                <a class="source" href="media-audio-widget.html">
                  media-audio-widget.js
                </a>
              
                
                <a class="source" href="media-image-widget.html">
                  media-image-widget.js
                </a>
              
                
                <a class="source" href="media-video-widget.html">
                  media-video-widget.js
                </a>
              
                
                <a class="source" href="media-widgets.html">
                  media-widgets.js
                </a>
              
                
                <a class="source" href="text-widgets.html">
                  text-widgets.js
                </a>
              
                
                <a class="source" href="word-count.html">
                  word-count.js
                </a>
              
                
                <a class="source" href="wp-fullscreen-stub.html">
                  wp-fullscreen-stub.js
                </a>
              
                
                <a class="source" href="xfn.html">
                  xfn.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="theme-options.html">
                  theme-options.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="showcase.html">
                  showcase.js
                </a>
              
                
                <a class="source" href="color-scheme-control.html">
                  color-scheme-control.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="customizer.html">
                  customizer.js
                </a>
              
                
                <a class="source" href="featured-content-admin.html">
                  featured-content-admin.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="global.html">
                  global.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="jquery.scrollTo.html">
                  jquery.scrollTo.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="admin-bar.html">
                  admin-bar.js
                </a>
              
                
                <a class="source" href="autosave.html">
                  autosave.js
                </a>
              
                
                <a class="source" href="backbone.html">
                  backbone.js
                </a>
              
                
                <a class="source" href="backbone.min.html">
                  backbone.min.js
                </a>
              
                
                <a class="source" href="colorpicker.html">
                  colorpicker.js
                </a>
              
                
                <a class="source" href="comment-reply.html">
                  comment-reply.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-base.html">
                  customize-base.js
                </a>
              
                
                <a class="source" href="customize-loader.html">
                  customize-loader.js
                </a>
              
                
                <a class="source" href="customize-models.html">
                  customize-models.js
                </a>
              
                
                <a class="source" href="customize-preview-nav-menus.html">
                  customize-preview-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-preview-widgets.html">
                  customize-preview-widgets.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="customize-selective-refresh.html">
                  customize-selective-refresh.js
                </a>
              
                
                <a class="source" href="customize-views.html">
                  customize-views.js
                </a>
              
                
                <a class="source" href="heartbeat.html">
                  heartbeat.js
                </a>
              
                
                <a class="source" href="hoverIntent.html">
                  hoverIntent.js
                </a>
              
                
                <a class="source" href="imagesloaded.min.html">
                  imagesloaded.min.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.html">
                  jquery.imgareaselect.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.min.html">
                  jquery.imgareaselect.min.js
                </a>
              
                
                <a class="source" href="jquery.Jcrop.min.html">
                  jquery.Jcrop.min.js
                </a>
              
                
                <a class="source" href="jquery-migrate.html">
                  jquery-migrate.js
                </a>
              
                
                <a class="source" href="jquery-migrate.min.html">
                  jquery-migrate.min.js
                </a>
              
                
                <a class="source" href="jquery.color.min.html">
                  jquery.color.min.js
                </a>
              
                
                <a class="source" href="jquery.form.html">
                  jquery.form.js
                </a>
              
                
                <a class="source" href="jquery.form.min.html">
                  jquery.form.min.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.html">
                  jquery.hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.min.html">
                  jquery.hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.html">
                  jquery.js
                </a>
              
                
                <a class="source" href="jquery.masonry.html">
                  jquery.masonry.js
                </a>
              
                
                <a class="source" href="jquery.masonry.min.html">
                  jquery.masonry.min.js
                </a>
              
                
                <a class="source" href="jquery.query.html">
                  jquery.query.js
                </a>
              
                
                <a class="source" href="jquery.schedule.html">
                  jquery.schedule.js
                </a>
              
                
                <a class="source" href="jquery.serialize-object.html">
                  jquery.serialize-object.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.html">
                  jquery.table-hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.min.html">
                  jquery.table-hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.ui.touch-punch.html">
                  jquery.ui.touch-punch.js
                </a>
              
                
                <a class="source" href="suggest.html">
                  suggest.js
                </a>
              
                
                <a class="source" href="suggest.min.html">
                  suggest.min.js
                </a>
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="autocomplete.html">
                  autocomplete.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="core.html">
                  core.js
                </a>
              
                
                <a class="source" href="datepicker.html">
                  datepicker.js
                </a>
              
                
                <a class="source" href="dialog.html">
                  dialog.js
                </a>
              
                
                <a class="source" href="draggable.html">
                  draggable.js
                </a>
              
                
                <a class="source" href="droppable.html">
                  droppable.js
                </a>
              
                
                <a class="source" href="effect-blind.html">
                  effect-blind.js
                </a>
              
                
                <a class="source" href="effect-bounce.html">
                  effect-bounce.js
                </a>
              
                
                <a class="source" href="effect-clip.html">
                  effect-clip.js
                </a>
              
                
                <a class="source" href="effect-drop.html">
                  effect-drop.js
                </a>
              
                
                <a class="source" href="effect-explode.html">
                  effect-explode.js
                </a>
              
                
                <a class="source" href="effect-fade.html">
                  effect-fade.js
                </a>
              
                
                <a class="source" href="effect-fold.html">
                  effect-fold.js
                </a>
              
                
                <a class="source" href="effect-highlight.html">
                  effect-highlight.js
                </a>
              
                
                <a class="source" href="effect-puff.html">
                  effect-puff.js
                </a>
              
                
                <a class="source" href="effect-pulsate.html">
                  effect-pulsate.js
                </a>
              
                
                <a class="source" href="effect-scale.html">
                  effect-scale.js
                </a>
              
                
                <a class="source" href="effect-shake.html">
                  effect-shake.js
                </a>
              
                
                <a class="source" href="effect-size.html">
                  effect-size.js
                </a>
              
                
                <a class="source" href="effect-slide.html">
                  effect-slide.js
                </a>
              
                
                <a class="source" href="effect-transfer.html">
                  effect-transfer.js
                </a>
              
                
                <a class="source" href="effect.html">
                  effect.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="mouse.html">
                  mouse.js
                </a>
              
                
                <a class="source" href="position.html">
                  position.js
                </a>
              
                
                <a class="source" href="progressbar.html">
                  progressbar.js
                </a>
              
                
                <a class="source" href="resizable.html">
                  resizable.js
                </a>
              
                
                <a class="source" href="selectable.html">
                  selectable.js
                </a>
              
                
                <a class="source" href="selectmenu.html">
                  selectmenu.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="sortable.html">
                  sortable.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="tabs.html">
                  tabs.js
                </a>
              
                
                <a class="source" href="tooltip.html">
                  tooltip.js
                </a>
              
                
                <a class="source" href="widget.html">
                  widget.js
                </a>
              
                
                <a class="source" href="json2.html">
                  json2.js
                </a>
              
                
                <a class="source" href="masonry.min.html">
                  masonry.min.js
                </a>
              
                
                <a class="source" href="mce-view.html">
                  mce-view.js
                </a>
              
                
                <a class="source" href="media-audiovideo.html">
                  media-audiovideo.js
                </a>
              
                
                <a class="source" href="media-editor.html">
                  media-editor.js
                </a>
              
                
                <a class="source" href="media-grid.html">
                  media-grid.js
                </a>
              
                
                <a class="source" href="media-models.html">
                  media-models.js
                </a>
              
                
                <a class="source" href="media-views.html">
                  media-views.js
                </a>
              
                
                <a class="source" href="audiovideo.manifest.html">
                  audiovideo.manifest.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="collection-add.html">
                  collection-add.js
                </a>
              
                
                <a class="source" href="collection-edit.html">
                  collection-edit.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-image-cropper.html">
                  customize-image-cropper.js
                </a>
              
                
                <a class="source" href="edit-attachment-metadata.html">
                  edit-attachment-metadata.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="featured-image.html">
                  featured-image.js
                </a>
              
                
                <a class="source" href="gallery-add.html">
                  gallery-add.js
                </a>
              
                
                <a class="source" href="gallery-edit.html">
                  gallery-edit.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="media-library.html">
                  media-library.js
                </a>
              
                
                <a class="source" href="region.html">
                  region.js
                </a>
              
                
                <a class="source" href="replace-image.html">
                  replace-image.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="state-machine.html">
                  state-machine.js
                </a>
              
                
                <a class="source" href="state.html">
                  state.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="grid.manifest.html">
                  grid.manifest.js
                </a>
              
                
                <a class="source" href="models.manifest.html">
                  models.manifest.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="post-image.html">
                  post-image.js
                </a>
              
                
                <a class="source" href="post-media.html">
                  post-media.js
                </a>
              
                
                <a class="source" href="query.html">
                  query.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="selection-sync.html">
                  selection-sync.js
                </a>
              
                
                <a class="source" href="views.manifest.html">
                  views.manifest.js
                </a>
              
                
                <a class="source" href="attachment-compat.html">
                  attachment-compat.js
                </a>
              
                
                <a class="source" href="attachment-filters.html">
                  attachment-filters.js
                </a>
              
                
                <a class="source" href="all.html">
                  all.js
                </a>
              
                
                <a class="source" href="date.html">
                  date.js
                </a>
              
                
                <a class="source" href="uploaded.html">
                  uploaded.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="details-two-column.html">
                  details-two-column.js
                </a>
              
                
                <a class="source" href="details.html">
                  details.js
                </a>
              
                
                <a class="source" href="edit-library.html">
                  edit-library.js
                </a>
              
                
                <a class="source" href="edit-selection.html">
                  edit-selection.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="browser.html">
                  browser.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="button-group.html">
                  button-group.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="delete-selected-permanently.html">
                  delete-selected-permanently.js
                </a>
              
                
                <a class="source" href="delete-selected.html">
                  delete-selected.js
                </a>
              
                
                <a class="source" href="select-mode-toggle.html">
                  select-mode-toggle.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="edit-image-details.html">
                  edit-image-details.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="image.html">
                  image.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="url.html">
                  url.js
                </a>
              
                
                <a class="source" href="focus-manager.html">
                  focus-manager.js
                </a>
              
                
                <a class="source" href="frame.html">
                  frame.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="edit-attachments.html">
                  edit-attachments.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="iframe.html">
                  iframe.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="label.html">
                  label.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="media-frame.html">
                  media-frame.js
                </a>
              
                
                <a class="source" href="menu-item.html">
                  menu-item.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="modal.html">
                  modal.js
                </a>
              
                
                <a class="source" href="priority-list.html">
                  priority-list.js
                </a>
              
                
                <a class="source" href="router-item.html">
                  router-item.js
                </a>
              
                
                <a class="source" href="router.html">
                  router.js
                </a>
              
                
                <a class="source" href="search.html">
                  search.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="settings.html">
                  settings.js
                </a>
              
                
                <a class="source" href="attachment-display.html">
                  attachment-display.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="playlist.html">
                  playlist.js
                </a>
              
                
                <a class="source" href="sidebar.html">
                  sidebar.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="site-icon-preview.html">
                  site-icon-preview.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="toolbar.html">
                  toolbar.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="inline.html">
                  inline.js
                </a>
              
                
                <a class="source" href="status-error.html">
                  status-error.js
                </a>
              
                
                <a class="source" href="status.html">
                  status.js
                </a>
              
                
                <a class="source" href="window.html">
                  window.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="view.html">
                  view.js
                </a>
              
                
                <a class="source" href="froogaloop.min.html">
                  froogaloop.min.js
                </a>
              
                
                <a class="source" href="mediaelement-and-player.min.html">
                  mediaelement-and-player.min.js
                </a>
              
                
                <a class="source" href="wp-mediaelement.html">
                  wp-mediaelement.js
                </a>
              
                
                <a class="source" href="wp-playlist.html">
                  wp-playlist.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="plupload.full.min.html">
                  plupload.full.min.js
                </a>
              
                
                <a class="source" href="wp-plupload.html">
                  wp-plupload.js
                </a>
              
                
                <a class="source" href="quicktags.html">
                  quicktags.js
                </a>
              
                
                <a class="source" href="shortcode.html">
                  shortcode.js
                </a>
              
                
                <a class="source" href="swfobject.html">
                  swfobject.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="handlers.min.html">
                  handlers.min.js
                </a>
              
                
                <a class="source" href="swfupload.cookies.html">
                  swfupload.cookies.js
                </a>
              
                
                <a class="source" href="swfupload.queue.html">
                  swfupload.queue.js
                </a>
              
                
                <a class="source" href="swfupload.speed.html">
                  swfupload.speed.js
                </a>
              
                
                <a class="source" href="swfupload.swfobject.html">
                  swfupload.swfobject.js
                </a>
              
                
                <a class="source" href="swfupload.html">
                  swfupload.js
                </a>
              
                
                <a class="source" href="thickbox.html">
                  thickbox.js
                </a>
              
                
                <a class="source" href="wp-langs-en.html">
                  wp-langs-en.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="tiny_mce_popup.html">
                  tiny_mce_popup.js
                </a>
              
                
                <a class="source" href="tinymce.html">
                  tinymce.js
                </a>
              
                
                <a class="source" href="tinymce.min.html">
                  tinymce.min.js
                </a>
              
                
                <a class="source" href="editable_selects.html">
                  editable_selects.js
                </a>
              
                
                <a class="source" href="form_utils.html">
                  form_utils.js
                </a>
              
                
                <a class="source" href="mctabs.html">
                  mctabs.js
                </a>
              
                
                <a class="source" href="validate.html">
                  validate.js
                </a>
              
                
                <a class="source" href="tw-sack.html">
                  tw-sack.js
                </a>
              
                
                <a class="source" href="twemoji.html">
                  twemoji.js
                </a>
              
                
                <a class="source" href="underscore.html">
                  underscore.js
                </a>
              
                
                <a class="source" href="underscore.min.html">
                  underscore.min.js
                </a>
              
                
                <a class="source" href="utils.html">
                  utils.js
                </a>
              
                
                <a class="source" href="wp-a11y.html">
                  wp-a11y.js
                </a>
              
                
                <a class="source" href="wp-ajax-response.html">
                  wp-ajax-response.js
                </a>
              
                
                <a class="source" href="wp-api.html">
                  wp-api.js
                </a>
              
                
                <a class="source" href="wp-auth-check.html">
                  wp-auth-check.js
                </a>
              
                
                <a class="source" href="wp-backbone.html">
                  wp-backbone.js
                </a>
              
                
                <a class="source" href="wp-custom-header.html">
                  wp-custom-header.js
                </a>
              
                
                <a class="source" href="wp-embed-template.html">
                  wp-embed-template.js
                </a>
              
                
                <a class="source" href="wp-embed.html">
                  wp-embed.js
                </a>
              
                
                <a class="source" href="wp-emoji-loader.html">
                  wp-emoji-loader.js
                </a>
              
                
                <a class="source" href="wp-emoji.html">
                  wp-emoji.js
                </a>
              
                
                <a class="source" href="wp-list-revisions.html">
                  wp-list-revisions.js
                </a>
              
                
                <a class="source" href="wp-lists.html">
                  wp-lists.js
                </a>
              
                
                <a class="source" href="wp-pointer.html">
                  wp-pointer.js
                </a>
              
                
                <a class="source" href="wp-util.html">
                  wp-util.js
                </a>
              
                
                <a class="source" href="wpdialog.html">
                  wpdialog.js
                </a>
              
                
                <a class="source" href="wplink.html">
                  wplink.js
                </a>
              
                
                <a class="source" href="zxcvbn-async.html">
                  zxcvbn-async.js
                </a>
              
                
                <a class="source" href="zxcvbn.min.html">
                  zxcvbn.min.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>mce-view.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/* global tinymce */</span>

<span class="hljs-comment">/*
 * The TinyMCE view API.
 *
 * Note: this API is "experimental" meaning that it will probably change
 * in the next few releases based on feedback from 3.9.0.
 * If you decide to use it, please follow the development closely.
 *
 * Diagram
 *
 * |- registered view constructor (type)
 * |  |- view instance (unique text)
 * |  |  |- editor 1
 * |  |  |  |- view node
 * |  |  |  |- view node
 * |  |  |  |- ...
 * |  |  |- editor 2
 * |  |  |  |- ...
 * |  |- view instance
 * |  |  |- ...
 * |- registered view
 * |  |- ...
 */</span>
( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> window, wp, shortcode, $ </span>) </span>{
<span class="hljs-meta">	'use strict'</span>;

	<span class="hljs-keyword">var</span> views = {},
		instances = {};

	wp.mce = wp.mce || {};

	<span class="hljs-comment">/**
	 * wp.mce.views
	 *
	 * A set of utilities that simplifies adding custom UI within a TinyMCE editor.
	 * At its core, it serves as a series of converters, transforming text to a
	 * custom UI, and back again.
	 */</span>
	wp.mce.views = {

		<span class="hljs-comment">/**
		 * Registers a new view type.
		 *
		 * @param {String} type   The view type.
		 * @param {Object} extend An object to extend wp.mce.View.prototype with.
		 */</span>
		register: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> type, extend </span>) </span>{
			views[ type ] = wp.mce.View.extend( _.extend( extend, { <span class="hljs-attr">type</span>: type } ) );
		},

		<span class="hljs-comment">/**
		 * Unregisters a view type.
		 *
		 * @param {String} type The view type.
		 */</span>
		unregister: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> type </span>) </span>{
			<span class="hljs-keyword">delete</span> views[ type ];
		},

		<span class="hljs-comment">/**
		 * Returns the settings of a view type.
		 *
		 * @param {String} type The view type.
		 *
		 * @return {Function} The view constructor.
		 */</span>
		get: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> type </span>) </span>{
			<span class="hljs-keyword">return</span> views[ type ];
		},

		<span class="hljs-comment">/**
		 * Unbinds all view nodes.
		 * Runs before removing all view nodes from the DOM.
		 */</span>
		unbind: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			_.each( instances, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> instance </span>) </span>{
				instance.unbind();
			} );
		},

		<span class="hljs-comment">/**
		 * Scans a given string for each view's pattern,
		 * replacing any matches with markers,
		 * and creates a new instance for every match.
		 *
		 * @param {String} content The string to scan.
		 *
		 * @return {String} The string with markers.
		 */</span>
		setMarkers: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> content </span>) </span>{
			<span class="hljs-keyword">var</span> pieces = [ { <span class="hljs-attr">content</span>: content } ],
				self = <span class="hljs-keyword">this</span>,
				instance, current;

			_.each( views, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view, type </span>) </span>{
				current = pieces.slice();
				pieces  = [];

				_.each( current, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> piece </span>) </span>{
					<span class="hljs-keyword">var</span> remaining = piece.content,
						result, text;</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Ignore processed pieces, but retain their location.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( piece.processed ) {
						pieces.push( piece );
						<span class="hljs-keyword">return</span>;
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Iterate through the string progressively matching views
and slicing the string as we go.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">while</span> ( remaining &amp;&amp; ( result = view.prototype.match( remaining ) ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Any text before the match becomes an unprocessed piece.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						<span class="hljs-keyword">if</span> ( result.index ) {
							pieces.push( { <span class="hljs-attr">content</span>: remaining.substring( <span class="hljs-number">0</span>, result.index ) } );
						}

						instance = self.createInstance( type, result.content, result.options );
						text = instance.loader ? <span class="hljs-string">'.'</span> : instance.text;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Add the processed piece for the match.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						pieces.push( {
							<span class="hljs-attr">content</span>: instance.ignore ? text : <span class="hljs-string">'&lt;p data-wpview-marker="'</span> + instance.encodedText + <span class="hljs-string">'"&gt;'</span> + text + <span class="hljs-string">'&lt;/p&gt;'</span>,
							<span class="hljs-attr">processed</span>: <span class="hljs-literal">true</span>
						} );</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Update the remaining content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						remaining = remaining.slice( result.index + result.content.length );
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>There are no additional matches.
If any content remains, add it as an unprocessed piece.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( remaining ) {
						pieces.push( { <span class="hljs-attr">content</span>: remaining } );
					}
				} );
			} );

			content = _.pluck( pieces, <span class="hljs-string">'content'</span> ).join( <span class="hljs-string">''</span> );
			<span class="hljs-keyword">return</span> content.replace( <span class="hljs-regexp">/&lt;p&gt;\s*&lt;p data-wpview-marker=/g</span>, <span class="hljs-string">'&lt;p data-wpview-marker='</span> ).replace( <span class="hljs-regexp">/&lt;\/p&gt;\s*&lt;\/p&gt;/g</span>, <span class="hljs-string">'&lt;/p&gt;'</span> );
		},

		<span class="hljs-comment">/**
		 * Create a view instance.
		 *
		 * @param {String}  type    The view type.
		 * @param {String}  text    The textual representation of the view.
		 * @param {Object}  options Options.
		 * @param {Boolean} force   Recreate the instance. Optional.
		 *
		 * @return {wp.mce.View} The view instance.
		 */</span>
		createInstance: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> type, text, options, force </span>) </span>{
			<span class="hljs-keyword">var</span> View = <span class="hljs-keyword">this</span>.get( type ),
				encodedText,
				instance;

			text = tinymce.DOM.decode( text );

			<span class="hljs-keyword">if</span> ( text.indexOf( <span class="hljs-string">'['</span> ) !== <span class="hljs-number">-1</span> &amp;&amp; text.indexOf( <span class="hljs-string">']'</span> ) !== <span class="hljs-number">-1</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Looks like a shortcode? Remove any line breaks from inside of shortcodes
or autop will replace them with <p> and <br> later and the string won’t match.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				text = text.replace( <span class="hljs-regexp">/\[[^\]]+\]/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> match </span>) </span>{
					<span class="hljs-keyword">return</span> match.replace( <span class="hljs-regexp">/[\r\n]/g</span>, <span class="hljs-string">''</span> );
				});
			}

			<span class="hljs-keyword">if</span> ( ! force ) {
				instance = <span class="hljs-keyword">this</span>.getInstance( text );

				<span class="hljs-keyword">if</span> ( instance ) {
					<span class="hljs-keyword">return</span> instance;
				}
			}

			encodedText = <span class="hljs-built_in">encodeURIComponent</span>( text );

			options = _.extend( options || {}, {
				<span class="hljs-attr">text</span>: text,
				<span class="hljs-attr">encodedText</span>: encodedText
			} );

			<span class="hljs-keyword">return</span> instances[ encodedText ] = <span class="hljs-keyword">new</span> View( options );
		},

		<span class="hljs-comment">/**
		 * Get a view instance.
		 *
		 * @param {(String|HTMLElement)} object The textual representation of the view or the view node.
		 *
		 * @return {wp.mce.View} The view instance or undefined.
		 */</span>
		getInstance: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> object </span>) </span>{
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> object === <span class="hljs-string">'string'</span> ) {
				<span class="hljs-keyword">return</span> instances[ <span class="hljs-built_in">encodeURIComponent</span>( object ) ];
			}

			<span class="hljs-keyword">return</span> instances[ $( object ).attr( <span class="hljs-string">'data-wpview-text'</span> ) ];
		},

		<span class="hljs-comment">/**
		 * Given a view node, get the view's text.
		 *
		 * @param {HTMLElement} node The view node.
		 *
		 * @return {String} The textual representation of the view.
		 */</span>
		getText: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> node </span>) </span>{
			<span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>( $( node ).attr( <span class="hljs-string">'data-wpview-text'</span> ) || <span class="hljs-string">''</span> );
		},

		<span class="hljs-comment">/**
		 * Renders all view nodes that are not yet rendered.
		 *
		 * @param {Boolean} force Rerender all view nodes.
		 */</span>
		render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> force </span>) </span>{
			_.each( instances, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> instance </span>) </span>{
				instance.render( <span class="hljs-literal">null</span>, force );
			} );
		},

		<span class="hljs-comment">/**
		 * Update the text of a given view node.
		 *
		 * @param {String}         text   The new text.
		 * @param {tinymce.Editor} editor The TinyMCE editor instance the view node is in.
		 * @param {HTMLElement}    node   The view node to update.
		 * @param {Boolean}        force  Recreate the instance. Optional.
		 */</span>
		update: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> text, editor, node, force </span>) </span>{
			<span class="hljs-keyword">var</span> instance = <span class="hljs-keyword">this</span>.getInstance( node );

			<span class="hljs-keyword">if</span> ( instance ) {
				instance.update( text, editor, node, force );
			}
		},

		<span class="hljs-comment">/**
		 * Renders any editing interface based on the view type.
		 *
		 * @param {tinymce.Editor} editor The TinyMCE editor instance the view node is in.
		 * @param {HTMLElement}    node   The view node to edit.
		 */</span>
		edit: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor, node </span>) </span>{
			<span class="hljs-keyword">var</span> instance = <span class="hljs-keyword">this</span>.getInstance( node );

			<span class="hljs-keyword">if</span> ( instance &amp;&amp; instance.edit ) {
				instance.edit( instance.text, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> text, force </span>) </span>{
					instance.update( text, editor, node, force );
				} );
			}
		},

		<span class="hljs-comment">/**
		 * Remove a given view node from the DOM.
		 *
		 * @param {tinymce.Editor} editor The TinyMCE editor instance the view node is in.
		 * @param {HTMLElement}    node   The view node to remove.
		 */</span>
		remove: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor, node </span>) </span>{
			<span class="hljs-keyword">var</span> instance = <span class="hljs-keyword">this</span>.getInstance( node );

			<span class="hljs-keyword">if</span> ( instance ) {
				instance.remove( editor, node );
			}
		}
	};

	<span class="hljs-comment">/**
	 * A Backbone-like View constructor intended for use when rendering a TinyMCE View.
	 * The main difference is that the TinyMCE View is not tied to a particular DOM node.
	 *
	 * @param {Object} options Options.
	 */</span>
	wp.mce.View = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) </span>{
		_.extend( <span class="hljs-keyword">this</span>, options );
		<span class="hljs-keyword">this</span>.initialize();
	};

	wp.mce.View.extend = Backbone.View.extend;

	_.extend( wp.mce.View.prototype, {

		<span class="hljs-comment">/**
		 * The content.
		 *
		 * @type {*}
		 */</span>
		content: <span class="hljs-literal">null</span>,

		<span class="hljs-comment">/**
		 * Whether or not to display a loader.
		 *
		 * @type {Boolean}
		 */</span>
		loader: <span class="hljs-literal">true</span>,

		<span class="hljs-comment">/**
		 * Runs after the view instance is created.
		 */</span>
		initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},

		<span class="hljs-comment">/**
		 * Returns the content to render in the view node.
		 *
		 * @return {*}
		 */</span>
		getContent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.content;
		},

		<span class="hljs-comment">/**
		 * Renders all view nodes tied to this view instance that are not yet rendered.
		 *
		 * @param {String}  content The content to render. Optional.
		 * @param {Boolean} force   Rerender all view nodes tied to this view instance. Optional.
		 */</span>
		render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> content, force </span>) </span>{
			<span class="hljs-keyword">if</span> ( content != <span class="hljs-literal">null</span> ) {
				<span class="hljs-keyword">this</span>.content = content;
			}

			content = <span class="hljs-keyword">this</span>.getContent();</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>If there’s nothing to render an no loader needs to be shown, stop.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.loader &amp;&amp; ! content ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>We’re about to rerender all views of this instance, so unbind rendered views.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			force &amp;&amp; <span class="hljs-keyword">this</span>.unbind();</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Replace any left over markers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.replaceMarkers();

			<span class="hljs-keyword">if</span> ( content ) {
				<span class="hljs-keyword">this</span>.setContent( content, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor, node </span>) </span>{
					$( node ).data( <span class="hljs-string">'rendered'</span>, <span class="hljs-literal">true</span> );
					<span class="hljs-keyword">this</span>.bindNode.call( <span class="hljs-keyword">this</span>, editor, node );
				}, force ? <span class="hljs-literal">null</span> : <span class="hljs-literal">false</span> );
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.setLoader();
			}
		},

		<span class="hljs-comment">/**
		 * Binds a given node after its content is added to the DOM.
		 */</span>
		bindNode: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},

		<span class="hljs-comment">/**
		 * Unbinds a given node before its content is removed from the DOM.
		 */</span>
		unbindNode: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},

		<span class="hljs-comment">/**
		 * Unbinds all view nodes tied to this view instance.
		 * Runs before their content is removed from the DOM.
		 */</span>
		unbind: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">this</span>.getNodes( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor, node </span>) </span>{
				<span class="hljs-keyword">this</span>.unbindNode.call( <span class="hljs-keyword">this</span>, editor, node );
			}, <span class="hljs-literal">true</span> );
		},

		<span class="hljs-comment">/**
		 * Gets all the TinyMCE editor instances that support views.
		 *
		 * @param {Function} callback A callback.
		 */</span>
		getEditors: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> callback </span>) </span>{
			_.each( tinymce.editors, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor </span>) </span>{
				<span class="hljs-keyword">if</span> ( editor.plugins.wpview ) {
					callback.call( <span class="hljs-keyword">this</span>, editor );
				}
			}, <span class="hljs-keyword">this</span> );
		},

		<span class="hljs-comment">/**
		 * Gets all view nodes tied to this view instance.
		 *
		 * @param {Function} callback A callback.
		 * @param {Boolean}  rendered Get (un)rendered view nodes. Optional.
		 */</span>
		getNodes: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> callback, rendered </span>) </span>{
			<span class="hljs-keyword">this</span>.getEditors( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor </span>) </span>{
				<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

				$( editor.getBody() )
					.find( <span class="hljs-string">'[data-wpview-text="'</span> + self.encodedText + <span class="hljs-string">'"]'</span> )
					.filter( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> data;

						<span class="hljs-keyword">if</span> ( rendered == <span class="hljs-literal">null</span> ) {
							<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
						}

						data = $( <span class="hljs-keyword">this</span> ).data( <span class="hljs-string">'rendered'</span> ) === <span class="hljs-literal">true</span>;

						<span class="hljs-keyword">return</span> rendered ? data : ! data;
					} )
					.each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						callback.call( self, editor, <span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span> <span class="hljs-comment">/* back compat */</span> );
					} );
			} );
		},

		<span class="hljs-comment">/**
		 * Gets all marker nodes tied to this view instance.
		 *
		 * @param {Function} callback A callback.
		 */</span>
		getMarkers: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> callback </span>) </span>{
			<span class="hljs-keyword">this</span>.getEditors( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor </span>) </span>{
				<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

				$( editor.getBody() )
					.find( <span class="hljs-string">'[data-wpview-marker="'</span> + <span class="hljs-keyword">this</span>.encodedText + <span class="hljs-string">'"]'</span> )
					.each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						callback.call( self, editor, <span class="hljs-keyword">this</span> );
					} );
			} );
		},

		<span class="hljs-comment">/**
		 * Replaces all marker nodes tied to this view instance.
		 */</span>
		replaceMarkers: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">this</span>.getMarkers( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor, node </span>) </span>{
				<span class="hljs-keyword">var</span> selected = node === editor.selection.getNode();
				<span class="hljs-keyword">var</span> $viewNode;

				<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">this</span>.loader &amp;&amp; $( node ).text() !== <span class="hljs-keyword">this</span>.text ) {
					editor.dom.setAttrib( node, <span class="hljs-string">'data-wpview-marker'</span>, <span class="hljs-literal">null</span> );
					<span class="hljs-keyword">return</span>;
				}

				$viewNode = editor.$(
					<span class="hljs-string">'&lt;div class="wpview wpview-wrap" data-wpview-text="'</span> + <span class="hljs-keyword">this</span>.encodedText + <span class="hljs-string">'" data-wpview-type="'</span> + <span class="hljs-keyword">this</span>.type + <span class="hljs-string">'" contenteditable="false"&gt;&lt;/div&gt;'</span>
				);

				editor.$( node ).replaceWith( $viewNode );

				<span class="hljs-keyword">if</span> ( selected ) {
					setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						editor.selection.select( $viewNode[<span class="hljs-number">0</span>] );
						editor.selection.collapse();
					} );
				}
			} );
		},

		<span class="hljs-comment">/**
		 * Removes all marker nodes tied to this view instance.
		 */</span>
		removeMarkers: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">this</span>.getMarkers( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor, node </span>) </span>{
				editor.dom.setAttrib( node, <span class="hljs-string">'data-wpview-marker'</span>, <span class="hljs-literal">null</span> );
			} );
		},

		<span class="hljs-comment">/**
		 * Sets the content for all view nodes tied to this view instance.
		 *
		 * @param {*}        content  The content to set.
		 * @param {Function} callback A callback. Optional.
		 * @param {Boolean}  rendered Only set for (un)rendered nodes. Optional.
		 */</span>
		setContent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> content, callback, rendered </span>) </span>{
			<span class="hljs-keyword">if</span> ( _.isObject( content ) &amp;&amp; ( content.sandbox || content.head || content.body.indexOf( <span class="hljs-string">'&lt;script'</span> ) !== <span class="hljs-number">-1</span> ) ) {
				<span class="hljs-keyword">this</span>.setIframes( content.head || <span class="hljs-string">''</span>, content.body, callback, rendered );
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( _.isString( content ) &amp;&amp; content.indexOf( <span class="hljs-string">'&lt;script'</span> ) !== <span class="hljs-number">-1</span> ) {
				<span class="hljs-keyword">this</span>.setIframes( <span class="hljs-string">''</span>, content, callback, rendered );
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.getNodes( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor, node </span>) </span>{
					content = content.body || content;

					<span class="hljs-keyword">if</span> ( content.indexOf( <span class="hljs-string">'&lt;iframe'</span> ) !== <span class="hljs-number">-1</span> ) {
						content += <span class="hljs-string">'&lt;span class="mce-shim"&gt;&lt;/span&gt;'</span>;
					}

					editor.undoManager.transact( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						node.innerHTML = <span class="hljs-string">''</span>;
						node.appendChild( _.isString( content ) ? editor.dom.createFragment( content ) : content );
						editor.dom.add( node, <span class="hljs-string">'span'</span>, { <span class="hljs-string">'class'</span>: <span class="hljs-string">'wpview-end'</span> } );
					} );

					callback &amp;&amp; callback.call( <span class="hljs-keyword">this</span>, editor, node );
				}, rendered );
			}
		},

		<span class="hljs-comment">/**
		 * Sets the content in an iframe for all view nodes tied to this view instance.
		 *
		 * @param {String}   head     HTML string to be added to the head of the document.
		 * @param {String}   body     HTML string to be added to the body of the document.
		 * @param {Function} callback A callback. Optional.
		 * @param {Boolean}  rendered Only set for (un)rendered nodes. Optional.
		 */</span>
		setIframes: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> head, body, callback, rendered </span>) </span>{
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

			<span class="hljs-keyword">this</span>.getNodes( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor, node </span>) </span>{
				<span class="hljs-keyword">var</span> dom = editor.dom,
					styles = <span class="hljs-string">''</span>,
					bodyClasses = editor.getBody().className || <span class="hljs-string">''</span>,
					editorHead = editor.getDoc().getElementsByTagName( <span class="hljs-string">'head'</span> )[<span class="hljs-number">0</span>],
					iframe, iframeWin, iframeDoc, MutationObserver, observer, i, block;

				tinymce.each( dom.$( <span class="hljs-string">'link[rel="stylesheet"]'</span>, editorHead ), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> link </span>) </span>{
					<span class="hljs-keyword">if</span> ( link.href &amp;&amp; link.href.indexOf( <span class="hljs-string">'skins/lightgray/content.min.css'</span> ) === <span class="hljs-number">-1</span> &amp;&amp;
						link.href.indexOf( <span class="hljs-string">'skins/wordpress/wp-content.css'</span> ) === <span class="hljs-number">-1</span> ) {

						styles += dom.getOuterHTML( link );
					}
				} );

				<span class="hljs-keyword">if</span> ( self.iframeHeight ) {
					dom.add( node, <span class="hljs-string">'span'</span>, {
						<span class="hljs-string">'data-mce-bogus'</span>: <span class="hljs-number">1</span>,
						<span class="hljs-attr">style</span>: {
							<span class="hljs-attr">display</span>: <span class="hljs-string">'block'</span>,
							<span class="hljs-attr">width</span>: <span class="hljs-string">'100%'</span>,
							<span class="hljs-attr">height</span>: self.iframeHeight
						}
					}, <span class="hljs-string">'\u200B'</span> );
				}

				editor.undoManager.transact( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					node.innerHTML = <span class="hljs-string">''</span>;

					iframe = dom.add( node, <span class="hljs-string">'iframe'</span>, {
						<span class="hljs-comment">/* jshint scripturl: true */</span>
						src: tinymce.Env.ie ? <span class="hljs-string">'javascript:""'</span> : <span class="hljs-string">''</span>,
						<span class="hljs-attr">frameBorder</span>: <span class="hljs-string">'0'</span>,
						<span class="hljs-attr">allowTransparency</span>: <span class="hljs-string">'true'</span>,
						<span class="hljs-attr">scrolling</span>: <span class="hljs-string">'no'</span>,
						<span class="hljs-string">'class'</span>: <span class="hljs-string">'wpview-sandbox'</span>,
						<span class="hljs-attr">style</span>: {
							<span class="hljs-attr">width</span>: <span class="hljs-string">'100%'</span>,
							<span class="hljs-attr">display</span>: <span class="hljs-string">'block'</span>
						},
						<span class="hljs-attr">height</span>: self.iframeHeight
					} );

					dom.add( node, <span class="hljs-string">'span'</span>, { <span class="hljs-string">'class'</span>: <span class="hljs-string">'mce-shim'</span> } );
					dom.add( node, <span class="hljs-string">'span'</span>, { <span class="hljs-string">'class'</span>: <span class="hljs-string">'wpview-end'</span> } );
				} );</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Bail if the iframe node is not attached to the DOM.
Happens when the view is dragged in the editor.
There is a browser restriction when iframes are moved in the DOM. They get emptied.
The iframe will be rerendered after dropping the view node at the new location.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( ! iframe.contentWindow ) {
					<span class="hljs-keyword">return</span>;
				}

				iframeWin = iframe.contentWindow;
				iframeDoc = iframeWin.document;
				iframeDoc.open();

				iframeDoc.write(
					<span class="hljs-string">'&lt;!DOCTYPE html&gt;'</span> +
					<span class="hljs-string">'&lt;html&gt;'</span> +
						<span class="hljs-string">'&lt;head&gt;'</span> +
							<span class="hljs-string">'&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;'</span> +
							head +
							styles +
							<span class="hljs-string">'&lt;style&gt;'</span> +
								<span class="hljs-string">'html {'</span> +
									<span class="hljs-string">'background: transparent;'</span> +
									<span class="hljs-string">'padding: 0;'</span> +
									<span class="hljs-string">'margin: 0;'</span> +
								<span class="hljs-string">'}'</span> +
								<span class="hljs-string">'body#wpview-iframe-sandbox {'</span> +
									<span class="hljs-string">'background: transparent;'</span> +
									<span class="hljs-string">'padding: 1px 0 !important;'</span> +
									<span class="hljs-string">'margin: -1px 0 0 !important;'</span> +
								<span class="hljs-string">'}'</span> +
								<span class="hljs-string">'body#wpview-iframe-sandbox:before,'</span> +
								<span class="hljs-string">'body#wpview-iframe-sandbox:after {'</span> +
									<span class="hljs-string">'display: none;'</span> +
									<span class="hljs-string">'content: "";'</span> +
								<span class="hljs-string">'}'</span> +
								<span class="hljs-string">'iframe {'</span> +
									<span class="hljs-string">'max-width: 100%;'</span> +
								<span class="hljs-string">'}'</span> +
							<span class="hljs-string">'&lt;/style&gt;'</span> +
						<span class="hljs-string">'&lt;/head&gt;'</span> +
						<span class="hljs-string">'&lt;body id="wpview-iframe-sandbox" class="'</span> + bodyClasses + <span class="hljs-string">'"&gt;'</span> +
							body +
						<span class="hljs-string">'&lt;/body&gt;'</span> +
					<span class="hljs-string">'&lt;/html&gt;'</span>
				);

				iframeDoc.close();

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resize</span>(<span class="hljs-params"></span>) </span>{
					<span class="hljs-keyword">var</span> $iframe;

					<span class="hljs-keyword">if</span> ( block ) {
						<span class="hljs-keyword">return</span>;
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Make sure the iframe still exists.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( iframe.contentWindow ) {
						$iframe = $( iframe );
						self.iframeHeight = $( iframeDoc.body ).height();

						<span class="hljs-keyword">if</span> ( $iframe.height() !== self.iframeHeight ) {
							$iframe.height( self.iframeHeight );
							editor.nodeChanged();
						}
					}
				}

				<span class="hljs-keyword">if</span> ( self.iframeHeight ) {
					block = <span class="hljs-literal">true</span>;

					setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						block = <span class="hljs-literal">false</span>;
						resize();
					}, <span class="hljs-number">3000</span> );
				}

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reload</span>(<span class="hljs-params"></span>) </span>{
					<span class="hljs-keyword">if</span> ( ! editor.isHidden() ) {
						$( node ).data( <span class="hljs-string">'rendered'</span>, <span class="hljs-literal">null</span> );

						setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
							wp.mce.views.render();
						} );
					}
				}

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addObserver</span>(<span class="hljs-params"></span>) </span>{
					observer = <span class="hljs-keyword">new</span> MutationObserver( _.debounce( resize, <span class="hljs-number">100</span> ) );

					observer.observe( iframeDoc.body, {
						<span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,
						<span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
						<span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>
					} );
				}

				$( iframeWin ).on( <span class="hljs-string">'load'</span>, resize ).on( <span class="hljs-string">'unload'</span>, reload );

				MutationObserver = iframeWin.MutationObserver || iframeWin.WebKitMutationObserver || iframeWin.MozMutationObserver;

				<span class="hljs-keyword">if</span> ( MutationObserver ) {
					<span class="hljs-keyword">if</span> ( ! iframeDoc.body ) {
						iframeDoc.addEventListener( <span class="hljs-string">'DOMContentLoaded'</span>, addObserver, <span class="hljs-literal">false</span> );
					} <span class="hljs-keyword">else</span> {
						addObserver();
					}
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">6</span>; i++ ) {
						setTimeout( resize, i * <span class="hljs-number">700</span> );
					}
				}

				callback &amp;&amp; callback.call( self, editor, node );
			}, rendered );
		},

		<span class="hljs-comment">/**
		 * Sets a loader for all view nodes tied to this view instance.
		 */</span>
		setLoader: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> dashicon </span>) </span>{
			<span class="hljs-keyword">this</span>.setContent(
				<span class="hljs-string">'&lt;div class="loading-placeholder"&gt;'</span> +
					<span class="hljs-string">'&lt;div class="dashicons dashicons-'</span> + ( dashicon || <span class="hljs-string">'admin-media'</span> ) + <span class="hljs-string">'"&gt;&lt;/div&gt;'</span> +
					<span class="hljs-string">'&lt;div class="wpview-loading"&gt;&lt;ins&gt;&lt;/ins&gt;&lt;/div&gt;'</span> +
				<span class="hljs-string">'&lt;/div&gt;'</span>
			);
		},

		<span class="hljs-comment">/**
		 * Sets an error for all view nodes tied to this view instance.
		 *
		 * @param {String} message  The error message to set.
		 * @param {String} dashicon A dashicon ID. Optional. {@link https://developer.wordpress.org/resource/dashicons/}
		 */</span>
		setError: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> message, dashicon </span>) </span>{
			<span class="hljs-keyword">this</span>.setContent(
				<span class="hljs-string">'&lt;div class="wpview-error"&gt;'</span> +
					<span class="hljs-string">'&lt;div class="dashicons dashicons-'</span> + ( dashicon || <span class="hljs-string">'no'</span> ) + <span class="hljs-string">'"&gt;&lt;/div&gt;'</span> +
					<span class="hljs-string">'&lt;p&gt;'</span> + message + <span class="hljs-string">'&lt;/p&gt;'</span> +
				<span class="hljs-string">'&lt;/div&gt;'</span>
			);
		},

		<span class="hljs-comment">/**
		 * Tries to find a text match in a given string.
		 *
		 * @param {String} content The string to scan.
		 *
		 * @return {Object}
		 */</span>
		match: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> content </span>) </span>{
			<span class="hljs-keyword">var</span> match = shortcode.next( <span class="hljs-keyword">this</span>.type, content );

			<span class="hljs-keyword">if</span> ( match ) {
				<span class="hljs-keyword">return</span> {
					<span class="hljs-attr">index</span>: match.index,
					<span class="hljs-attr">content</span>: match.content,
					<span class="hljs-attr">options</span>: {
						<span class="hljs-attr">shortcode</span>: match.shortcode
					}
				};
			}
		},

		<span class="hljs-comment">/**
		 * Update the text of a given view node.
		 *
		 * @param {String}         text   The new text.
		 * @param {tinymce.Editor} editor The TinyMCE editor instance the view node is in.
		 * @param {HTMLElement}    node   The view node to update.
		 * @param {Boolean}        force  Recreate the instance. Optional.
		 */</span>
		update: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> text, editor, node, force </span>) </span>{
			_.find( views, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> view, type </span>) </span>{
				<span class="hljs-keyword">var</span> match = view.prototype.match( text );

				<span class="hljs-keyword">if</span> ( match ) {
					$( node ).data( <span class="hljs-string">'rendered'</span>, <span class="hljs-literal">false</span> );
					editor.dom.setAttrib( node, <span class="hljs-string">'data-wpview-text'</span>, <span class="hljs-built_in">encodeURIComponent</span>( text ) );
					wp.mce.views.createInstance( type, text, match.options, force ).render();

					editor.selection.select( node );
					editor.nodeChanged();
					editor.focus();

					<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
				}
			} );
		},

		<span class="hljs-comment">/**
		 * Remove a given view node from the DOM.
		 *
		 * @param {tinymce.Editor} editor The TinyMCE editor instance the view node is in.
		 * @param {HTMLElement}    node   The view node to remove.
		 */</span>
		remove: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor, node </span>) </span>{
			<span class="hljs-keyword">this</span>.unbindNode.call( <span class="hljs-keyword">this</span>, editor, node );
			editor.dom.remove( node );
			editor.focus();
		}
	} );
} )( <span class="hljs-built_in">window</span>, <span class="hljs-built_in">window</span>.wp, <span class="hljs-built_in">window</span>.wp.shortcode, <span class="hljs-built_in">window</span>.jQuery );

<span class="hljs-comment">/*
 * The WordPress core TinyMCE views.
 * Views for the gallery, audio, video, playlist and embed shortcodes,
 * and a view for embeddable URLs.
 */</span>
( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> window, views, media, $ </span>) </span>{
	<span class="hljs-keyword">var</span> base, gallery, av, embed,
		schema, parser, serializer;

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">verifyHTML</span>(<span class="hljs-params"> string </span>) </span>{
		<span class="hljs-keyword">var</span> settings = {};

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-built_in">window</span>.tinymce ) {
			<span class="hljs-keyword">return</span> string.replace( <span class="hljs-regexp">/&lt;[^&gt;]+&gt;/g</span>, <span class="hljs-string">''</span> );
		}

		<span class="hljs-keyword">if</span> ( ! string || ( string.indexOf( <span class="hljs-string">'&lt;'</span> ) === <span class="hljs-number">-1</span> &amp;&amp; string.indexOf( <span class="hljs-string">'&gt;'</span> ) === <span class="hljs-number">-1</span> ) ) {
			<span class="hljs-keyword">return</span> string;
		}

		schema = schema || <span class="hljs-keyword">new</span> <span class="hljs-built_in">window</span>.tinymce.html.Schema( settings );
		parser = parser || <span class="hljs-keyword">new</span> <span class="hljs-built_in">window</span>.tinymce.html.DomParser( settings, schema );
		serializer = serializer || <span class="hljs-keyword">new</span> <span class="hljs-built_in">window</span>.tinymce.html.Serializer( settings, schema );

		<span class="hljs-keyword">return</span> serializer.serialize( parser.parse( string, { <span class="hljs-attr">forced_root_block</span>: <span class="hljs-literal">false</span> } ) );
	}

	base = {
		<span class="hljs-attr">state</span>: [],

		<span class="hljs-attr">edit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> text, update </span>) </span>{
			<span class="hljs-keyword">var</span> type = <span class="hljs-keyword">this</span>.type,
				frame = media[ type ].edit( text );

			<span class="hljs-keyword">this</span>.pausePlayers &amp;&amp; <span class="hljs-keyword">this</span>.pausePlayers();

			_.each( <span class="hljs-keyword">this</span>.state, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> state </span>) </span>{
				frame.state( state ).on( <span class="hljs-string">'update'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> selection </span>) </span>{
					update( media[ type ].shortcode( selection ).string(), type === <span class="hljs-string">'gallery'</span> );
				} );
			} );

			frame.on( <span class="hljs-string">'close'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				frame.detach();
			} );

			frame.open();
		}
	};

	gallery = _.extend( {}, base, {
		<span class="hljs-attr">state</span>: [ <span class="hljs-string">'gallery-edit'</span> ],
		<span class="hljs-attr">template</span>: media.template( <span class="hljs-string">'editor-gallery'</span> ),

		<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> attachments = media.gallery.attachments( <span class="hljs-keyword">this</span>.shortcode, media.view.settings.post.id ),
				attrs = <span class="hljs-keyword">this</span>.shortcode.attrs.named,
				self = <span class="hljs-keyword">this</span>;

			attachments.more()
			.done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				attachments = attachments.toJSON();

				_.each( attachments, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
					<span class="hljs-keyword">if</span> ( attachment.sizes ) {
						<span class="hljs-keyword">if</span> ( attrs.size &amp;&amp; attachment.sizes[ attrs.size ] ) {
							attachment.thumbnail = attachment.sizes[ attrs.size ];
						} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( attachment.sizes.thumbnail ) {
							attachment.thumbnail = attachment.sizes.thumbnail;
						} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( attachment.sizes.full ) {
							attachment.thumbnail = attachment.sizes.full;
						}
					}
				} );

				self.render( self.template( {
					<span class="hljs-attr">verifyHTML</span>: verifyHTML,
					<span class="hljs-attr">attachments</span>: attachments,
					<span class="hljs-attr">columns</span>: attrs.columns ? <span class="hljs-built_in">parseInt</span>( attrs.columns, <span class="hljs-number">10</span> ) : media.galleryDefaults.columns
				} ) );
			} )
			.fail( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> jqXHR, textStatus </span>) </span>{
				self.setError( textStatus );
			} );
		}
	} );

	av = _.extend( {}, base, {
		<span class="hljs-attr">action</span>: <span class="hljs-string">'parse-media-shortcode'</span>,

		<span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.url ) {
				<span class="hljs-keyword">this</span>.loader = <span class="hljs-literal">false</span>;
				<span class="hljs-keyword">this</span>.shortcode = media.embed.shortcode( {
					<span class="hljs-attr">url</span>: <span class="hljs-keyword">this</span>.text
				} );
			}

			wp.ajax.post( <span class="hljs-keyword">this</span>.action, {
				<span class="hljs-attr">post_ID</span>: media.view.settings.post.id,
				<span class="hljs-attr">type</span>: <span class="hljs-keyword">this</span>.shortcode.tag,
				<span class="hljs-attr">shortcode</span>: <span class="hljs-keyword">this</span>.shortcode.string()
			} )
			.done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> response </span>) </span>{
				self.render( response );
			} )
			.fail( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> response </span>) </span>{
				<span class="hljs-keyword">if</span> ( self.url ) {
					self.ignore = <span class="hljs-literal">true</span>;
					self.removeMarkers();
				} <span class="hljs-keyword">else</span> {
					self.setError( response.message || response.statusText, <span class="hljs-string">'admin-media'</span> );
				}
			} );

			<span class="hljs-keyword">this</span>.getEditors( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor </span>) </span>{
				editor.on( <span class="hljs-string">'wpview-selected'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					self.pausePlayers();
				} );
			} );
		},

		<span class="hljs-attr">pausePlayers</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">this</span>.getNodes( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> editor, node, content </span>) </span>{
				<span class="hljs-keyword">var</span> win = $( <span class="hljs-string">'iframe.wpview-sandbox'</span>, content ).get( <span class="hljs-number">0</span> );

				<span class="hljs-keyword">if</span> ( win &amp;&amp; ( win = win.contentWindow ) &amp;&amp; win.mejs ) {
					_.each( win.mejs.players, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> player </span>) </span>{
						<span class="hljs-keyword">try</span> {
							player.pause();
						} <span class="hljs-keyword">catch</span> ( e ) {}
					} );
				}
			} );
		}
	} );

	embed = _.extend( {}, av, {
		<span class="hljs-attr">action</span>: <span class="hljs-string">'parse-embed'</span>,

		<span class="hljs-attr">edit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> text, update </span>) </span>{
			<span class="hljs-keyword">var</span> frame = media.embed.edit( text, <span class="hljs-keyword">this</span>.url ),
				self = <span class="hljs-keyword">this</span>;

			<span class="hljs-keyword">this</span>.pausePlayers();

			frame.state( <span class="hljs-string">'embed'</span> ).props.on( <span class="hljs-string">'change:url'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model, url </span>) </span>{
				<span class="hljs-keyword">if</span> ( url &amp;&amp; model.get( <span class="hljs-string">'url'</span> ) ) {
					frame.state( <span class="hljs-string">'embed'</span> ).metadata = model.toJSON();
				}
			} );

			frame.state( <span class="hljs-string">'embed'</span> ).on( <span class="hljs-string">'select'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">var</span> data = frame.state( <span class="hljs-string">'embed'</span> ).metadata;

				<span class="hljs-keyword">if</span> ( self.url ) {
					update( data.url );
				} <span class="hljs-keyword">else</span> {
					update( media.embed.shortcode( data ).string() );
				}
			} );

			frame.on( <span class="hljs-string">'close'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				frame.detach();
			} );

			frame.open();
		}
	} );

	views.register( <span class="hljs-string">'gallery'</span>, _.extend( {}, gallery ) );

	views.register( <span class="hljs-string">'audio'</span>, _.extend( {}, av, {
		<span class="hljs-attr">state</span>: [ <span class="hljs-string">'audio-details'</span> ]
	} ) );

	views.register( <span class="hljs-string">'video'</span>, _.extend( {}, av, {
		<span class="hljs-attr">state</span>: [ <span class="hljs-string">'video-details'</span> ]
	} ) );

	views.register( <span class="hljs-string">'playlist'</span>, _.extend( {}, av, {
		<span class="hljs-attr">state</span>: [ <span class="hljs-string">'playlist-edit'</span>, <span class="hljs-string">'video-playlist-edit'</span> ]
	} ) );

	views.register( <span class="hljs-string">'embed'</span>, _.extend( {}, embed ) );

	views.register( <span class="hljs-string">'embedURL'</span>, _.extend( {}, embed, {
		<span class="hljs-attr">match</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> content </span>) </span>{
			<span class="hljs-keyword">var</span> re = <span class="hljs-regexp">/(^|&lt;p&gt;)(https?:\/\/[^\s"]+?)(&lt;\/p&gt;\s*|$)/gi</span>,
				match = re.exec( content );

			<span class="hljs-keyword">if</span> ( match ) {
				<span class="hljs-keyword">return</span> {
					<span class="hljs-attr">index</span>: match.index + match[<span class="hljs-number">1</span>].length,
					<span class="hljs-attr">content</span>: match[<span class="hljs-number">2</span>],
					<span class="hljs-attr">options</span>: {
						<span class="hljs-attr">url</span>: <span class="hljs-literal">true</span>
					}
				};
			}
		}
	} ) );
} )( <span class="hljs-built_in">window</span>, <span class="hljs-built_in">window</span>.wp.mce.views, <span class="hljs-built_in">window</span>.wp.media, <span class="hljs-built_in">window</span>.jQuery );</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
